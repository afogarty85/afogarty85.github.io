<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Andrew Fogarty" />

<meta name="date" content="2020-10-23" />

<title>Semantic Similarity</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Semantic Similarity</h1>
<h4 class="author">Andrew Fogarty</h4>
<h4 class="date">10/23/2020</h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#training-preparation"><span class="toc-section-number">2</span> Training Preparation</a>
<ul>
<li><a href="#training-and-validating"><span class="toc-section-number">2.1</span> Training and Validating</a></li>
<li><a href="#testing"><span class="toc-section-number">2.2</span> Testing</a></li>
</ul></li>
<li><a href="#generated-fine-tuned-embeddings"><span class="toc-section-number">3</span> Generated Fine-Tuned Embeddings</a>
<ul>
<li><a href="#generate-fine-tuned-embeddings"><span class="toc-section-number">3.1</span> Generate Fine-Tuned Embeddings</a></li>
<li><a href="#transform-embeddings-to-numpy"><span class="toc-section-number">3.2</span> Transform Embeddings to Numpy</a></li>
</ul></li>
<li><a href="#faiss-in-action"><span class="toc-section-number">4</span> Faiss in Action</a></li>
<li><a href="#sources"><span class="toc-section-number">5</span> Sources</a></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># load python</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(reticulate)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">use_condaenv</span>(<span class="st">&quot;my_ml&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># import packages</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> sys</span>
<span id="cb2-3"><a href="#cb2-3"></a>sys.path.append(<span class="st">&quot;C:/Users/Andrew/Desktop/Projects/Deep Learning/utils&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">from</span> tools <span class="im">import</span> AverageMeter, ProgressBar</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="im">from</span> radam <span class="im">import</span> RAdam</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="im">import</span> torch</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> Dataset, random_split, DataLoader, RandomSampler</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="im">from</span> transformers <span class="im">import</span> DistilBertModel, DistilBertTokenizer</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="im">from</span> transformers <span class="im">import</span> get_linear_schedule_with_warmup, AdamW</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="im">from</span> torch.cuda.amp <span class="im">import</span> autocast, GradScaler</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, f1_score, precision_score, recall_score</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="im">import</span> time, datetime</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a>SEED <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>torch.manual_seed(SEED)</span></code></pre></div>
<pre><code>## &lt;torch._C.Generator object at 0x000000001FC6D3B0&gt;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>torch.backends.cudnn.deterministic <span class="op">=</span> <span class="va">True</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>torch.cuda.amp.autocast(enabled<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># set torch device</span></span></code></pre></div>
<pre><code>## &lt;torch.cuda.amp.autocast_mode.autocast object at 0x000000001E95B848&gt;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>device <span class="op">=</span> torch.device(<span class="st">&quot;cuda:0&quot;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&quot;cpu&quot;</span>)</span></code></pre></div>
<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Natural language processing and computer vision methods generate high-dimensional vectors that represent text and images, yet traditional databases that can be queried like SQL are not adapted to these new representations. Given enough text and media, this information can quickly encompass billions of vectors. To find similar entries means that we must find similar high-dimensional vectors which is inefficient and likely impossible with standard query languages. Similarity search fills this void by searching for similar vectors; those nearby in Euclidean space. We can leverage similarity search algorithms once our vectors are generated by deep learning algorithms. In this post, we will use Faiss â€“ Facebook AI Similarity Search.</p>
</div>
<div id="training-preparation" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Training Preparation</h1>
<p>First, we prepare our torch data set and instantiate our tokenizer.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># set tokenizer</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>tokenizer <span class="op">=</span> DistilBertTokenizer.from_pretrained(<span class="st">&#39;distilbert-base-uncased&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># Create Dataset</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw">class</span> CSVDataset(Dataset):</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="co">&quot;&quot;&quot;Propganda dataset.&quot;&quot;&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, csv_file, transform<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb7-10"><a href="#cb7-10"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">        Args:</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">            csv_file (string): Path to the csv file with annotations.</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">            transform (callable, optional): Optional transform to be applied</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">                on a sample.</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>        <span class="co"># initialize</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>        <span class="va">self</span>.data_frame <span class="op">=</span> pd.read_csv(csv_file)</span>
<span id="cb7-18"><a href="#cb7-18"></a>        <span class="co"># text col</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>        <span class="va">self</span>.text_features <span class="op">=</span> <span class="va">self</span>.data_frame[<span class="st">&#39;body&#39;</span>]</span>
<span id="cb7-20"><a href="#cb7-20"></a>        <span class="co"># target col</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>        <span class="va">self</span>.target <span class="op">=</span> <span class="va">self</span>.data_frame[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb7-22"><a href="#cb7-22"></a>        <span class="co"># initialize the transform if specified</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>        <span class="va">self</span>.transform <span class="op">=</span> transform</span>
<span id="cb7-24"><a href="#cb7-24"></a>        <span class="co"># encode outcome</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>        <span class="va">self</span>.data_frame[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> LabelEncoder().fit_transform(<span class="va">self</span>.data_frame[<span class="st">&#39;target&#39;</span>])</span>
<span id="cb7-26"><a href="#cb7-26"></a></span>
<span id="cb7-27"><a href="#cb7-27"></a>        <span class="co"># get length of df</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</span>
<span id="cb7-29"><a href="#cb7-29"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.data_frame)</span>
<span id="cb7-30"><a href="#cb7-30"></a></span>
<span id="cb7-31"><a href="#cb7-31"></a>        <span class="co"># get target</span></span>
<span id="cb7-32"><a href="#cb7-32"></a>    <span class="kw">def</span> __get_target__(<span class="va">self</span>):</span>
<span id="cb7-33"><a href="#cb7-33"></a>        <span class="cf">return</span> <span class="va">self</span>.data_frame.target</span>
<span id="cb7-34"><a href="#cb7-34"></a></span>
<span id="cb7-35"><a href="#cb7-35"></a>        <span class="co"># get df filtered by indices</span></span>
<span id="cb7-36"><a href="#cb7-36"></a>    <span class="kw">def</span> __get_values__(<span class="va">self</span>, indices):</span>
<span id="cb7-37"><a href="#cb7-37"></a>        <span class="cf">return</span> <span class="va">self</span>.data_frame.iloc[indices]</span>
<span id="cb7-38"><a href="#cb7-38"></a></span>
<span id="cb7-39"><a href="#cb7-39"></a>        <span class="co"># pull a sample of data</span></span>
<span id="cb7-40"><a href="#cb7-40"></a>    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, idx):</span>
<span id="cb7-41"><a href="#cb7-41"></a>        <span class="cf">if</span> torch.is_tensor(idx):</span>
<span id="cb7-42"><a href="#cb7-42"></a>            idx <span class="op">=</span> idx.tolist()</span>
<span id="cb7-43"><a href="#cb7-43"></a></span>
<span id="cb7-44"><a href="#cb7-44"></a>        <span class="co"># hold sample in a dict</span></span>
<span id="cb7-45"><a href="#cb7-45"></a>        sample <span class="op">=</span> {<span class="st">&#39;features&#39;</span>: <span class="va">self</span>.text_features.iloc[idx],</span>
<span id="cb7-46"><a href="#cb7-46"></a>                  <span class="st">&#39;target&#39;</span>: <span class="va">self</span>.target.iloc[idx],</span>
<span id="cb7-47"><a href="#cb7-47"></a>                  <span class="st">&#39;idx&#39;</span>: idx}</span>
<span id="cb7-48"><a href="#cb7-48"></a></span>
<span id="cb7-49"><a href="#cb7-49"></a>        <span class="cf">if</span> <span class="va">self</span>.transform:</span>
<span id="cb7-50"><a href="#cb7-50"></a>            sample <span class="op">=</span> <span class="va">self</span>.transform(sample)</span>
<span id="cb7-51"><a href="#cb7-51"></a></span>
<span id="cb7-52"><a href="#cb7-52"></a>        <span class="cf">return</span> sample</span>
<span id="cb7-53"><a href="#cb7-53"></a></span>
<span id="cb7-54"><a href="#cb7-54"></a></span>
<span id="cb7-55"><a href="#cb7-55"></a><span class="kw">class</span> Tokenize_Transform():</span>
<span id="cb7-56"><a href="#cb7-56"></a>    <span class="co"># retrieve sample and unpack it</span></span>
<span id="cb7-57"><a href="#cb7-57"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, sample):</span>
<span id="cb7-58"><a href="#cb7-58"></a>        text, target, idx <span class="op">=</span> (sample[<span class="st">&#39;features&#39;</span>],</span>
<span id="cb7-59"><a href="#cb7-59"></a>                              sample[<span class="st">&#39;target&#39;</span>],</span>
<span id="cb7-60"><a href="#cb7-60"></a>                              sample[<span class="st">&#39;idx&#39;</span>])</span>
<span id="cb7-61"><a href="#cb7-61"></a></span>
<span id="cb7-62"><a href="#cb7-62"></a>        <span class="co"># transform text to input ids and attn masks</span></span>
<span id="cb7-63"><a href="#cb7-63"></a>        tokenizer_output <span class="op">=</span> tokenizer.encode_plus(</span>
<span id="cb7-64"><a href="#cb7-64"></a>                            text,  <span class="co"># document to encode.</span></span>
<span id="cb7-65"><a href="#cb7-65"></a>                            add_special_tokens<span class="op">=</span><span class="va">True</span>,  <span class="co"># add &#39;[CLS]&#39; and &#39;[SEP]&#39;</span></span>
<span id="cb7-66"><a href="#cb7-66"></a>                            max_length<span class="op">=</span><span class="dv">512</span>,  <span class="co"># set max length</span></span>
<span id="cb7-67"><a href="#cb7-67"></a>                            truncation<span class="op">=</span><span class="va">True</span>,  <span class="co"># truncate longer messages</span></span>
<span id="cb7-68"><a href="#cb7-68"></a>                            pad_to_max_length<span class="op">=</span><span class="va">True</span>,  <span class="co"># add padding</span></span>
<span id="cb7-69"><a href="#cb7-69"></a>                            return_attention_mask<span class="op">=</span><span class="va">True</span>,  <span class="co"># create attn. masks</span></span>
<span id="cb7-70"><a href="#cb7-70"></a>                            return_tensors<span class="op">=</span><span class="st">&#39;pt&#39;</span>  <span class="co"># return pytorch tensors</span></span>
<span id="cb7-71"><a href="#cb7-71"></a>                       )</span>
<span id="cb7-72"><a href="#cb7-72"></a>        input_ids, attn_mask <span class="op">=</span> tokenizer_output[<span class="st">&#39;input_ids&#39;</span>], tokenizer_output[<span class="st">&#39;attention_mask&#39;</span>]</span>
<span id="cb7-73"><a href="#cb7-73"></a></span>
<span id="cb7-74"><a href="#cb7-74"></a>        <span class="co"># yield another dict</span></span>
<span id="cb7-75"><a href="#cb7-75"></a>        <span class="cf">return</span> {<span class="st">&#39;features&#39;</span>: torch.as_tensor(input_ids,</span>
<span id="cb7-76"><a href="#cb7-76"></a>                                         dtype<span class="op">=</span>torch.<span class="bu">long</span>,</span>
<span id="cb7-77"><a href="#cb7-77"></a>                                         device<span class="op">=</span>device).squeeze(<span class="dv">1</span>),</span>
<span id="cb7-78"><a href="#cb7-78"></a>                <span class="st">&#39;attn_mask&#39;</span>: torch.as_tensor(attn_mask,</span>
<span id="cb7-79"><a href="#cb7-79"></a>                                          dtype<span class="op">=</span>torch.<span class="bu">long</span>,</span>
<span id="cb7-80"><a href="#cb7-80"></a>                                          device<span class="op">=</span>device).squeeze(<span class="dv">1</span>),</span>
<span id="cb7-81"><a href="#cb7-81"></a>                <span class="st">&#39;target&#39;</span>: torch.as_tensor(target,</span>
<span id="cb7-82"><a href="#cb7-82"></a>                                          dtype<span class="op">=</span>torch.<span class="bu">long</span>,</span>
<span id="cb7-83"><a href="#cb7-83"></a>                                          device<span class="op">=</span>device),</span>
<span id="cb7-84"><a href="#cb7-84"></a>                <span class="st">&#39;idx&#39;</span>: torch.as_tensor(idx,</span>
<span id="cb7-85"><a href="#cb7-85"></a>                                       dtype<span class="op">=</span>torch.<span class="bu">int</span>,</span>
<span id="cb7-86"><a href="#cb7-86"></a>                                       device<span class="op">=</span>device)}</span></code></pre></div>
<p>Next we create our data sets and split them into train, validation, and test sets.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># instantiate the lazy data set</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>csv_dataset <span class="op">=</span> CSVDataset(csv_file<span class="op">=</span><span class="st">&#39;C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">Andrew</span><span class="ch">\\</span><span class="st">Desktop</span><span class="ch">\\</span><span class="st">test_export.csv&#39;</span>, transform<span class="op">=</span>Tokenize_Transform())</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># check data</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="cf">for</span> i, batch <span class="kw">in</span> <span class="bu">enumerate</span>(csv_dataset):</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb8-7"><a href="#cb8-7"></a>        <span class="cf">break</span></span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co"># set train, valid, and test size</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>train_size <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.8</span> <span class="op">*</span> <span class="bu">len</span>(csv_dataset))</span>
<span id="cb8-12"><a href="#cb8-12"></a>valid_size <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.1</span> <span class="op">*</span> <span class="bu">len</span>(csv_dataset))</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># use random split to create three data sets; +1 for odd number of data</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>train_ds, valid_ds, test_ds <span class="op">=</span> torch.utils.data.random_split(csv_dataset, [train_size, valid_size, valid_size<span class="op">+</span><span class="dv">1</span>])</span></code></pre></div>
<p>Now we create our DistilBERT model.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># create distilbert</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">class</span> DistillBERT(torch.nn.Module):</span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb9-4"><a href="#cb9-4"></a>        <span class="bu">super</span>(DistillBERT, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb9-5"><a href="#cb9-5"></a>        <span class="co"># load model</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>        <span class="va">self</span>.l1 <span class="op">=</span> DistilBertModel.from_pretrained(<span class="st">&quot;distilbert-base-uncased&quot;</span>, output_hidden_states<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a>        <span class="co"># pre-classifier layer</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>        <span class="va">self</span>.pre_classifier <span class="op">=</span> torch.nn.Linear(<span class="dv">768</span>, <span class="dv">768</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>        <span class="co"># drop out</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>        <span class="va">self</span>.dropout <span class="op">=</span> torch.nn.Dropout(<span class="fl">0.3</span>)</span>
<span id="cb9-11"><a href="#cb9-11"></a>        <span class="co"># final classification layer</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>        <span class="va">self</span>.classifier <span class="op">=</span> torch.nn.Linear(<span class="dv">768</span>, <span class="dv">2</span>)  <span class="co"># [features, targets]</span></span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, input_ids, attention_mask):</span>
<span id="cb9-15"><a href="#cb9-15"></a>        <span class="co"># generate outputs from BERT</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>        output_1 <span class="op">=</span> <span class="va">self</span>.l1(input_ids<span class="op">=</span>input_ids, attention_mask<span class="op">=</span>attention_mask)</span>
<span id="cb9-17"><a href="#cb9-17"></a>        embeddings <span class="op">=</span> output_1[<span class="dv">1</span>]  <span class="co"># 2nd tuple is the embeddings</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>        <span class="co"># stack</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>        embeddings <span class="op">=</span> torch.stack(embeddings)  <span class="co"># [layers, batch_sz, tokens, features]]</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>        <span class="co"># grab second to last layer</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>        embeddings <span class="op">=</span> embeddings[<span class="op">-</span><span class="dv">2</span>]  <span class="co"># [batch_sz, tokens, features]]</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>        <span class="co"># just get the CLS token</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>        embeddings <span class="op">=</span> embeddings[:, <span class="dv">0</span>, :]  <span class="co"># [batch_sz, features]]</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>        <span class="co"># send through pre-classifying linear layer</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>        pooled_output <span class="op">=</span> <span class="va">self</span>.pre_classifier(embeddings)</span>
<span id="cb9-26"><a href="#cb9-26"></a>        <span class="co"># relu</span></span>
<span id="cb9-27"><a href="#cb9-27"></a>        pooled_output <span class="op">=</span> torch.nn.ReLU()(pooled_output)</span>
<span id="cb9-28"><a href="#cb9-28"></a>        <span class="co"># add dropout</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>        pooled_output <span class="op">=</span> <span class="va">self</span>.dropout(pooled_output)</span>
<span id="cb9-30"><a href="#cb9-30"></a>        <span class="co"># final classifying layer to yield logits</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>        logits <span class="op">=</span> <span class="va">self</span>.classifier(pooled_output)</span>
<span id="cb9-32"><a href="#cb9-32"></a>        <span class="cf">return</span> logits</span>
<span id="cb9-33"><a href="#cb9-33"></a></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co"># load the model</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>model <span class="op">=</span> DistillBERT().to(device)</span></code></pre></div>
<p>A weighted sampler is prepared to handle class imbalance:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># prepare weighted sampling for imbalanced classification</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">def</span> create_sampler(train_ds, csv_dataset):</span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="co"># get indicies from train split</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>    train_indices <span class="op">=</span> train_ds.indices</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="co"># generate class distributions [y1, y2, etc...]</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>    bin_count <span class="op">=</span> np.bincount(csv_dataset.__get_target__()[train_indices])</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="co"># weight gen</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>    weight <span class="op">=</span> <span class="fl">1.</span> <span class="op">/</span> bin_count.astype(np.float32)</span>
<span id="cb10-9"><a href="#cb10-9"></a>    <span class="co"># produce weights for each observation in the data set</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>    samples_weight <span class="op">=</span> torch.tensor([weight[t] <span class="cf">for</span> t <span class="kw">in</span> csv_dataset.__get_target__()[train_indices]])</span>
<span id="cb10-11"><a href="#cb10-11"></a>    <span class="co"># prepare sampler</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>    sampler <span class="op">=</span> torch.utils.data.WeightedRandomSampler(weights<span class="op">=</span>samples_weight,</span>
<span id="cb10-13"><a href="#cb10-13"></a>                                                     num_samples<span class="op">=</span><span class="bu">len</span>(samples_weight),</span>
<span id="cb10-14"><a href="#cb10-14"></a>                                                     replacement<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-15"><a href="#cb10-15"></a>    <span class="cf">return</span> sampler</span></code></pre></div>
<p>And data loaders are prepared:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># create sampler for the training ds</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>train_sampler <span class="op">=</span> create_sampler(train_ds, csv_dataset)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># create DataLoaders</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>train_dataloader <span class="op">=</span> DataLoader(train_ds,</span>
<span id="cb11-6"><a href="#cb11-6"></a>                              batch_size<span class="op">=</span><span class="dv">16</span>,</span>
<span id="cb11-7"><a href="#cb11-7"></a>                              sampler<span class="op">=</span>train_sampler,</span>
<span id="cb11-8"><a href="#cb11-8"></a>                              shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co"># no_grad means we can train more quickly, hence batch_size*2</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>valid_dataloader <span class="op">=</span> DataLoader(valid_ds,</span>
<span id="cb11-12"><a href="#cb11-12"></a>                              batch_size<span class="op">=</span><span class="dv">16</span><span class="op">*</span><span class="dv">2</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>                              shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a></span>
<span id="cb11-15"><a href="#cb11-15"></a>test_dataloader <span class="op">=</span> DataLoader(test_ds,</span>
<span id="cb11-16"><a href="#cb11-16"></a>                              batch_size<span class="op">=</span><span class="dv">16</span><span class="op">*</span><span class="dv">2</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>                              shuffle<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>We can check the integrity of our data sampler like so:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># check sampler&#39;s integrity</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="cf">for</span> i, batch <span class="kw">in</span> <span class="bu">enumerate</span>(train_dataloader):</span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="bu">print</span>(<span class="st">&quot;batch index </span><span class="sc">{}</span><span class="st">, 0/1: </span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(</span>
<span id="cb12-4"><a href="#cb12-4"></a>        i, (batch[<span class="st">&#39;target&#39;</span>] <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>(), (batch[<span class="st">&#39;target&#39;</span>] <span class="op">==</span> <span class="dv">1</span>).<span class="bu">sum</span>()))</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">10</span>:</span>
<span id="cb12-6"><a href="#cb12-6"></a>        <span class="cf">break</span></span></code></pre></div>
<pre><code>## batch index 0, 0/1: 12/4
## batch index 1, 0/1: 10/6
## batch index 2, 0/1: 8/8
## batch index 3, 0/1: 7/9
## batch index 4, 0/1: 7/9
## batch index 5, 0/1: 11/5
## batch index 6, 0/1: 9/7
## batch index 7, 0/1: 10/6
## batch index 8, 0/1: 6/10
## batch index 9, 0/1: 7/9
## batch index 10, 0/1: 7/9</code></pre>
<p>Here we use mixed precision, create our optimizer and learning rate scheduler, and set the epochs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># create gradient scaler for mixed precision</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>scaler <span class="op">=</span> GradScaler()</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># create optimizer -- add L2 regularization</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>optimizer <span class="op">=</span> RAdam(model.parameters(), lr<span class="op">=</span><span class="fl">2e-6</span>, weight_decay<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># set epochs</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>epochs <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># set LR scheduler</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>scheduler <span class="op">=</span> torch.optim.lr_scheduler.OneCycleLR(optimizer,</span>
<span id="cb14-12"><a href="#cb14-12"></a>                                            max_lr<span class="op">=</span><span class="fl">2e-5</span>,</span>
<span id="cb14-13"><a href="#cb14-13"></a>                                            total_steps<span class="op">=</span><span class="bu">len</span>(train_dataloader)<span class="op">*</span>epochs)</span></code></pre></div>
<p>Our usual training and validation functions:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># train function</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">def</span> train(dataloader):</span>
<span id="cb15-3"><a href="#cb15-3"></a>    pbar <span class="op">=</span> ProgressBar(n_total<span class="op">=</span><span class="bu">len</span>(dataloader), desc<span class="op">=</span><span class="st">&#39;Training&#39;</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>    train_loss <span class="op">=</span> AverageMeter()</span>
<span id="cb15-5"><a href="#cb15-5"></a>    model.train()</span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="cf">for</span> batch_idx, batch <span class="kw">in</span> <span class="bu">enumerate</span>(dataloader):</span>
<span id="cb15-7"><a href="#cb15-7"></a>        optimizer.zero_grad()</span>
<span id="cb15-8"><a href="#cb15-8"></a>        <span class="cf">with</span> autocast():</span>
<span id="cb15-9"><a href="#cb15-9"></a>            logits <span class="op">=</span> model(input_ids<span class="op">=</span>batch[<span class="st">&#39;features&#39;</span>].squeeze(<span class="dv">1</span>), attention_mask<span class="op">=</span>batch[<span class="st">&#39;attn_mask&#39;</span>].squeeze(<span class="dv">1</span>))</span>
<span id="cb15-10"><a href="#cb15-10"></a>            loss <span class="op">=</span> F.cross_entropy(logits, batch[<span class="st">&#39;target&#39;</span>])</span>
<span id="cb15-11"><a href="#cb15-11"></a>        scaler.scale(loss).backward()</span>
<span id="cb15-12"><a href="#cb15-12"></a>        scaler.step(optimizer)</span>
<span id="cb15-13"><a href="#cb15-13"></a>        scaler.update()</span>
<span id="cb15-14"><a href="#cb15-14"></a>        scheduler.step()</span>
<span id="cb15-15"><a href="#cb15-15"></a>        pbar(step<span class="op">=</span>batch_idx, info<span class="op">=</span>{<span class="st">&#39;loss&#39;</span>: loss.item()})</span>
<span id="cb15-16"><a href="#cb15-16"></a>        train_loss.update(loss.item(), n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-17"><a href="#cb15-17"></a>    <span class="cf">return</span> {<span class="st">&#39;loss&#39;</span>: train_loss.avg}</span>
<span id="cb15-18"><a href="#cb15-18"></a></span>
<span id="cb15-19"><a href="#cb15-19"></a></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co"># valid/test function</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="kw">def</span> test(dataloader):</span>
<span id="cb15-22"><a href="#cb15-22"></a>    pbar <span class="op">=</span> ProgressBar(n_total<span class="op">=</span><span class="bu">len</span>(dataloader), desc<span class="op">=</span><span class="st">&#39;Testing&#39;</span>)</span>
<span id="cb15-23"><a href="#cb15-23"></a>    valid_loss <span class="op">=</span> AverageMeter()</span>
<span id="cb15-24"><a href="#cb15-24"></a>    valid_acc <span class="op">=</span> AverageMeter()</span>
<span id="cb15-25"><a href="#cb15-25"></a>    valid_f1 <span class="op">=</span> AverageMeter()</span>
<span id="cb15-26"><a href="#cb15-26"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb15-27"><a href="#cb15-27"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-28"><a href="#cb15-28"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb15-29"><a href="#cb15-29"></a>        <span class="cf">for</span> batch_idx, batch <span class="kw">in</span> <span class="bu">enumerate</span>(dataloader):</span>
<span id="cb15-30"><a href="#cb15-30"></a>            logits <span class="op">=</span> model(input_ids<span class="op">=</span>batch[<span class="st">&#39;features&#39;</span>].squeeze(<span class="dv">1</span>), attention_mask<span class="op">=</span>batch[<span class="st">&#39;attn_mask&#39;</span>].squeeze(<span class="dv">1</span>))</span>
<span id="cb15-31"><a href="#cb15-31"></a>            loss <span class="op">=</span> F.cross_entropy(logits, batch[<span class="st">&#39;target&#39;</span>])</span>
<span id="cb15-32"><a href="#cb15-32"></a>            pred <span class="op">=</span> logits.argmax(dim<span class="op">=</span><span class="dv">1</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-33"><a href="#cb15-33"></a>            correct <span class="op">=</span> pred.eq(batch[<span class="st">&#39;target&#39;</span>].view_as(pred)).<span class="bu">sum</span>().item()</span>
<span id="cb15-34"><a href="#cb15-34"></a>            f1 <span class="op">=</span> f1_score(pred.to(<span class="st">&quot;cpu&quot;</span>).numpy(), batch[<span class="st">&#39;target&#39;</span>].to(<span class="st">&quot;cpu&quot;</span>).numpy(), average<span class="op">=</span><span class="st">&#39;macro&#39;</span>)</span>
<span id="cb15-35"><a href="#cb15-35"></a>            valid_f1.update(f1, n<span class="op">=</span>batch[<span class="st">&#39;features&#39;</span>].size(<span class="dv">0</span>))</span>
<span id="cb15-36"><a href="#cb15-36"></a>            valid_loss.update(loss, n<span class="op">=</span>batch[<span class="st">&#39;features&#39;</span>].size(<span class="dv">0</span>))</span>
<span id="cb15-37"><a href="#cb15-37"></a>            valid_acc.update(correct, n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-38"><a href="#cb15-38"></a>            count <span class="op">+=</span> batch[<span class="st">&#39;features&#39;</span>].size(<span class="dv">0</span>)</span>
<span id="cb15-39"><a href="#cb15-39"></a>            pbar(step<span class="op">=</span>batch_idx)</span>
<span id="cb15-40"><a href="#cb15-40"></a>    <span class="cf">return</span> {<span class="st">&#39;valid_loss&#39;</span>: valid_loss.avg,</span>
<span id="cb15-41"><a href="#cb15-41"></a>            <span class="st">&#39;valid_acc&#39;</span>: valid_acc.<span class="bu">sum</span> <span class="op">/</span>count,</span>
<span id="cb15-42"><a href="#cb15-42"></a>            <span class="st">&#39;valid_f1&#39;</span>: valid_f1.avg}</span></code></pre></div>
<div id="training-and-validating" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Training and Validating</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># training</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>best_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, epochs <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb16-4"><a href="#cb16-4"></a>    train_log <span class="op">=</span> train(train_dataloader)</span>
<span id="cb16-5"><a href="#cb16-5"></a>    valid_log <span class="op">=</span> test(valid_dataloader)</span>
<span id="cb16-6"><a href="#cb16-6"></a>    logs <span class="op">=</span> <span class="bu">dict</span>(train_log, <span class="op">**</span>valid_log)</span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> logs.items():</span>
<span id="cb16-8"><a href="#cb16-8"></a>        <span class="cf">if</span> key <span class="op">==</span> <span class="st">&#39;valid_loss&#39;</span>:</span>
<span id="cb16-9"><a href="#cb16-9"></a>            <span class="cf">if</span> value.item() <span class="op">&lt;</span> best_loss:</span>
<span id="cb16-10"><a href="#cb16-10"></a>                torch.save(model.state_dict(), <span class="st">&#39;distilbert-model1.pt&#39;</span>)  <span class="co"># torch save</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>            best_loss <span class="op">=</span> value.item()</span>
<span id="cb16-12"><a href="#cb16-12"></a>    show_info <span class="op">=</span> <span class="ss">f&#39;</span><span class="ch">\n</span><span class="ss">Epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss"> - &#39;</span> <span class="op">+</span> <span class="st">&quot;-&quot;</span>.join([<span class="ss">f&#39; </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss"> &#39;</span> <span class="cf">for</span> key, value <span class="kw">in</span> logs.items()])</span>
<span id="cb16-13"><a href="#cb16-13"></a>    <span class="bu">print</span>(show_info)</span></code></pre></div>
<pre><code>## 
[Training] 1/503 [..............................] - ETA: 9:22  loss: 0.6889 
[Training] 2/503 [..............................] - ETA: 5:57  loss: 0.7109 
[Training] 3/503 [..............................] - ETA: 4:43  loss: 0.7192 
[Training] 4/503 [..............................] - ETA: 4:05  loss: 0.7126 
[Training] 5/503 [..............................] - ETA: 3:44  loss: 0.7277 
[Training] 6/503 [..............................] - ETA: 3:28  loss: 0.6549 
[Training] 7/503 [..............................] - ETA: 3:17  loss: 0.7304 
[Training] 8/503 [..............................] - ETA: 3:14  loss: 0.7015 
[Training] 9/503 [..............................] - ETA: 3:10  loss: 0.7170 
[Training] 10/503 [..............................] - ETA: 3:04  loss: 0.6770 
[Training] 11/503 [..............................] - ETA: 3:01  loss: 0.6537 
[Training] 12/503 [..............................] - ETA: 2:56  loss: 0.7303 
[Training] 13/503 [..............................] - ETA: 2:53  loss: 0.6678 
[Training] 14/503 [..............................] - ETA: 2:51  loss: 0.6894 
[Training] 15/503 [..............................] - ETA: 2:48  loss: 0.6612 
[Training] 16/503 [..............................] - ETA: 2:45  loss: 0.6727 
[Training] 17/503 [&gt;.............................] - ETA: 2:47  loss: 0.6954 
[Training] 18/503 [&gt;.............................] - ETA: 2:46  loss: 0.6909 
[Training] 19/503 [&gt;.............................] - ETA: 2:45  loss: 0.7297 
[Training] 20/503 [&gt;.............................] - ETA: 2:43  loss: 0.7226 
[Training] 21/503 [&gt;.............................] - ETA: 2:41  loss: 0.7065 
[Training] 22/503 [&gt;.............................] - ETA: 2:38  loss: 0.6777 
[Training] 23/503 [&gt;.............................] - ETA: 2:37  loss: 0.7080 
[Training] 24/503 [&gt;.............................] - ETA: 2:35  loss: 0.6235 
[Training] 25/503 [&gt;.............................] - ETA: 2:33  loss: 0.7081 
[Training] 26/503 [&gt;.............................] - ETA: 2:31  loss: 0.7174 
[Training] 27/503 [&gt;.............................] - ETA: 2:32  loss: 0.6788 
[Training] 28/503 [&gt;.............................] - ETA: 2:30  loss: 0.6739 
[Training] 29/503 [&gt;.............................] - ETA: 2:29  loss: 0.7203 
[Training] 30/503 [&gt;.............................] - ETA: 2:28  loss: 0.7408 
[Training] 31/503 [&gt;.............................] - ETA: 2:28  loss: 0.7106 
[Training] 32/503 [&gt;.............................] - ETA: 2:26  loss: 0.7531 
[Training] 33/503 [&gt;.............................] - ETA: 2:26  loss: 0.7019 
[Training] 34/503 [=&gt;............................] - ETA: 2:25  loss: 0.7120 
[Training] 35/503 [=&gt;............................] - ETA: 2:24  loss: 0.6741 
[Training] 36/503 [=&gt;............................] - ETA: 2:24  loss: 0.7105 
[Training] 37/503 [=&gt;............................] - ETA: 2:24  loss: 0.7134 
[Training] 38/503 [=&gt;............................] - ETA: 2:24  loss: 0.7344 
[Training] 39/503 [=&gt;............................] - ETA: 2:23  loss: 0.7243 
[Training] 40/503 [=&gt;............................] - ETA: 2:23  loss: 0.7285 
[Training] 41/503 [=&gt;............................] - ETA: 2:22  loss: 0.6894 
[Training] 42/503 [=&gt;............................] - ETA: 2:22  loss: 0.6820 
[Training] 43/503 [=&gt;............................] - ETA: 2:22  loss: 0.6829 
[Training] 44/503 [=&gt;............................] - ETA: 2:21  loss: 0.6622 
[Training] 45/503 [=&gt;............................] - ETA: 2:21  loss: 0.6962 
[Training] 46/503 [=&gt;............................] - ETA: 2:20  loss: 0.6940 
[Training] 47/503 [=&gt;............................] - ETA: 2:20  loss: 0.6839 
[Training] 48/503 [=&gt;............................] - ETA: 2:20  loss: 0.7031 
[Training] 49/503 [=&gt;............................] - ETA: 2:19  loss: 0.7010 
[Training] 50/503 [=&gt;............................] - ETA: 2:18  loss: 0.7076 
[Training] 51/503 [==&gt;...........................] - ETA: 2:18  loss: 0.6716 
[Training] 52/503 [==&gt;...........................] - ETA: 2:19  loss: 0.7187 
[Training] 53/503 [==&gt;...........................] - ETA: 2:18  loss: 0.6877 
[Training] 54/503 [==&gt;...........................] - ETA: 2:18  loss: 0.6967 
[Training] 55/503 [==&gt;...........................] - ETA: 2:17  loss: 0.6947 
[Training] 56/503 [==&gt;...........................] - ETA: 2:17  loss: 0.7477 
[Training] 57/503 [==&gt;...........................] - ETA: 2:16  loss: 0.7432 
[Training] 58/503 [==&gt;...........................] - ETA: 2:16  loss: 0.7558 
[Training] 59/503 [==&gt;...........................] - ETA: 2:16  loss: 0.6659 
[Training] 60/503 [==&gt;...........................] - ETA: 2:16  loss: 0.6606 
[Training] 61/503 [==&gt;...........................] - ETA: 2:15  loss: 0.7150 
[Training] 62/503 [==&gt;...........................] - ETA: 2:15  loss: 0.6785 
[Training] 63/503 [==&gt;...........................] - ETA: 2:15  loss: 0.6642 
[Training] 64/503 [==&gt;...........................] - ETA: 2:15  loss: 0.6802 
[Training] 65/503 [==&gt;...........................] - ETA: 2:14  loss: 0.6893 
[Training] 66/503 [==&gt;...........................] - ETA: 2:14  loss: 0.7032 
[Training] 67/503 [==&gt;...........................] - ETA: 2:14  loss: 0.7495 
[Training] 68/503 [===&gt;..........................] - ETA: 2:13  loss: 0.6712 
[Training] 69/503 [===&gt;..........................] - ETA: 2:12  loss: 0.7138 
[Training] 70/503 [===&gt;..........................] - ETA: 2:12  loss: 0.6518 
[Training] 71/503 [===&gt;..........................] - ETA: 2:12  loss: 0.6565 
[Training] 72/503 [===&gt;..........................] - ETA: 2:11  loss: 0.6948 
[Training] 73/503 [===&gt;..........................] - ETA: 2:11  loss: 0.6749 
[Training] 74/503 [===&gt;..........................] - ETA: 2:10  loss: 0.6662 
[Training] 75/503 [===&gt;..........................] - ETA: 2:10  loss: 0.7123 
[Training] 76/503 [===&gt;..........................] - ETA: 2:10  loss: 0.6228 
[Training] 77/503 [===&gt;..........................] - ETA: 2:09  loss: 0.6396 
[Training] 78/503 [===&gt;..........................] - ETA: 2:09  loss: 0.6917 
[Training] 79/503 [===&gt;..........................] - ETA: 2:09  loss: 0.6503 
[Training] 80/503 [===&gt;..........................] - ETA: 2:08  loss: 0.6892 
[Training] 81/503 [===&gt;..........................] - ETA: 2:08  loss: 0.7040 
[Training] 82/503 [===&gt;..........................] - ETA: 2:08  loss: 0.6802 
[Training] 83/503 [===&gt;..........................] - ETA: 2:07  loss: 0.6349 
[Training] 84/503 [====&gt;.........................] - ETA: 2:07  loss: 0.6660 
[Training] 85/503 [====&gt;.........................] - ETA: 2:07  loss: 0.6806 
[Training] 86/503 [====&gt;.........................] - ETA: 2:06  loss: 0.6572 
[Training] 87/503 [====&gt;.........................] - ETA: 2:06  loss: 0.6593 
[Training] 88/503 [====&gt;.........................] - ETA: 2:05  loss: 0.6690 
[Training] 89/503 [====&gt;.........................] - ETA: 2:05  loss: 0.7217 
[Training] 90/503 [====&gt;.........................] - ETA: 2:04  loss: 0.6422 
[Training] 91/503 [====&gt;.........................] - ETA: 2:04  loss: 0.6554 
[Training] 92/503 [====&gt;.........................] - ETA: 2:04  loss: 0.7028 
[Training] 93/503 [====&gt;.........................] - ETA: 2:04  loss: 0.7341 
[Training] 94/503 [====&gt;.........................] - ETA: 2:04  loss: 0.6380 
[Training] 95/503 [====&gt;.........................] - ETA: 2:03  loss: 0.6456 
[Training] 96/503 [====&gt;.........................] - ETA: 2:03  loss: 0.6893 
[Training] 97/503 [====&gt;.........................] - ETA: 2:03  loss: 0.7030 
[Training] 98/503 [====&gt;.........................] - ETA: 2:02  loss: 0.7179 
[Training] 99/503 [====&gt;.........................] - ETA: 2:02  loss: 0.6949 
[Training] 100/503 [====&gt;.........................] - ETA: 2:02  loss: 0.6714 
[Training] 101/503 [=====&gt;........................] - ETA: 2:01  loss: 0.6649 
[Training] 102/503 [=====&gt;........................] - ETA: 2:01  loss: 0.6882 
[Training] 103/503 [=====&gt;........................] - ETA: 2:01  loss: 0.6640 
[Training] 104/503 [=====&gt;........................] - ETA: 2:01  loss: 0.5858 
[Training] 105/503 [=====&gt;........................] - ETA: 2:00  loss: 0.6981 
[Training] 106/503 [=====&gt;........................] - ETA: 2:00  loss: 0.6754 
[Training] 107/503 [=====&gt;........................] - ETA: 2:00  loss: 0.6426 
[Training] 108/503 [=====&gt;........................] - ETA: 1:59  loss: 0.6887 
[Training] 109/503 [=====&gt;........................] - ETA: 1:59  loss: 0.6880 
[Training] 110/503 [=====&gt;........................] - ETA: 1:59  loss: 0.6759 
[Training] 111/503 [=====&gt;........................] - ETA: 1:58  loss: 0.6222 
[Training] 112/503 [=====&gt;........................] - ETA: 1:58  loss: 0.6708 
[Training] 113/503 [=====&gt;........................] - ETA: 1:57  loss: 0.6676 
[Training] 114/503 [=====&gt;........................] - ETA: 1:57  loss: 0.7059 
[Training] 115/503 [=====&gt;........................] - ETA: 1:57  loss: 0.6594 
[Training] 116/503 [=====&gt;........................] - ETA: 1:56  loss: 0.6869 
[Training] 117/503 [=====&gt;........................] - ETA: 1:56  loss: 0.7244 
[Training] 118/503 [======&gt;.......................] - ETA: 1:56  loss: 0.6386 
[Training] 119/503 [======&gt;.......................] - ETA: 1:56  loss: 0.6855 
[Training] 120/503 [======&gt;.......................] - ETA: 1:55  loss: 0.6946 
[Training] 121/503 [======&gt;.......................] - ETA: 1:55  loss: 0.6755 
[Training] 122/503 [======&gt;.......................] - ETA: 1:55  loss: 0.6473 
[Training] 123/503 [======&gt;.......................] - ETA: 1:55  loss: 0.6892 
[Training] 124/503 [======&gt;.......................] - ETA: 1:54  loss: 0.6555 
[Training] 125/503 [======&gt;.......................] - ETA: 1:54  loss: 0.6491 
[Training] 126/503 [======&gt;.......................] - ETA: 1:54  loss: 0.6253 
[Training] 127/503 [======&gt;.......................] - ETA: 1:53  loss: 0.6766 
[Training] 128/503 [======&gt;.......................] - ETA: 1:54  loss: 0.6329 
[Training] 129/503 [======&gt;.......................] - ETA: 1:53  loss: 0.6377 
[Training] 130/503 [======&gt;.......................] - ETA: 1:53  loss: 0.6748 
[Training] 131/503 [======&gt;.......................] - ETA: 1:52  loss: 0.6617 
[Training] 132/503 [======&gt;.......................] - ETA: 1:52  loss: 0.6700 
[Training] 133/503 [======&gt;.......................] - ETA: 1:52  loss: 0.6669 
[Training] 134/503 [======&gt;.......................] - ETA: 1:51  loss: 0.6551 
[Training] 135/503 [=======&gt;......................] - ETA: 1:51  loss: 0.6495 
[Training] 136/503 [=======&gt;......................] - ETA: 1:51  loss: 0.6451 
[Training] 137/503 [=======&gt;......................] - ETA: 1:51  loss: 0.7292 
[Training] 138/503 [=======&gt;......................] - ETA: 1:50  loss: 0.6361 
[Training] 139/503 [=======&gt;......................] - ETA: 1:50  loss: 0.6481 
[Training] 140/503 [=======&gt;......................] - ETA: 1:50  loss: 0.6484 
[Training] 141/503 [=======&gt;......................] - ETA: 1:49  loss: 0.6312 
[Training] 142/503 [=======&gt;......................] - ETA: 1:49  loss: 0.6466 
[Training] 143/503 [=======&gt;......................] - ETA: 1:49  loss: 0.6290 
[Training] 144/503 [=======&gt;......................] - ETA: 1:48  loss: 0.6427 
[Training] 145/503 [=======&gt;......................] - ETA: 1:48  loss: 0.6649 
[Training] 146/503 [=======&gt;......................] - ETA: 1:48  loss: 0.6298 
[Training] 147/503 [=======&gt;......................] - ETA: 1:48  loss: 0.6655 
[Training] 148/503 [=======&gt;......................] - ETA: 1:47  loss: 0.7013 
[Training] 149/503 [=======&gt;......................] - ETA: 1:47  loss: 0.6050 
[Training] 150/503 [=======&gt;......................] - ETA: 1:47  loss: 0.6658 
[Training] 151/503 [========&gt;.....................] - ETA: 1:47  loss: 0.6505 
[Training] 152/503 [========&gt;.....................] - ETA: 1:46  loss: 0.6086 
[Training] 153/503 [========&gt;.....................] - ETA: 1:46  loss: 0.6236 
[Training] 154/503 [========&gt;.....................] - ETA: 1:45  loss: 0.6379 
[Training] 155/503 [========&gt;.....................] - ETA: 1:45  loss: 0.6684 
[Training] 156/503 [========&gt;.....................] - ETA: 1:45  loss: 0.6245 
[Training] 157/503 [========&gt;.....................] - ETA: 1:44  loss: 0.6262 
[Training] 158/503 [========&gt;.....................] - ETA: 1:44  loss: 0.6175 
[Training] 159/503 [========&gt;.....................] - ETA: 1:44  loss: 0.6632 
[Training] 160/503 [========&gt;.....................] - ETA: 1:43  loss: 0.6210 
[Training] 161/503 [========&gt;.....................] - ETA: 1:43  loss: 0.6429 
[Training] 162/503 [========&gt;.....................] - ETA: 1:43  loss: 0.5987 
[Training] 163/503 [========&gt;.....................] - ETA: 1:43  loss: 0.6441 
[Training] 164/503 [========&gt;.....................] - ETA: 1:42  loss: 0.6173 
[Training] 165/503 [========&gt;.....................] - ETA: 1:42  loss: 0.5548 
[Training] 166/503 [========&gt;.....................] - ETA: 1:42  loss: 0.6691 
[Training] 167/503 [========&gt;.....................] - ETA: 1:41  loss: 0.6397 
[Training] 168/503 [=========&gt;....................] - ETA: 1:41  loss: 0.6225 
[Training] 169/503 [=========&gt;....................] - ETA: 1:41  loss: 0.6520 
[Training] 170/503 [=========&gt;....................] - ETA: 1:41  loss: 0.6075 
[Training] 171/503 [=========&gt;....................] - ETA: 1:40  loss: 0.6044 
[Training] 172/503 [=========&gt;....................] - ETA: 1:40  loss: 0.6051 
[Training] 173/503 [=========&gt;....................] - ETA: 1:39  loss: 0.6372 
[Training] 174/503 [=========&gt;....................] - ETA: 1:39  loss: 0.5851 
[Training] 175/503 [=========&gt;....................] - ETA: 1:39  loss: 0.6355 
[Training] 176/503 [=========&gt;....................] - ETA: 1:38  loss: 0.6067 
[Training] 177/503 [=========&gt;....................] - ETA: 1:38  loss: 0.6176 
[Training] 178/503 [=========&gt;....................] - ETA: 1:38  loss: 0.6631 
[Training] 179/503 [=========&gt;....................] - ETA: 1:37  loss: 0.6716 
[Training] 180/503 [=========&gt;....................] - ETA: 1:37  loss: 0.6588 
[Training] 181/503 [=========&gt;....................] - ETA: 1:37  loss: 0.6192 
[Training] 182/503 [=========&gt;....................] - ETA: 1:37  loss: 0.6148 
[Training] 183/503 [=========&gt;....................] - ETA: 1:36  loss: 0.5609 
[Training] 184/503 [=========&gt;....................] - ETA: 1:36  loss: 0.5942 
[Training] 185/503 [==========&gt;...................] - ETA: 1:36  loss: 0.6248 
[Training] 186/503 [==========&gt;...................] - ETA: 1:35  loss: 0.5985 
[Training] 187/503 [==========&gt;...................] - ETA: 1:35  loss: 0.5803 
[Training] 188/503 [==========&gt;...................] - ETA: 1:35  loss: 0.6107 
[Training] 189/503 [==========&gt;...................] - ETA: 1:34  loss: 0.6081 
[Training] 190/503 [==========&gt;...................] - ETA: 1:34  loss: 0.5361 
[Training] 191/503 [==========&gt;...................] - ETA: 1:34  loss: 0.6254 
[Training] 192/503 [==========&gt;...................] - ETA: 1:33  loss: 0.5507 
[Training] 193/503 [==========&gt;...................] - ETA: 1:33  loss: 0.6292 
[Training] 194/503 [==========&gt;...................] - ETA: 1:33  loss: 0.6150 
[Training] 195/503 [==========&gt;...................] - ETA: 1:33  loss: 0.5952 
[Training] 196/503 [==========&gt;...................] - ETA: 1:32  loss: 0.6032 
[Training] 197/503 [==========&gt;...................] - ETA: 1:32  loss: 0.5609 
[Training] 198/503 [==========&gt;...................] - ETA: 1:32  loss: 0.5622 
[Training] 199/503 [==========&gt;...................] - ETA: 1:32  loss: 0.5027 
[Training] 200/503 [==========&gt;...................] - ETA: 1:31  loss: 0.5975 
[Training] 201/503 [==========&gt;...................] - ETA: 1:31  loss: 0.5579 
[Training] 202/503 [===========&gt;..................] - ETA: 1:31  loss: 0.5693 
[Training] 203/503 [===========&gt;..................] - ETA: 1:30  loss: 0.5595 
[Training] 204/503 [===========&gt;..................] - ETA: 1:30  loss: 0.5841 
[Training] 205/503 [===========&gt;..................] - ETA: 1:30  loss: 0.5269 
[Training] 206/503 [===========&gt;..................] - ETA: 1:30  loss: 0.6306 
[Training] 207/503 [===========&gt;..................] - ETA: 1:29  loss: 0.5981 
[Training] 208/503 [===========&gt;..................] - ETA: 1:29  loss: 0.5568 
[Training] 209/503 [===========&gt;..................] - ETA: 1:29  loss: 0.5903 
[Training] 210/503 [===========&gt;..................] - ETA: 1:28  loss: 0.5093 
[Training] 211/503 [===========&gt;..................] - ETA: 1:28  loss: 0.5837 
[Training] 212/503 [===========&gt;..................] - ETA: 1:28  loss: 0.5489 
[Training] 213/503 [===========&gt;..................] - ETA: 1:27  loss: 0.5428 
[Training] 214/503 [===========&gt;..................] - ETA: 1:27  loss: 0.5621 
[Training] 215/503 [===========&gt;..................] - ETA: 1:27  loss: 0.5433 
[Training] 216/503 [===========&gt;..................] - ETA: 1:27  loss: 0.5627 
[Training] 217/503 [===========&gt;..................] - ETA: 1:26  loss: 0.5789 
[Training] 218/503 [============&gt;.................] - ETA: 1:26  loss: 0.5095 
[Training] 219/503 [============&gt;.................] - ETA: 1:26  loss: 0.5295 
[Training] 220/503 [============&gt;.................] - ETA: 1:25  loss: 0.5235 
[Training] 221/503 [============&gt;.................] - ETA: 1:25  loss: 0.4807 
[Training] 222/503 [============&gt;.................] - ETA: 1:25  loss: 0.5804 
[Training] 223/503 [============&gt;.................] - ETA: 1:24  loss: 0.5260 
[Training] 224/503 [============&gt;.................] - ETA: 1:24  loss: 0.5771 
[Training] 225/503 [============&gt;.................] - ETA: 1:24  loss: 0.4920 
[Training] 226/503 [============&gt;.................] - ETA: 1:23  loss: 0.5827 
[Training] 227/503 [============&gt;.................] - ETA: 1:23  loss: 0.5217 
[Training] 228/503 [============&gt;.................] - ETA: 1:23  loss: 0.4356 
[Training] 229/503 [============&gt;.................] - ETA: 1:22  loss: 0.5099 
[Training] 230/503 [============&gt;.................] - ETA: 1:22  loss: 0.5268 
[Training] 231/503 [============&gt;.................] - ETA: 1:22  loss: 0.5163 
[Training] 232/503 [============&gt;.................] - ETA: 1:22  loss: 0.6524 
[Training] 233/503 [============&gt;.................] - ETA: 1:21  loss: 0.5826 
[Training] 234/503 [============&gt;.................] - ETA: 1:21  loss: 0.5419 
[Training] 235/503 [=============&gt;................] - ETA: 1:21  loss: 0.5659 
[Training] 236/503 [=============&gt;................] - ETA: 1:20  loss: 0.4399 
[Training] 237/503 [=============&gt;................] - ETA: 1:20  loss: 0.5203 
[Training] 238/503 [=============&gt;................] - ETA: 1:20  loss: 0.3832 
[Training] 239/503 [=============&gt;................] - ETA: 1:19  loss: 0.4461 
[Training] 240/503 [=============&gt;................] - ETA: 1:19  loss: 0.5053 
[Training] 241/503 [=============&gt;................] - ETA: 1:19  loss: 0.5866 
[Training] 242/503 [=============&gt;................] - ETA: 1:19  loss: 0.5858 
[Training] 243/503 [=============&gt;................] - ETA: 1:18  loss: 0.5106 
[Training] 244/503 [=============&gt;................] - ETA: 1:18  loss: 0.4966 
[Training] 245/503 [=============&gt;................] - ETA: 1:18  loss: 0.7902 
[Training] 246/503 [=============&gt;................] - ETA: 1:17  loss: 0.4292 
[Training] 247/503 [=============&gt;................] - ETA: 1:17  loss: 0.5631 
[Training] 248/503 [=============&gt;................] - ETA: 1:17  loss: 0.4323 
[Training] 249/503 [=============&gt;................] - ETA: 1:16  loss: 0.5027 
[Training] 250/503 [=============&gt;................] - ETA: 1:16  loss: 0.3917 
[Training] 251/503 [=============&gt;................] - ETA: 1:16  loss: 0.4898 
[Training] 252/503 [==============&gt;...............] - ETA: 1:15  loss: 0.4593 
[Training] 253/503 [==============&gt;...............] - ETA: 1:15  loss: 0.5606 
[Training] 254/503 [==============&gt;...............] - ETA: 1:15  loss: 0.4031 
[Training] 255/503 [==============&gt;...............] - ETA: 1:14  loss: 0.4550 
[Training] 256/503 [==============&gt;...............] - ETA: 1:14  loss: 0.5219 
[Training] 257/503 [==============&gt;...............] - ETA: 1:14  loss: 0.5700 
[Training] 258/503 [==============&gt;...............] - ETA: 1:14  loss: 0.3597 
[Training] 259/503 [==============&gt;...............] - ETA: 1:13  loss: 0.3399 
[Training] 260/503 [==============&gt;...............] - ETA: 1:13  loss: 0.4589 
[Training] 261/503 [==============&gt;...............] - ETA: 1:13  loss: 0.4540 
[Training] 262/503 [==============&gt;...............] - ETA: 1:12  loss: 0.5298 
[Training] 263/503 [==============&gt;...............] - ETA: 1:12  loss: 0.4984 
[Training] 264/503 [==============&gt;...............] - ETA: 1:12  loss: 0.5889 
[Training] 265/503 [==============&gt;...............] - ETA: 1:11  loss: 0.3163 
[Training] 266/503 [==============&gt;...............] - ETA: 1:11  loss: 0.5060 
[Training] 267/503 [==============&gt;...............] - ETA: 1:11  loss: 0.4191 
[Training] 268/503 [==============&gt;...............] - ETA: 1:10  loss: 0.3886 
[Training] 269/503 [===============&gt;..............] - ETA: 1:10  loss: 0.3468 
[Training] 270/503 [===============&gt;..............] - ETA: 1:10  loss: 0.3405 
[Training] 271/503 [===============&gt;..............] - ETA: 1:10  loss: 0.4630 
[Training] 272/503 [===============&gt;..............] - ETA: 1:09  loss: 0.5077 
[Training] 273/503 [===============&gt;..............] - ETA: 1:09  loss: 0.3034 
[Training] 274/503 [===============&gt;..............] - ETA: 1:09  loss: 0.5512 
[Training] 275/503 [===============&gt;..............] - ETA: 1:08  loss: 0.4305 
[Training] 276/503 [===============&gt;..............] - ETA: 1:08  loss: 0.3071 
[Training] 277/503 [===============&gt;..............] - ETA: 1:08  loss: 0.3003 
[Training] 278/503 [===============&gt;..............] - ETA: 1:07  loss: 0.4905 
[Training] 279/503 [===============&gt;..............] - ETA: 1:07  loss: 0.5161 
[Training] 280/503 [===============&gt;..............] - ETA: 1:07  loss: 0.4583 
[Training] 281/503 [===============&gt;..............] - ETA: 1:07  loss: 0.6390 
[Training] 282/503 [===============&gt;..............] - ETA: 1:06  loss: 0.5366 
[Training] 283/503 [===============&gt;..............] - ETA: 1:06  loss: 0.3474 
[Training] 284/503 [===============&gt;..............] - ETA: 1:06  loss: 0.5032 
[Training] 285/503 [===============&gt;..............] - ETA: 1:05  loss: 0.5422 
[Training] 286/503 [================&gt;.............] - ETA: 1:05  loss: 0.5296 
[Training] 287/503 [================&gt;.............] - ETA: 1:05  loss: 0.4175 
[Training] 288/503 [================&gt;.............] - ETA: 1:04  loss: 0.6020 
[Training] 289/503 [================&gt;.............] - ETA: 1:04  loss: 0.4587 
[Training] 290/503 [================&gt;.............] - ETA: 1:04  loss: 0.5209 
[Training] 291/503 [================&gt;.............] - ETA: 1:04  loss: 0.4596 
[Training] 292/503 [================&gt;.............] - ETA: 1:03  loss: 0.2724 
[Training] 293/503 [================&gt;.............] - ETA: 1:03  loss: 0.3020 
[Training] 294/503 [================&gt;.............] - ETA: 1:03  loss: 0.3759 
[Training] 295/503 [================&gt;.............] - ETA: 1:02  loss: 0.4351 
[Training] 296/503 [================&gt;.............] - ETA: 1:02  loss: 0.3301 
[Training] 297/503 [================&gt;.............] - ETA: 1:02  loss: 0.5219 
[Training] 298/503 [================&gt;.............] - ETA: 1:01  loss: 0.3130 
[Training] 299/503 [================&gt;.............] - ETA: 1:01  loss: 0.4303 
[Training] 300/503 [================&gt;.............] - ETA: 1:01  loss: 0.6201 
[Training] 301/503 [================&gt;.............] - ETA: 1:00  loss: 0.2385 
[Training] 302/503 [=================&gt;............] - ETA: 1:00  loss: 0.3272 
[Training] 303/503 [=================&gt;............] - ETA: 1:00  loss: 0.2927 
[Training] 304/503 [=================&gt;............] - ETA: 1:00  loss: 0.4361 
[Training] 305/503 [=================&gt;............] - ETA: 59s  loss: 0.3450 
[Training] 306/503 [=================&gt;............] - ETA: 59s  loss: 0.5950 
[Training] 307/503 [=================&gt;............] - ETA: 59s  loss: 0.2722 
[Training] 308/503 [=================&gt;............] - ETA: 58s  loss: 0.2171 
[Training] 309/503 [=================&gt;............] - ETA: 58s  loss: 0.4889 
[Training] 310/503 [=================&gt;............] - ETA: 58s  loss: 0.3050 
[Training] 311/503 [=================&gt;............] - ETA: 58s  loss: 0.4564 
[Training] 312/503 [=================&gt;............] - ETA: 57s  loss: 0.1771 
[Training] 313/503 [=================&gt;............] - ETA: 57s  loss: 0.3167 
[Training] 314/503 [=================&gt;............] - ETA: 57s  loss: 0.5343 
[Training] 315/503 [=================&gt;............] - ETA: 56s  loss: 0.4308 
[Training] 316/503 [=================&gt;............] - ETA: 56s  loss: 0.3896 
[Training] 317/503 [=================&gt;............] - ETA: 56s  loss: 0.2889 
[Training] 318/503 [=================&gt;............] - ETA: 55s  loss: 0.5619 
[Training] 319/503 [==================&gt;...........] - ETA: 55s  loss: 0.2372 
[Training] 320/503 [==================&gt;...........] - ETA: 55s  loss: 0.4131 
[Training] 321/503 [==================&gt;...........] - ETA: 54s  loss: 0.4532 
[Training] 322/503 [==================&gt;...........] - ETA: 54s  loss: 0.2107 
[Training] 323/503 [==================&gt;...........] - ETA: 54s  loss: 0.4538 
[Training] 324/503 [==================&gt;...........] - ETA: 54s  loss: 0.2194 
[Training] 325/503 [==================&gt;...........] - ETA: 53s  loss: 0.3151 
[Training] 326/503 [==================&gt;...........] - ETA: 53s  loss: 0.3551 
[Training] 327/503 [==================&gt;...........] - ETA: 53s  loss: 0.1563 
[Training] 328/503 [==================&gt;...........] - ETA: 52s  loss: 0.3500 
[Training] 329/503 [==================&gt;...........] - ETA: 52s  loss: 0.4606 
[Training] 330/503 [==================&gt;...........] - ETA: 52s  loss: 0.7329 
[Training] 331/503 [==================&gt;...........] - ETA: 52s  loss: 0.3899 
[Training] 332/503 [==================&gt;...........] - ETA: 51s  loss: 0.4197 
[Training] 333/503 [==================&gt;...........] - ETA: 51s  loss: 0.3329 
[Training] 334/503 [==================&gt;...........] - ETA: 51s  loss: 0.4190 
[Training] 335/503 [==================&gt;...........] - ETA: 50s  loss: 0.4346 
[Training] 336/503 [===================&gt;..........] - ETA: 50s  loss: 0.3011 
[Training] 337/503 [===================&gt;..........] - ETA: 50s  loss: 0.2380 
[Training] 338/503 [===================&gt;..........] - ETA: 50s  loss: 0.8120 
[Training] 339/503 [===================&gt;..........] - ETA: 49s  loss: 0.5050 
[Training] 340/503 [===================&gt;..........] - ETA: 49s  loss: 0.4268 
[Training] 341/503 [===================&gt;..........] - ETA: 49s  loss: 0.6895 
[Training] 342/503 [===================&gt;..........] - ETA: 48s  loss: 0.2391 
[Training] 343/503 [===================&gt;..........] - ETA: 48s  loss: 0.3712 
[Training] 344/503 [===================&gt;..........] - ETA: 48s  loss: 0.7709 
[Training] 345/503 [===================&gt;..........] - ETA: 47s  loss: 0.3843 
[Training] 346/503 [===================&gt;..........] - ETA: 47s  loss: 0.5133 
[Training] 347/503 [===================&gt;..........] - ETA: 47s  loss: 0.3522 
[Training] 348/503 [===================&gt;..........] - ETA: 46s  loss: 0.3195 
[Training] 349/503 [===================&gt;..........] - ETA: 46s  loss: 0.4873 
[Training] 350/503 [===================&gt;..........] - ETA: 46s  loss: 0.3347 
[Training] 351/503 [===================&gt;..........] - ETA: 46s  loss: 0.5921 
[Training] 352/503 [===================&gt;..........] - ETA: 45s  loss: 0.3070 
[Training] 353/503 [====================&gt;.........] - ETA: 45s  loss: 0.5598 
[Training] 354/503 [====================&gt;.........] - ETA: 45s  loss: 0.1489 
[Training] 355/503 [====================&gt;.........] - ETA: 44s  loss: 0.2687 
[Training] 356/503 [====================&gt;.........] - ETA: 44s  loss: 0.2897 
[Training] 357/503 [====================&gt;.........] - ETA: 44s  loss: 0.4391 
[Training] 358/503 [====================&gt;.........] - ETA: 43s  loss: 0.2742 
[Training] 359/503 [====================&gt;.........] - ETA: 43s  loss: 0.3508 
[Training] 360/503 [====================&gt;.........] - ETA: 43s  loss: 0.3895 
[Training] 361/503 [====================&gt;.........] - ETA: 43s  loss: 0.2362 
[Training] 362/503 [====================&gt;.........] - ETA: 42s  loss: 0.3088 
[Training] 363/503 [====================&gt;.........] - ETA: 42s  loss: 0.7603 
[Training] 364/503 [====================&gt;.........] - ETA: 42s  loss: 0.2899 
[Training] 365/503 [====================&gt;.........] - ETA: 41s  loss: 0.2789 
[Training] 366/503 [====================&gt;.........] - ETA: 41s  loss: 0.4560 
[Training] 367/503 [====================&gt;.........] - ETA: 41s  loss: 0.3966 
[Training] 368/503 [====================&gt;.........] - ETA: 40s  loss: 0.5861 
[Training] 369/503 [=====================&gt;........] - ETA: 40s  loss: 0.3595 
[Training] 370/503 [=====================&gt;........] - ETA: 40s  loss: 0.2413 
[Training] 371/503 [=====================&gt;........] - ETA: 40s  loss: 0.4694 
[Training] 372/503 [=====================&gt;........] - ETA: 39s  loss: 0.4357 
[Training] 373/503 [=====================&gt;........] - ETA: 39s  loss: 0.7574 
[Training] 374/503 [=====================&gt;........] - ETA: 39s  loss: 0.1745 
[Training] 375/503 [=====================&gt;........] - ETA: 38s  loss: 0.5595 
[Training] 376/503 [=====================&gt;........] - ETA: 38s  loss: 0.2134 
[Training] 377/503 [=====================&gt;........] - ETA: 38s  loss: 0.1873 
[Training] 378/503 [=====================&gt;........] - ETA: 37s  loss: 0.2332 
[Training] 379/503 [=====================&gt;........] - ETA: 37s  loss: 0.2833 
[Training] 380/503 [=====================&gt;........] - ETA: 37s  loss: 0.3342 
[Training] 381/503 [=====================&gt;........] - ETA: 36s  loss: 0.3337 
[Training] 382/503 [=====================&gt;........] - ETA: 36s  loss: 0.1709 
[Training] 383/503 [=====================&gt;........] - ETA: 36s  loss: 0.2311 
[Training] 384/503 [=====================&gt;........] - ETA: 36s  loss: 0.2337 
[Training] 385/503 [=====================&gt;........] - ETA: 35s  loss: 0.3002 
[Training] 386/503 [======================&gt;.......] - ETA: 35s  loss: 0.2583 
[Training] 387/503 [======================&gt;.......] - ETA: 35s  loss: 0.1978 
[Training] 388/503 [======================&gt;.......] - ETA: 34s  loss: 0.4349 
[Training] 389/503 [======================&gt;.......] - ETA: 34s  loss: 0.4370 
[Training] 390/503 [======================&gt;.......] - ETA: 34s  loss: 0.2325 
[Training] 391/503 [======================&gt;.......] - ETA: 33s  loss: 0.5521 
[Training] 392/503 [======================&gt;.......] - ETA: 33s  loss: 0.3360 
[Training] 393/503 [======================&gt;.......] - ETA: 33s  loss: 0.1125 
[Training] 394/503 [======================&gt;.......] - ETA: 33s  loss: 0.6321 
[Training] 395/503 [======================&gt;.......] - ETA: 32s  loss: 0.1878 
[Training] 396/503 [======================&gt;.......] - ETA: 32s  loss: 0.2557 
[Training] 397/503 [======================&gt;.......] - ETA: 32s  loss: 0.3239 
[Training] 398/503 [======================&gt;.......] - ETA: 31s  loss: 0.4075 
[Training] 399/503 [======================&gt;.......] - ETA: 31s  loss: 0.3726 
[Training] 400/503 [======================&gt;.......] - ETA: 31s  loss: 0.3869 
[Training] 401/503 [======================&gt;.......] - ETA: 30s  loss: 0.4357 
[Training] 402/503 [======================&gt;.......] - ETA: 30s  loss: 0.4188 
[Training] 403/503 [=======================&gt;......] - ETA: 30s  loss: 0.4039 
[Training] 404/503 [=======================&gt;......] - ETA: 29s  loss: 0.6205 
[Training] 405/503 [=======================&gt;......] - ETA: 29s  loss: 0.3547 
[Training] 406/503 [=======================&gt;......] - ETA: 29s  loss: 0.3117 
[Training] 407/503 [=======================&gt;......] - ETA: 29s  loss: 0.4163 
[Training] 408/503 [=======================&gt;......] - ETA: 28s  loss: 0.3043 
[Training] 409/503 [=======================&gt;......] - ETA: 28s  loss: 0.3007 
[Training] 410/503 [=======================&gt;......] - ETA: 28s  loss: 0.5657 
[Training] 411/503 [=======================&gt;......] - ETA: 27s  loss: 0.3401 
[Training] 412/503 [=======================&gt;......] - ETA: 27s  loss: 0.2990 
[Training] 413/503 [=======================&gt;......] - ETA: 27s  loss: 0.4738 
[Training] 414/503 [=======================&gt;......] - ETA: 26s  loss: 0.2548 
[Training] 415/503 [=======================&gt;......] - ETA: 26s  loss: 0.2461 
[Training] 416/503 [=======================&gt;......] - ETA: 26s  loss: 0.7403 
[Training] 417/503 [=======================&gt;......] - ETA: 26s  loss: 0.4608 
[Training] 418/503 [=======================&gt;......] - ETA: 25s  loss: 0.2552 
[Training] 419/503 [=======================&gt;......] - ETA: 25s  loss: 0.3605 
[Training] 420/503 [========================&gt;.....] - ETA: 25s  loss: 0.2189 
[Training] 421/503 [========================&gt;.....] - ETA: 24s  loss: 0.4858 
[Training] 422/503 [========================&gt;.....] - ETA: 24s  loss: 0.3374 
[Training] 423/503 [========================&gt;.....] - ETA: 24s  loss: 0.3869 
[Training] 424/503 [========================&gt;.....] - ETA: 23s  loss: 0.3571 
[Training] 425/503 [========================&gt;.....] - ETA: 23s  loss: 0.3337 
[Training] 426/503 [========================&gt;.....] - ETA: 23s  loss: 0.3839 
[Training] 427/503 [========================&gt;.....] - ETA: 22s  loss: 0.3100 
[Training] 428/503 [========================&gt;.....] - ETA: 22s  loss: 0.3059 
[Training] 429/503 [========================&gt;.....] - ETA: 22s  loss: 0.2182 
[Training] 430/503 [========================&gt;.....] - ETA: 22s  loss: 0.5940 
[Training] 431/503 [========================&gt;.....] - ETA: 21s  loss: 0.2261 
[Training] 432/503 [========================&gt;.....] - ETA: 21s  loss: 0.3224 
[Training] 433/503 [========================&gt;.....] - ETA: 21s  loss: 0.4268 
[Training] 434/503 [========================&gt;.....] - ETA: 20s  loss: 0.4811 
[Training] 435/503 [========================&gt;.....] - ETA: 20s  loss: 0.2243 
[Training] 436/503 [=========================&gt;....] - ETA: 20s  loss: 0.4794 
[Training] 437/503 [=========================&gt;....] - ETA: 19s  loss: 0.6248 
[Training] 438/503 [=========================&gt;....] - ETA: 19s  loss: 0.3881 
[Training] 439/503 [=========================&gt;....] - ETA: 19s  loss: 0.1685 
[Training] 440/503 [=========================&gt;....] - ETA: 19s  loss: 0.2945 
[Training] 441/503 [=========================&gt;....] - ETA: 18s  loss: 0.4882 
[Training] 442/503 [=========================&gt;....] - ETA: 18s  loss: 0.2636 
[Training] 443/503 [=========================&gt;....] - ETA: 18s  loss: 0.5095 
[Training] 444/503 [=========================&gt;....] - ETA: 17s  loss: 0.4723 
[Training] 445/503 [=========================&gt;....] - ETA: 17s  loss: 0.3805 
[Training] 446/503 [=========================&gt;....] - ETA: 17s  loss: 0.4002 
[Training] 447/503 [=========================&gt;....] - ETA: 16s  loss: 0.2524 
[Training] 448/503 [=========================&gt;....] - ETA: 16s  loss: 0.3395 
[Training] 449/503 [=========================&gt;....] - ETA: 16s  loss: 0.3574 
[Training] 450/503 [=========================&gt;....] - ETA: 16s  loss: 0.5834 
[Training] 451/503 [=========================&gt;....] - ETA: 15s  loss: 0.2179 
[Training] 452/503 [=========================&gt;....] - ETA: 15s  loss: 0.4354 
[Training] 453/503 [==========================&gt;...] - ETA: 15s  loss: 0.3418 
[Training] 454/503 [==========================&gt;...] - ETA: 14s  loss: 0.2017 
[Training] 455/503 [==========================&gt;...] - ETA: 14s  loss: 0.3639 
[Training] 456/503 [==========================&gt;...] - ETA: 14s  loss: 0.5267 
[Training] 457/503 [==========================&gt;...] - ETA: 13s  loss: 0.3991 
[Training] 458/503 [==========================&gt;...] - ETA: 13s  loss: 0.4580 
[Training] 459/503 [==========================&gt;...] - ETA: 13s  loss: 0.2669 
[Training] 460/503 [==========================&gt;...] - ETA: 13s  loss: 0.2135 
[Training] 461/503 [==========================&gt;...] - ETA: 12s  loss: 0.2872 
[Training] 462/503 [==========================&gt;...] - ETA: 12s  loss: 0.3028 
[Training] 463/503 [==========================&gt;...] - ETA: 12s  loss: 0.2106 
[Training] 464/503 [==========================&gt;...] - ETA: 11s  loss: 0.3547 
[Training] 465/503 [==========================&gt;...] - ETA: 11s  loss: 0.2177 
[Training] 466/503 [==========================&gt;...] - ETA: 11s  loss: 0.4880 
[Training] 467/503 [==========================&gt;...] - ETA: 10s  loss: 0.2790 
[Training] 468/503 [==========================&gt;...] - ETA: 10s  loss: 0.9067 
[Training] 469/503 [==========================&gt;...] - ETA: 10s  loss: 0.2304 
[Training] 470/503 [===========================&gt;..] - ETA: 9s  loss: 0.1291 
[Training] 471/503 [===========================&gt;..] - ETA: 9s  loss: 0.2968 
[Training] 472/503 [===========================&gt;..] - ETA: 9s  loss: 0.4774 
[Training] 473/503 [===========================&gt;..] - ETA: 9s  loss: 0.3455 
[Training] 474/503 [===========================&gt;..] - ETA: 8s  loss: 0.4508 
[Training] 475/503 [===========================&gt;..] - ETA: 8s  loss: 0.3423 
[Training] 476/503 [===========================&gt;..] - ETA: 8s  loss: 0.3966 
[Training] 477/503 [===========================&gt;..] - ETA: 7s  loss: 0.2717 
[Training] 478/503 [===========================&gt;..] - ETA: 7s  loss: 0.5050 
[Training] 479/503 [===========================&gt;..] - ETA: 7s  loss: 0.3880 
[Training] 480/503 [===========================&gt;..] - ETA: 6s  loss: 0.3730 
[Training] 481/503 [===========================&gt;..] - ETA: 6s  loss: 0.1127 
[Training] 482/503 [===========================&gt;..] - ETA: 6s  loss: 0.1848 
[Training] 483/503 [===========================&gt;..] - ETA: 6s  loss: 0.6203 
[Training] 484/503 [===========================&gt;..] - ETA: 5s  loss: 0.1989 
[Training] 485/503 [===========================&gt;..] - ETA: 5s  loss: 0.5623 
[Training] 486/503 [===========================&gt;..] - ETA: 5s  loss: 0.3700 
[Training] 487/503 [============================&gt;.] - ETA: 4s  loss: 0.5154 
[Training] 488/503 [============================&gt;.] - ETA: 4s  loss: 0.3640 
[Training] 489/503 [============================&gt;.] - ETA: 4s  loss: 0.3313 
[Training] 490/503 [============================&gt;.] - ETA: 3s  loss: 0.2967 
[Training] 491/503 [============================&gt;.] - ETA: 3s  loss: 0.5450 
[Training] 492/503 [============================&gt;.] - ETA: 3s  loss: 0.3948 
[Training] 493/503 [============================&gt;.] - ETA: 3s  loss: 0.3268 
[Training] 494/503 [============================&gt;.] - ETA: 2s  loss: 0.4753 
[Training] 495/503 [============================&gt;.] - ETA: 2s  loss: 0.4545 
[Training] 496/503 [============================&gt;.] - ETA: 2s  loss: 0.3442 
[Training] 497/503 [============================&gt;.] - ETA: 1s  loss: 0.2226 
[Training] 498/503 [============================&gt;.] - ETA: 1s  loss: 0.1579 
[Training] 499/503 [============================&gt;.] - ETA: 1s  loss: 0.4421 
[Training] 500/503 [============================&gt;.] - ETA: 0s  loss: 0.3777 
[Training] 501/503 [============================&gt;.] - ETA: 0s  loss: 0.3475 
[Training] 502/503 [============================&gt;.] - ETA: 0s  loss: 0.1330 
[Training] 503/503 [==============================] 301.4ms/step  loss: 0.1542 
[Testing] 1/32 [..............................] - ETA: 12s
[Testing] 2/32 [&gt;.............................] - ETA: 12s
[Testing] 3/32 [=&gt;............................] - ETA: 11s
[Testing] 4/32 [==&gt;...........................] - ETA: 10s
[Testing] 5/32 [===&gt;..........................] - ETA: 11s
[Testing] 6/32 [====&gt;.........................] - ETA: 10s
[Testing] 7/32 [=====&gt;........................] - ETA: 10s
[Testing] 8/32 [======&gt;.......................] - ETA: 9s
[Testing] 9/32 [=======&gt;......................] - ETA: 9s
[Testing] 10/32 [========&gt;.....................] - ETA: 8s
[Testing] 11/32 [=========&gt;....................] - ETA: 8s
[Testing] 12/32 [==========&gt;...................] - ETA: 7s
[Testing] 13/32 [===========&gt;..................] - ETA: 7s
[Testing] 14/32 [============&gt;.................] - ETA: 6s
[Testing] 15/32 [=============&gt;................] - ETA: 6s
[Testing] 16/32 [==============&gt;...............] - ETA: 6s
[Testing] 17/32 [==============&gt;...............] - ETA: 5s
[Testing] 18/32 [===============&gt;..............] - ETA: 5s
[Testing] 19/32 [================&gt;.............] - ETA: 4s
[Testing] 20/32 [=================&gt;............] - ETA: 4s
[Testing] 21/32 [==================&gt;...........] - ETA: 4s
[Testing] 22/32 [===================&gt;..........] - ETA: 3s
[Testing] 23/32 [====================&gt;.........] - ETA: 3s
[Testing] 24/32 [=====================&gt;........] - ETA: 2s
[Testing] 25/32 [======================&gt;.......] - ETA: 2s
[Testing] 26/32 [=======================&gt;......] - ETA: 2s
[Testing] 27/32 [========================&gt;.....] - ETA: 1s
[Testing] 28/32 [=========================&gt;....] - ETA: 1s
[Testing] 29/32 [==========================&gt;...] - ETA: 1s
[Testing] 30/32 [===========================&gt;..] - ETA: 0s
[Testing] 31/32 [============================&gt;.] - ETA: 0s
[Testing] 32/32 [==============================] 366.7ms/step
## Epoch: 1 -  loss: 0.5118 - valid_loss: 0.3012 - valid_acc: 0.8665 - valid_f1: 0.8171 
## 
[Training] 1/503 [..............................] - ETA: 2:26  loss: 0.1951 
[Training] 2/503 [..............................] - ETA: 2:34  loss: 0.2170 
[Training] 3/503 [..............................] - ETA: 2:33  loss: 0.2714 
[Training] 4/503 [..............................] - ETA: 2:27  loss: 0.2741 
[Training] 5/503 [..............................] - ETA: 2:29  loss: 0.4071 
[Training] 6/503 [..............................] - ETA: 2:25  loss: 0.3051 
[Training] 7/503 [..............................] - ETA: 2:28  loss: 0.2677 
[Training] 8/503 [..............................] - ETA: 2:30  loss: 0.3460 
[Training] 9/503 [..............................] - ETA: 2:29  loss: 0.6230 
[Training] 10/503 [..............................] - ETA: 2:28  loss: 0.4192 
[Training] 11/503 [..............................] - ETA: 2:28  loss: 0.3246 
[Training] 12/503 [..............................] - ETA: 2:28  loss: 0.4044 
[Training] 13/503 [..............................] - ETA: 2:30  loss: 0.5761 
[Training] 14/503 [..............................] - ETA: 2:30  loss: 0.6051 
[Training] 15/503 [..............................] - ETA: 2:29  loss: 0.2462 
[Training] 16/503 [..............................] - ETA: 2:28  loss: 0.1383 
[Training] 17/503 [&gt;.............................] - ETA: 2:27  loss: 0.5963 
[Training] 18/503 [&gt;.............................] - ETA: 2:26  loss: 0.2971 
[Training] 19/503 [&gt;.............................] - ETA: 2:26  loss: 0.3187 
[Training] 20/503 [&gt;.............................] - ETA: 2:24  loss: 0.3882 
[Training] 21/503 [&gt;.............................] - ETA: 2:25  loss: 0.3972 
[Training] 22/503 [&gt;.............................] - ETA: 2:25  loss: 0.2165 
[Training] 23/503 [&gt;.............................] - ETA: 2:25  loss: 0.2614 
[Training] 24/503 [&gt;.............................] - ETA: 2:24  loss: 0.4163 
[Training] 25/503 [&gt;.............................] - ETA: 2:24  loss: 0.3980 
[Training] 26/503 [&gt;.............................] - ETA: 2:23  loss: 0.4561 
[Training] 27/503 [&gt;.............................] - ETA: 2:23  loss: 0.1374 
[Training] 28/503 [&gt;.............................] - ETA: 2:23  loss: 0.2617 
[Training] 29/503 [&gt;.............................] - ETA: 2:22  loss: 0.3577 
[Training] 30/503 [&gt;.............................] - ETA: 2:22  loss: 0.2910 
[Training] 31/503 [&gt;.............................] - ETA: 2:22  loss: 0.3836 
[Training] 32/503 [&gt;.............................] - ETA: 2:22  loss: 0.2050 
[Training] 33/503 [&gt;.............................] - ETA: 2:21  loss: 0.4326 
[Training] 34/503 [=&gt;............................] - ETA: 2:21  loss: 0.3506 
[Training] 35/503 [=&gt;............................] - ETA: 2:21  loss: 0.4010 
[Training] 36/503 [=&gt;............................] - ETA: 2:21  loss: 0.2014 
[Training] 37/503 [=&gt;............................] - ETA: 2:20  loss: 0.3893 
[Training] 38/503 [=&gt;............................] - ETA: 2:20  loss: 0.3307 
[Training] 39/503 [=&gt;............................] - ETA: 2:19  loss: 0.2347 
[Training] 40/503 [=&gt;............................] - ETA: 2:18  loss: 0.2781 
[Training] 41/503 [=&gt;............................] - ETA: 2:19  loss: 0.3916 
[Training] 42/503 [=&gt;............................] - ETA: 2:18  loss: 0.2668 
[Training] 43/503 [=&gt;............................] - ETA: 2:17  loss: 0.2183 
[Training] 44/503 [=&gt;............................] - ETA: 2:17  loss: 0.3587 
[Training] 45/503 [=&gt;............................] - ETA: 2:17  loss: 0.4307 
[Training] 46/503 [=&gt;............................] - ETA: 2:17  loss: 0.2012 
[Training] 47/503 [=&gt;............................] - ETA: 2:17  loss: 0.3146 
[Training] 48/503 [=&gt;............................] - ETA: 2:15  loss: 0.0870 
[Training] 49/503 [=&gt;............................] - ETA: 2:14  loss: 0.3570 
[Training] 50/503 [=&gt;............................] - ETA: 2:14  loss: 0.4019 
[Training] 51/503 [==&gt;...........................] - ETA: 2:13  loss: 0.0577 
[Training] 52/503 [==&gt;...........................] - ETA: 2:12  loss: 0.6763 
[Training] 53/503 [==&gt;...........................] - ETA: 2:12  loss: 0.2549 
[Training] 54/503 [==&gt;...........................] - ETA: 2:12  loss: 0.5519 
[Training] 55/503 [==&gt;...........................] - ETA: 2:12  loss: 0.2522 
[Training] 56/503 [==&gt;...........................] - ETA: 2:12  loss: 0.1856 
[Training] 57/503 [==&gt;...........................] - ETA: 2:11  loss: 0.3334 
[Training] 58/503 [==&gt;...........................] - ETA: 2:11  loss: 0.5445 
[Training] 59/503 [==&gt;...........................] - ETA: 2:11  loss: 0.1912 
[Training] 60/503 [==&gt;...........................] - ETA: 2:10  loss: 0.2612 
[Training] 61/503 [==&gt;...........................] - ETA: 2:10  loss: 0.2241 
[Training] 62/503 [==&gt;...........................] - ETA: 2:09  loss: 0.2589 
[Training] 63/503 [==&gt;...........................] - ETA: 2:09  loss: 0.2147 
[Training] 64/503 [==&gt;...........................] - ETA: 2:08  loss: 0.2823 
[Training] 65/503 [==&gt;...........................] - ETA: 2:08  loss: 0.2015 
[Training] 66/503 [==&gt;...........................] - ETA: 2:08  loss: 0.1590 
[Training] 67/503 [==&gt;...........................] - ETA: 2:07  loss: 0.2939 
[Training] 68/503 [===&gt;..........................] - ETA: 2:07  loss: 0.1570 
[Training] 69/503 [===&gt;..........................] - ETA: 2:06  loss: 0.4287 
[Training] 70/503 [===&gt;..........................] - ETA: 2:06  loss: 0.4594 
[Training] 71/503 [===&gt;..........................] - ETA: 2:06  loss: 0.4694 
[Training] 72/503 [===&gt;..........................] - ETA: 2:06  loss: 0.0549 
[Training] 73/503 [===&gt;..........................] - ETA: 2:06  loss: 0.0604 
[Training] 74/503 [===&gt;..........................] - ETA: 2:05  loss: 0.1672 
[Training] 75/503 [===&gt;..........................] - ETA: 2:05  loss: 0.2614 
[Training] 76/503 [===&gt;..........................] - ETA: 2:04  loss: 0.2976 
[Training] 77/503 [===&gt;..........................] - ETA: 2:04  loss: 0.3695 
[Training] 78/503 [===&gt;..........................] - ETA: 2:04  loss: 0.2363 
[Training] 79/503 [===&gt;..........................] - ETA: 2:04  loss: 0.1910 
[Training] 80/503 [===&gt;..........................] - ETA: 2:03  loss: 0.1979 
[Training] 81/503 [===&gt;..........................] - ETA: 2:03  loss: 0.1565 
[Training] 82/503 [===&gt;..........................] - ETA: 2:03  loss: 0.4492 
[Training] 83/503 [===&gt;..........................] - ETA: 2:02  loss: 0.3690 
[Training] 84/503 [====&gt;.........................] - ETA: 2:02  loss: 0.1733 
[Training] 85/503 [====&gt;.........................] - ETA: 2:01  loss: 0.4823 
[Training] 86/503 [====&gt;.........................] - ETA: 2:01  loss: 0.0634 
[Training] 87/503 [====&gt;.........................] - ETA: 2:00  loss: 0.6336 
[Training] 88/503 [====&gt;.........................] - ETA: 2:00  loss: 0.6383 
[Training] 89/503 [====&gt;.........................] - ETA: 2:00  loss: 0.1367 
[Training] 90/503 [====&gt;.........................] - ETA: 1:59  loss: 0.5074 
[Training] 91/503 [====&gt;.........................] - ETA: 1:59  loss: 0.4587 
[Training] 92/503 [====&gt;.........................] - ETA: 1:59  loss: 0.2919 
[Training] 93/503 [====&gt;.........................] - ETA: 1:59  loss: 0.4363 
[Training] 94/503 [====&gt;.........................] - ETA: 1:58  loss: 0.3618 
[Training] 95/503 [====&gt;.........................] - ETA: 1:58  loss: 0.1126 
[Training] 96/503 [====&gt;.........................] - ETA: 1:57  loss: 0.3545 
[Training] 97/503 [====&gt;.........................] - ETA: 1:57  loss: 0.1998 
[Training] 98/503 [====&gt;.........................] - ETA: 1:57  loss: 0.2526 
[Training] 99/503 [====&gt;.........................] - ETA: 1:56  loss: 0.4311 
[Training] 100/503 [====&gt;.........................] - ETA: 1:56  loss: 0.3727 
[Training] 101/503 [=====&gt;........................] - ETA: 1:55  loss: 0.3810 
[Training] 102/503 [=====&gt;........................] - ETA: 1:55  loss: 0.2541 
[Training] 103/503 [=====&gt;........................] - ETA: 1:55  loss: 0.2478 
[Training] 104/503 [=====&gt;........................] - ETA: 1:54  loss: 0.1077 
[Training] 105/503 [=====&gt;........................] - ETA: 1:54  loss: 0.3223 
[Training] 106/503 [=====&gt;........................] - ETA: 1:54  loss: 0.0875 
[Training] 107/503 [=====&gt;........................] - ETA: 1:53  loss: 0.3591 
[Training] 108/503 [=====&gt;........................] - ETA: 1:53  loss: 0.3296 
[Training] 109/503 [=====&gt;........................] - ETA: 1:53  loss: 0.2447 
[Training] 110/503 [=====&gt;........................] - ETA: 1:52  loss: 0.2553 
[Training] 111/503 [=====&gt;........................] - ETA: 1:52  loss: 0.2958 
[Training] 112/503 [=====&gt;........................] - ETA: 1:52  loss: 0.1775 
[Training] 113/503 [=====&gt;........................] - ETA: 1:51  loss: 0.1904 
[Training] 114/503 [=====&gt;........................] - ETA: 1:51  loss: 0.2678 
[Training] 115/503 [=====&gt;........................] - ETA: 1:50  loss: 0.1725 
[Training] 116/503 [=====&gt;........................] - ETA: 1:50  loss: 0.2280 
[Training] 117/503 [=====&gt;........................] - ETA: 1:50  loss: 0.2185 
[Training] 118/503 [======&gt;.......................] - ETA: 1:49  loss: 0.3173 
[Training] 119/503 [======&gt;.......................] - ETA: 1:49  loss: 0.1160 
[Training] 120/503 [======&gt;.......................] - ETA: 1:49  loss: 0.2175 
[Training] 121/503 [======&gt;.......................] - ETA: 1:49  loss: 0.3558 
[Training] 122/503 [======&gt;.......................] - ETA: 1:49  loss: 0.3004 
[Training] 123/503 [======&gt;.......................] - ETA: 1:48  loss: 0.1088 
[Training] 124/503 [======&gt;.......................] - ETA: 1:48  loss: 0.3092 
[Training] 125/503 [======&gt;.......................] - ETA: 1:48  loss: 0.1145 
[Training] 126/503 [======&gt;.......................] - ETA: 1:48  loss: 0.1124 
[Training] 127/503 [======&gt;.......................] - ETA: 1:48  loss: 0.4966 
[Training] 128/503 [======&gt;.......................] - ETA: 1:47  loss: 0.4034 
[Training] 129/503 [======&gt;.......................] - ETA: 1:47  loss: 0.2011 
[Training] 130/503 [======&gt;.......................] - ETA: 1:47  loss: 0.2005 
[Training] 131/503 [======&gt;.......................] - ETA: 1:46  loss: 0.4698 
[Training] 132/503 [======&gt;.......................] - ETA: 1:46  loss: 0.2452 
[Training] 133/503 [======&gt;.......................] - ETA: 1:46  loss: 0.2912 
[Training] 134/503 [======&gt;.......................] - ETA: 1:46  loss: 0.1414 
[Training] 135/503 [=======&gt;......................] - ETA: 1:45  loss: 0.0601 
[Training] 136/503 [=======&gt;......................] - ETA: 1:45  loss: 0.4203 
[Training] 137/503 [=======&gt;......................] - ETA: 1:45  loss: 0.1457 
[Training] 138/503 [=======&gt;......................] - ETA: 1:44  loss: 0.7444 
[Training] 139/503 [=======&gt;......................] - ETA: 1:44  loss: 0.2577 
[Training] 140/503 [=======&gt;......................] - ETA: 1:44  loss: 0.5598 
[Training] 141/503 [=======&gt;......................] - ETA: 1:44  loss: 0.4329 
[Training] 142/503 [=======&gt;......................] - ETA: 1:43  loss: 0.1841 
[Training] 143/503 [=======&gt;......................] - ETA: 1:43  loss: 0.2221 
[Training] 144/503 [=======&gt;......................] - ETA: 1:42  loss: 0.4474 
[Training] 145/503 [=======&gt;......................] - ETA: 1:42  loss: 0.1905 
[Training] 146/503 [=======&gt;......................] - ETA: 1:42  loss: 0.1916 
[Training] 147/503 [=======&gt;......................] - ETA: 1:41  loss: 0.4217 
[Training] 148/503 [=======&gt;......................] - ETA: 1:41  loss: 0.3477 
[Training] 149/503 [=======&gt;......................] - ETA: 1:41  loss: 0.4383 
[Training] 150/503 [=======&gt;......................] - ETA: 1:40  loss: 0.3679 
[Training] 151/503 [========&gt;.....................] - ETA: 1:40  loss: 0.2739 
[Training] 152/503 [========&gt;.....................] - ETA: 1:40  loss: 0.2611 
[Training] 153/503 [========&gt;.....................] - ETA: 1:40  loss: 0.3475 
[Training] 154/503 [========&gt;.....................] - ETA: 1:40  loss: 0.1250 
[Training] 155/503 [========&gt;.....................] - ETA: 1:39  loss: 0.2012 
[Training] 156/503 [========&gt;.....................] - ETA: 1:39  loss: 0.4015 
[Training] 157/503 [========&gt;.....................] - ETA: 1:39  loss: 0.1613 
[Training] 158/503 [========&gt;.....................] - ETA: 1:38  loss: 0.3339 
[Training] 159/503 [========&gt;.....................] - ETA: 1:38  loss: 0.7037 
[Training] 160/503 [========&gt;.....................] - ETA: 1:38  loss: 0.1009 
[Training] 161/503 [========&gt;.....................] - ETA: 1:37  loss: 0.2700 
[Training] 162/503 [========&gt;.....................] - ETA: 1:37  loss: 0.1248 
[Training] 163/503 [========&gt;.....................] - ETA: 1:37  loss: 0.4045 
[Training] 164/503 [========&gt;.....................] - ETA: 1:36  loss: 0.5246 
[Training] 165/503 [========&gt;.....................] - ETA: 1:36  loss: 0.2828 
[Training] 166/503 [========&gt;.....................] - ETA: 1:36  loss: 0.4815 
[Training] 167/503 [========&gt;.....................] - ETA: 1:36  loss: 0.2665 
[Training] 168/503 [=========&gt;....................] - ETA: 1:35  loss: 0.2098 
[Training] 169/503 [=========&gt;....................] - ETA: 1:35  loss: 0.1649 
[Training] 170/503 [=========&gt;....................] - ETA: 1:35  loss: 0.1319 
[Training] 171/503 [=========&gt;....................] - ETA: 1:34  loss: 0.1612 
[Training] 172/503 [=========&gt;....................] - ETA: 1:34  loss: 0.2718 
[Training] 173/503 [=========&gt;....................] - ETA: 1:34  loss: 0.2888 
[Training] 174/503 [=========&gt;....................] - ETA: 1:34  loss: 0.7026 
[Training] 175/503 [=========&gt;....................] - ETA: 1:34  loss: 0.4557 
[Training] 176/503 [=========&gt;....................] - ETA: 1:34  loss: 0.1448 
[Training] 177/503 [=========&gt;....................] - ETA: 1:33  loss: 0.2439 
[Training] 178/503 [=========&gt;....................] - ETA: 1:33  loss: 0.1484 
[Training] 179/503 [=========&gt;....................] - ETA: 1:33  loss: 0.1575 
[Training] 180/503 [=========&gt;....................] - ETA: 1:32  loss: 0.2950 
[Training] 181/503 [=========&gt;....................] - ETA: 1:32  loss: 0.1189 
[Training] 182/503 [=========&gt;....................] - ETA: 1:32  loss: 0.3211 
[Training] 183/503 [=========&gt;....................] - ETA: 1:31  loss: 0.4907 
[Training] 184/503 [=========&gt;....................] - ETA: 1:31  loss: 0.3985 
[Training] 185/503 [==========&gt;...................] - ETA: 1:31  loss: 0.2750 
[Training] 186/503 [==========&gt;...................] - ETA: 1:30  loss: 0.3711 
[Training] 187/503 [==========&gt;...................] - ETA: 1:30  loss: 0.1562 
[Training] 188/503 [==========&gt;...................] - ETA: 1:30  loss: 0.1852 
[Training] 189/503 [==========&gt;...................] - ETA: 1:30  loss: 0.1241 
[Training] 190/503 [==========&gt;...................] - ETA: 1:29  loss: 0.2367 
[Training] 191/503 [==========&gt;...................] - ETA: 1:29  loss: 0.3353 
[Training] 192/503 [==========&gt;...................] - ETA: 1:29  loss: 0.2585 
[Training] 193/503 [==========&gt;...................] - ETA: 1:28  loss: 0.1561 
[Training] 194/503 [==========&gt;...................] - ETA: 1:28  loss: 0.2094 
[Training] 195/503 [==========&gt;...................] - ETA: 1:28  loss: 0.1750 
[Training] 196/503 [==========&gt;...................] - ETA: 1:27  loss: 0.1440 
[Training] 197/503 [==========&gt;...................] - ETA: 1:27  loss: 0.4230 
[Training] 198/503 [==========&gt;...................] - ETA: 1:27  loss: 0.2104 
[Training] 199/503 [==========&gt;...................] - ETA: 1:26  loss: 0.0902 
[Training] 200/503 [==========&gt;...................] - ETA: 1:26  loss: 0.4577 
[Training] 201/503 [==========&gt;...................] - ETA: 1:26  loss: 0.2551 
[Training] 202/503 [===========&gt;..................] - ETA: 1:25  loss: 0.1102 
[Training] 203/503 [===========&gt;..................] - ETA: 1:25  loss: 0.0682 
[Training] 204/503 [===========&gt;..................] - ETA: 1:25  loss: 0.0951 
[Training] 205/503 [===========&gt;..................] - ETA: 1:24  loss: 0.2826 
[Training] 206/503 [===========&gt;..................] - ETA: 1:24  loss: 0.2115 
[Training] 207/503 [===========&gt;..................] - ETA: 1:24  loss: 0.1803 
[Training] 208/503 [===========&gt;..................] - ETA: 1:24  loss: 0.7363 
[Training] 209/503 [===========&gt;..................] - ETA: 1:23  loss: 0.0792 
[Training] 210/503 [===========&gt;..................] - ETA: 1:23  loss: 0.1651 
[Training] 211/503 [===========&gt;..................] - ETA: 1:22  loss: 0.1056 
[Training] 212/503 [===========&gt;..................] - ETA: 1:22  loss: 0.4699 
[Training] 213/503 [===========&gt;..................] - ETA: 1:22  loss: 0.3927 
[Training] 214/503 [===========&gt;..................] - ETA: 1:22  loss: 0.4336 
[Training] 215/503 [===========&gt;..................] - ETA: 1:21  loss: 0.2739 
[Training] 216/503 [===========&gt;..................] - ETA: 1:21  loss: 0.5525 
[Training] 217/503 [===========&gt;..................] - ETA: 1:21  loss: 0.3379 
[Training] 218/503 [============&gt;.................] - ETA: 1:21  loss: 0.4104 
[Training] 219/503 [============&gt;.................] - ETA: 1:21  loss: 0.5468 
[Training] 220/503 [============&gt;.................] - ETA: 1:20  loss: 0.1743 
[Training] 221/503 [============&gt;.................] - ETA: 1:20  loss: 0.4270 
[Training] 222/503 [============&gt;.................] - ETA: 1:20  loss: 0.2920 
[Training] 223/503 [============&gt;.................] - ETA: 1:19  loss: 0.2124 
[Training] 224/503 [============&gt;.................] - ETA: 1:19  loss: 0.3454 
[Training] 225/503 [============&gt;.................] - ETA: 1:19  loss: 0.3500 
[Training] 226/503 [============&gt;.................] - ETA: 1:18  loss: 0.3616 
[Training] 227/503 [============&gt;.................] - ETA: 1:18  loss: 0.3376 
[Training] 228/503 [============&gt;.................] - ETA: 1:18  loss: 0.2184 
[Training] 229/503 [============&gt;.................] - ETA: 1:18  loss: 0.1865 
[Training] 230/503 [============&gt;.................] - ETA: 1:17  loss: 0.4865 
[Training] 231/503 [============&gt;.................] - ETA: 1:17  loss: 0.4404 
[Training] 232/503 [============&gt;.................] - ETA: 1:17  loss: 0.1831 
[Training] 233/503 [============&gt;.................] - ETA: 1:17  loss: 0.1015 
[Training] 234/503 [============&gt;.................] - ETA: 1:16  loss: 0.2596 
[Training] 235/503 [=============&gt;................] - ETA: 1:16  loss: 0.2121 
[Training] 236/503 [=============&gt;................] - ETA: 1:16  loss: 0.1788 
[Training] 237/503 [=============&gt;................] - ETA: 1:16  loss: 0.3505 
[Training] 238/503 [=============&gt;................] - ETA: 1:15  loss: 0.2145 
[Training] 239/503 [=============&gt;................] - ETA: 1:15  loss: 0.0773 
[Training] 240/503 [=============&gt;................] - ETA: 1:15  loss: 0.1241 
[Training] 241/503 [=============&gt;................] - ETA: 1:14  loss: 0.3127 
[Training] 242/503 [=============&gt;................] - ETA: 1:14  loss: 0.0848 
[Training] 243/503 [=============&gt;................] - ETA: 1:14  loss: 0.1032 
[Training] 244/503 [=============&gt;................] - ETA: 1:14  loss: 0.1365 
[Training] 245/503 [=============&gt;................] - ETA: 1:13  loss: 0.5411 
[Training] 246/503 [=============&gt;................] - ETA: 1:13  loss: 0.2410 
[Training] 247/503 [=============&gt;................] - ETA: 1:13  loss: 0.1375 
[Training] 248/503 [=============&gt;................] - ETA: 1:12  loss: 0.4172 
[Training] 249/503 [=============&gt;................] - ETA: 1:12  loss: 0.0418 
[Training] 250/503 [=============&gt;................] - ETA: 1:12  loss: 0.1032 
[Training] 251/503 [=============&gt;................] - ETA: 1:12  loss: 0.7764 
[Training] 252/503 [==============&gt;...............] - ETA: 1:11  loss: 0.1550 
[Training] 253/503 [==============&gt;...............] - ETA: 1:11  loss: 0.0500 
[Training] 254/503 [==============&gt;...............] - ETA: 1:11  loss: 0.3112 
[Training] 255/503 [==============&gt;...............] - ETA: 1:10  loss: 0.1908 
[Training] 256/503 [==============&gt;...............] - ETA: 1:10  loss: 0.1843 
[Training] 257/503 [==============&gt;...............] - ETA: 1:10  loss: 0.5077 
[Training] 258/503 [==============&gt;...............] - ETA: 1:09  loss: 0.0833 
[Training] 259/503 [==============&gt;...............] - ETA: 1:09  loss: 0.2622 
[Training] 260/503 [==============&gt;...............] - ETA: 1:09  loss: 0.3318 
[Training] 261/503 [==============&gt;...............] - ETA: 1:09  loss: 0.3741 
[Training] 262/503 [==============&gt;...............] - ETA: 1:08  loss: 0.0589 
[Training] 263/503 [==============&gt;...............] - ETA: 1:08  loss: 0.2955 
[Training] 264/503 [==============&gt;...............] - ETA: 1:08  loss: 0.5371 
[Training] 265/503 [==============&gt;...............] - ETA: 1:07  loss: 0.3462 
[Training] 266/503 [==============&gt;...............] - ETA: 1:07  loss: 0.2044 
[Training] 267/503 [==============&gt;...............] - ETA: 1:07  loss: 0.1931 
[Training] 268/503 [==============&gt;...............] - ETA: 1:06  loss: 0.3292 
[Training] 269/503 [===============&gt;..............] - ETA: 1:06  loss: 0.1584 
[Training] 270/503 [===============&gt;..............] - ETA: 1:06  loss: 0.1952 
[Training] 271/503 [===============&gt;..............] - ETA: 1:06  loss: 0.1811 
[Training] 272/503 [===============&gt;..............] - ETA: 1:05  loss: 0.2945 
[Training] 273/503 [===============&gt;..............] - ETA: 1:05  loss: 0.0450 
[Training] 274/503 [===============&gt;..............] - ETA: 1:05  loss: 0.2132 
[Training] 275/503 [===============&gt;..............] - ETA: 1:04  loss: 0.2395 
[Training] 276/503 [===============&gt;..............] - ETA: 1:04  loss: 0.3034 
[Training] 277/503 [===============&gt;..............] - ETA: 1:04  loss: 0.3846 
[Training] 278/503 [===============&gt;..............] - ETA: 1:04  loss: 0.3161 
[Training] 279/503 [===============&gt;..............] - ETA: 1:03  loss: 0.1319 
[Training] 280/503 [===============&gt;..............] - ETA: 1:03  loss: 0.3165 
[Training] 281/503 [===============&gt;..............] - ETA: 1:03  loss: 0.6382 
[Training] 282/503 [===============&gt;..............] - ETA: 1:02  loss: 0.1978 
[Training] 283/503 [===============&gt;..............] - ETA: 1:02  loss: 0.4042 
[Training] 284/503 [===============&gt;..............] - ETA: 1:02  loss: 0.2574 
[Training] 285/503 [===============&gt;..............] - ETA: 1:02  loss: 0.2279 
[Training] 286/503 [================&gt;.............] - ETA: 1:01  loss: 0.0952 
[Training] 287/503 [================&gt;.............] - ETA: 1:01  loss: 0.1028 
[Training] 288/503 [================&gt;.............] - ETA: 1:01  loss: 0.2003 
[Training] 289/503 [================&gt;.............] - ETA: 1:00  loss: 0.3214 
[Training] 290/503 [================&gt;.............] - ETA: 1:00  loss: 0.3817 
[Training] 291/503 [================&gt;.............] - ETA: 1:00  loss: 0.4267 
[Training] 292/503 [================&gt;.............] - ETA: 59s  loss: 0.2149 
[Training] 293/503 [================&gt;.............] - ETA: 59s  loss: 0.4989 
[Training] 294/503 [================&gt;.............] - ETA: 59s  loss: 0.1470 
[Training] 295/503 [================&gt;.............] - ETA: 59s  loss: 0.2771 
[Training] 296/503 [================&gt;.............] - ETA: 58s  loss: 0.3485 
[Training] 297/503 [================&gt;.............] - ETA: 58s  loss: 0.3433 
[Training] 298/503 [================&gt;.............] - ETA: 58s  loss: 0.1302 
[Training] 299/503 [================&gt;.............] - ETA: 57s  loss: 0.2670 
[Training] 300/503 [================&gt;.............] - ETA: 57s  loss: 0.1763 
[Training] 301/503 [================&gt;.............] - ETA: 57s  loss: 0.3830 
[Training] 302/503 [=================&gt;............] - ETA: 57s  loss: 0.0959 
[Training] 303/503 [=================&gt;............] - ETA: 56s  loss: 0.1041 
[Training] 304/503 [=================&gt;............] - ETA: 56s  loss: 0.1112 
[Training] 305/503 [=================&gt;............] - ETA: 56s  loss: 0.4866 
[Training] 306/503 [=================&gt;............] - ETA: 55s  loss: 0.1861 
[Training] 307/503 [=================&gt;............] - ETA: 55s  loss: 0.2331 
[Training] 308/503 [=================&gt;............] - ETA: 55s  loss: 0.1617 
[Training] 309/503 [=================&gt;............] - ETA: 55s  loss: 0.1484 
[Training] 310/503 [=================&gt;............] - ETA: 54s  loss: 0.0769 
[Training] 311/503 [=================&gt;............] - ETA: 54s  loss: 0.1427 
[Training] 312/503 [=================&gt;............] - ETA: 54s  loss: 0.0761 
[Training] 313/503 [=================&gt;............] - ETA: 53s  loss: 0.0976 
[Training] 314/503 [=================&gt;............] - ETA: 53s  loss: 0.7223 
[Training] 315/503 [=================&gt;............] - ETA: 53s  loss: 0.2053 
[Training] 316/503 [=================&gt;............] - ETA: 53s  loss: 0.1218 
[Training] 317/503 [=================&gt;............] - ETA: 52s  loss: 0.2756 
[Training] 318/503 [=================&gt;............] - ETA: 52s  loss: 0.0815 
[Training] 319/503 [==================&gt;...........] - ETA: 52s  loss: 0.0607 
[Training] 320/503 [==================&gt;...........] - ETA: 51s  loss: 0.4208 
[Training] 321/503 [==================&gt;...........] - ETA: 51s  loss: 0.2621 
[Training] 322/503 [==================&gt;...........] - ETA: 51s  loss: 0.3286 
[Training] 323/503 [==================&gt;...........] - ETA: 51s  loss: 0.6231 
[Training] 324/503 [==================&gt;...........] - ETA: 50s  loss: 0.1602 
[Training] 325/503 [==================&gt;...........] - ETA: 50s  loss: 0.1702 
[Training] 326/503 [==================&gt;...........] - ETA: 50s  loss: 0.3011 
[Training] 327/503 [==================&gt;...........] - ETA: 49s  loss: 0.2543 
[Training] 328/503 [==================&gt;...........] - ETA: 49s  loss: 0.1819 
[Training] 329/503 [==================&gt;...........] - ETA: 49s  loss: 0.3605 
[Training] 330/503 [==================&gt;...........] - ETA: 49s  loss: 0.2561 
[Training] 331/503 [==================&gt;...........] - ETA: 48s  loss: 0.2671 
[Training] 332/503 [==================&gt;...........] - ETA: 48s  loss: 0.2317 
[Training] 333/503 [==================&gt;...........] - ETA: 48s  loss: 0.1830 
[Training] 334/503 [==================&gt;...........] - ETA: 48s  loss: 0.1955 
[Training] 335/503 [==================&gt;...........] - ETA: 47s  loss: 0.2999 
[Training] 336/503 [===================&gt;..........] - ETA: 47s  loss: 0.3088 
[Training] 337/503 [===================&gt;..........] - ETA: 47s  loss: 0.3665 
[Training] 338/503 [===================&gt;..........] - ETA: 46s  loss: 0.2795 
[Training] 339/503 [===================&gt;..........] - ETA: 46s  loss: 0.4097 
[Training] 340/503 [===================&gt;..........] - ETA: 46s  loss: 0.6026 
[Training] 341/503 [===================&gt;..........] - ETA: 46s  loss: 0.2524 
[Training] 342/503 [===================&gt;..........] - ETA: 45s  loss: 0.2899 
[Training] 343/503 [===================&gt;..........] - ETA: 45s  loss: 0.2253 
[Training] 344/503 [===================&gt;..........] - ETA: 45s  loss: 0.1364 
[Training] 345/503 [===================&gt;..........] - ETA: 45s  loss: 0.1483 
[Training] 346/503 [===================&gt;..........] - ETA: 44s  loss: 0.0962 
[Training] 347/503 [===================&gt;..........] - ETA: 44s  loss: 0.4507 
[Training] 348/503 [===================&gt;..........] - ETA: 44s  loss: 0.2456 
[Training] 349/503 [===================&gt;..........] - ETA: 43s  loss: 0.1874 
[Training] 350/503 [===================&gt;..........] - ETA: 43s  loss: 0.2811 
[Training] 351/503 [===================&gt;..........] - ETA: 43s  loss: 0.2093 
[Training] 352/503 [===================&gt;..........] - ETA: 43s  loss: 0.3233 
[Training] 353/503 [====================&gt;.........] - ETA: 42s  loss: 0.2387 
[Training] 354/503 [====================&gt;.........] - ETA: 42s  loss: 0.2029 
[Training] 355/503 [====================&gt;.........] - ETA: 42s  loss: 0.4783 
[Training] 356/503 [====================&gt;.........] - ETA: 41s  loss: 0.4580 
[Training] 357/503 [====================&gt;.........] - ETA: 41s  loss: 0.6203 
[Training] 358/503 [====================&gt;.........] - ETA: 41s  loss: 0.0540 
[Training] 359/503 [====================&gt;.........] - ETA: 41s  loss: 0.1348 
[Training] 360/503 [====================&gt;.........] - ETA: 40s  loss: 0.2916 
[Training] 361/503 [====================&gt;.........] - ETA: 40s  loss: 0.1695 
[Training] 362/503 [====================&gt;.........] - ETA: 40s  loss: 0.3154 
[Training] 363/503 [====================&gt;.........] - ETA: 39s  loss: 0.4321 
[Training] 364/503 [====================&gt;.........] - ETA: 39s  loss: 0.2686 
[Training] 365/503 [====================&gt;.........] - ETA: 39s  loss: 0.2298 
[Training] 366/503 [====================&gt;.........] - ETA: 39s  loss: 0.2920 
[Training] 367/503 [====================&gt;.........] - ETA: 38s  loss: 0.0570 
[Training] 368/503 [====================&gt;.........] - ETA: 38s  loss: 0.6283 
[Training] 369/503 [=====================&gt;........] - ETA: 38s  loss: 0.4642 
[Training] 370/503 [=====================&gt;........] - ETA: 37s  loss: 0.2809 
[Training] 371/503 [=====================&gt;........] - ETA: 37s  loss: 0.1448 
[Training] 372/503 [=====================&gt;........] - ETA: 37s  loss: 0.1897 
[Training] 373/503 [=====================&gt;........] - ETA: 37s  loss: 0.2574 
[Training] 374/503 [=====================&gt;........] - ETA: 36s  loss: 0.2735 
[Training] 375/503 [=====================&gt;........] - ETA: 36s  loss: 0.1610 
[Training] 376/503 [=====================&gt;........] - ETA: 36s  loss: 0.2337 
[Training] 377/503 [=====================&gt;........] - ETA: 35s  loss: 0.3497 
[Training] 378/503 [=====================&gt;........] - ETA: 35s  loss: 0.1942 
[Training] 379/503 [=====================&gt;........] - ETA: 35s  loss: 0.0664 
[Training] 380/503 [=====================&gt;........] - ETA: 35s  loss: 0.1606 
[Training] 381/503 [=====================&gt;........] - ETA: 34s  loss: 0.1749 
[Training] 382/503 [=====================&gt;........] - ETA: 34s  loss: 0.4521 
[Training] 383/503 [=====================&gt;........] - ETA: 34s  loss: 0.2754 
[Training] 384/503 [=====================&gt;........] - ETA: 33s  loss: 0.0868 
[Training] 385/503 [=====================&gt;........] - ETA: 33s  loss: 0.2831 
[Training] 386/503 [======================&gt;.......] - ETA: 33s  loss: 0.0721 
[Training] 387/503 [======================&gt;.......] - ETA: 33s  loss: 0.2875 
[Training] 388/503 [======================&gt;.......] - ETA: 32s  loss: 0.5229 
[Training] 389/503 [======================&gt;.......] - ETA: 32s  loss: 0.1248 
[Training] 390/503 [======================&gt;.......] - ETA: 32s  loss: 0.1401 
[Training] 391/503 [======================&gt;.......] - ETA: 31s  loss: 0.1076 
[Training] 392/503 [======================&gt;.......] - ETA: 31s  loss: 0.1661 
[Training] 393/503 [======================&gt;.......] - ETA: 31s  loss: 0.4297 
[Training] 394/503 [======================&gt;.......] - ETA: 31s  loss: 0.0488 
[Training] 395/503 [======================&gt;.......] - ETA: 30s  loss: 0.1466 
[Training] 396/503 [======================&gt;.......] - ETA: 30s  loss: 0.2935 
[Training] 397/503 [======================&gt;.......] - ETA: 30s  loss: 0.2951 
[Training] 398/503 [======================&gt;.......] - ETA: 29s  loss: 0.1106 
[Training] 399/503 [======================&gt;.......] - ETA: 29s  loss: 0.0735 
[Training] 400/503 [======================&gt;.......] - ETA: 29s  loss: 0.0951 
[Training] 401/503 [======================&gt;.......] - ETA: 29s  loss: 0.0792 
[Training] 402/503 [======================&gt;.......] - ETA: 28s  loss: 0.1687 
[Training] 403/503 [=======================&gt;......] - ETA: 28s  loss: 0.1331 
[Training] 404/503 [=======================&gt;......] - ETA: 28s  loss: 0.3825 
[Training] 405/503 [=======================&gt;......] - ETA: 28s  loss: 0.2273 
[Training] 406/503 [=======================&gt;......] - ETA: 27s  loss: 0.3003 
[Training] 407/503 [=======================&gt;......] - ETA: 27s  loss: 0.9813 
[Training] 408/503 [=======================&gt;......] - ETA: 27s  loss: 0.1286 
[Training] 409/503 [=======================&gt;......] - ETA: 26s  loss: 0.0543 
[Training] 410/503 [=======================&gt;......] - ETA: 26s  loss: 0.2725 
[Training] 411/503 [=======================&gt;......] - ETA: 26s  loss: 0.2624 
[Training] 412/503 [=======================&gt;......] - ETA: 26s  loss: 0.5669 
[Training] 413/503 [=======================&gt;......] - ETA: 25s  loss: 0.5496 
[Training] 414/503 [=======================&gt;......] - ETA: 25s  loss: 0.1034 
[Training] 415/503 [=======================&gt;......] - ETA: 25s  loss: 0.1149 
[Training] 416/503 [=======================&gt;......] - ETA: 24s  loss: 0.1328 
[Training] 417/503 [=======================&gt;......] - ETA: 24s  loss: 0.2387 
[Training] 418/503 [=======================&gt;......] - ETA: 24s  loss: 0.4701 
[Training] 419/503 [=======================&gt;......] - ETA: 24s  loss: 0.2614 
[Training] 420/503 [========================&gt;.....] - ETA: 23s  loss: 0.2105 
[Training] 421/503 [========================&gt;.....] - ETA: 23s  loss: 0.5177 
[Training] 422/503 [========================&gt;.....] - ETA: 23s  loss: 0.4090 
[Training] 423/503 [========================&gt;.....] - ETA: 22s  loss: 0.1916 
[Training] 424/503 [========================&gt;.....] - ETA: 22s  loss: 0.2871 
[Training] 425/503 [========================&gt;.....] - ETA: 22s  loss: 0.2629 
[Training] 426/503 [========================&gt;.....] - ETA: 22s  loss: 0.2829 
[Training] 427/503 [========================&gt;.....] - ETA: 21s  loss: 0.4120 
[Training] 428/503 [========================&gt;.....] - ETA: 21s  loss: 0.3227 
[Training] 429/503 [========================&gt;.....] - ETA: 21s  loss: 0.2436 
[Training] 430/503 [========================&gt;.....] - ETA: 20s  loss: 0.2818 
[Training] 431/503 [========================&gt;.....] - ETA: 20s  loss: 0.3100 
[Training] 432/503 [========================&gt;.....] - ETA: 20s  loss: 0.3346 
[Training] 433/503 [========================&gt;.....] - ETA: 20s  loss: 0.6228 
[Training] 434/503 [========================&gt;.....] - ETA: 19s  loss: 0.4639 
[Training] 435/503 [========================&gt;.....] - ETA: 19s  loss: 0.3376 
[Training] 436/503 [=========================&gt;....] - ETA: 19s  loss: 0.1894 
[Training] 437/503 [=========================&gt;....] - ETA: 18s  loss: 0.2939 
[Training] 438/503 [=========================&gt;....] - ETA: 18s  loss: 0.4346 
[Training] 439/503 [=========================&gt;....] - ETA: 18s  loss: 0.3865 
[Training] 440/503 [=========================&gt;....] - ETA: 18s  loss: 0.2838 
[Training] 441/503 [=========================&gt;....] - ETA: 17s  loss: 0.2251 
[Training] 442/503 [=========================&gt;....] - ETA: 17s  loss: 0.3777 
[Training] 443/503 [=========================&gt;....] - ETA: 17s  loss: 0.2039 
[Training] 444/503 [=========================&gt;....] - ETA: 16s  loss: 0.1457 
[Training] 445/503 [=========================&gt;....] - ETA: 16s  loss: 0.1588 
[Training] 446/503 [=========================&gt;....] - ETA: 16s  loss: 0.3056 
[Training] 447/503 [=========================&gt;....] - ETA: 16s  loss: 0.3351 
[Training] 448/503 [=========================&gt;....] - ETA: 15s  loss: 0.7453 
[Training] 449/503 [=========================&gt;....] - ETA: 15s  loss: 0.0963 
[Training] 450/503 [=========================&gt;....] - ETA: 15s  loss: 0.3040 
[Training] 451/503 [=========================&gt;....] - ETA: 14s  loss: 0.1832 
[Training] 452/503 [=========================&gt;....] - ETA: 14s  loss: 0.4139 
[Training] 453/503 [==========================&gt;...] - ETA: 14s  loss: 0.2860 
[Training] 454/503 [==========================&gt;...] - ETA: 14s  loss: 0.3874 
[Training] 455/503 [==========================&gt;...] - ETA: 13s  loss: 0.1686 
[Training] 456/503 [==========================&gt;...] - ETA: 13s  loss: 0.3665 
[Training] 457/503 [==========================&gt;...] - ETA: 13s  loss: 0.3592 
[Training] 458/503 [==========================&gt;...] - ETA: 12s  loss: 0.0731 
[Training] 459/503 [==========================&gt;...] - ETA: 12s  loss: 0.3429 
[Training] 460/503 [==========================&gt;...] - ETA: 12s  loss: 0.1099 
[Training] 461/503 [==========================&gt;...] - ETA: 12s  loss: 0.0731 
[Training] 462/503 [==========================&gt;...] - ETA: 11s  loss: 0.3115 
[Training] 463/503 [==========================&gt;...] - ETA: 11s  loss: 0.1933 
[Training] 464/503 [==========================&gt;...] - ETA: 11s  loss: 0.2509 
[Training] 465/503 [==========================&gt;...] - ETA: 10s  loss: 0.2025 
[Training] 466/503 [==========================&gt;...] - ETA: 10s  loss: 0.0831 
[Training] 467/503 [==========================&gt;...] - ETA: 10s  loss: 0.1827 
[Training] 468/503 [==========================&gt;...] - ETA: 10s  loss: 0.1470 
[Training] 469/503 [==========================&gt;...] - ETA: 9s  loss: 0.1412 
[Training] 470/503 [===========================&gt;..] - ETA: 9s  loss: 0.1117 
[Training] 471/503 [===========================&gt;..] - ETA: 9s  loss: 0.2352 
[Training] 472/503 [===========================&gt;..] - ETA: 8s  loss: 0.0894 
[Training] 473/503 [===========================&gt;..] - ETA: 8s  loss: 0.1959 
[Training] 474/503 [===========================&gt;..] - ETA: 8s  loss: 0.3390 
[Training] 475/503 [===========================&gt;..] - ETA: 8s  loss: 0.3355 
[Training] 476/503 [===========================&gt;..] - ETA: 7s  loss: 0.3035 
[Training] 477/503 [===========================&gt;..] - ETA: 7s  loss: 0.0774 
[Training] 478/503 [===========================&gt;..] - ETA: 7s  loss: 0.1564 
[Training] 479/503 [===========================&gt;..] - ETA: 6s  loss: 0.2092 
[Training] 480/503 [===========================&gt;..] - ETA: 6s  loss: 0.1634 
[Training] 481/503 [===========================&gt;..] - ETA: 6s  loss: 0.4208 
[Training] 482/503 [===========================&gt;..] - ETA: 6s  loss: 0.4031 
[Training] 483/503 [===========================&gt;..] - ETA: 5s  loss: 0.1008 
[Training] 484/503 [===========================&gt;..] - ETA: 5s  loss: 0.1686 
[Training] 485/503 [===========================&gt;..] - ETA: 5s  loss: 0.4135 
[Training] 486/503 [===========================&gt;..] - ETA: 4s  loss: 0.1089 
[Training] 487/503 [============================&gt;.] - ETA: 4s  loss: 0.1628 
[Training] 488/503 [============================&gt;.] - ETA: 4s  loss: 0.2751 
[Training] 489/503 [============================&gt;.] - ETA: 4s  loss: 0.3233 
[Training] 490/503 [============================&gt;.] - ETA: 3s  loss: 0.2478 
[Training] 491/503 [============================&gt;.] - ETA: 3s  loss: 0.2517 
[Training] 492/503 [============================&gt;.] - ETA: 3s  loss: 0.1355 
[Training] 493/503 [============================&gt;.] - ETA: 2s  loss: 0.4234 
[Training] 494/503 [============================&gt;.] - ETA: 2s  loss: 0.2912 
[Training] 495/503 [============================&gt;.] - ETA: 2s  loss: 0.3374 
[Training] 496/503 [============================&gt;.] - ETA: 2s  loss: 0.2962 
[Training] 497/503 [============================&gt;.] - ETA: 1s  loss: 0.1056 
[Training] 498/503 [============================&gt;.] - ETA: 1s  loss: 0.1138 
[Training] 499/503 [============================&gt;.] - ETA: 1s  loss: 0.4307 
[Training] 500/503 [============================&gt;.] - ETA: 0s  loss: 0.3848 
[Training] 501/503 [============================&gt;.] - ETA: 0s  loss: 0.1878 
[Training] 502/503 [============================&gt;.] - ETA: 0s  loss: 0.1286 
[Training] 503/503 [==============================] 289.4ms/step  loss: 0.0448 
[Testing] 1/32 [..............................] - ETA: 18s
[Testing] 2/32 [&gt;.............................] - ETA: 15s
[Testing] 3/32 [=&gt;............................] - ETA: 13s
[Testing] 4/32 [==&gt;...........................] - ETA: 12s
[Testing] 5/32 [===&gt;..........................] - ETA: 11s
[Testing] 6/32 [====&gt;.........................] - ETA: 10s
[Testing] 7/32 [=====&gt;........................] - ETA: 10s
[Testing] 8/32 [======&gt;.......................] - ETA: 9s
[Testing] 9/32 [=======&gt;......................] - ETA: 9s
[Testing] 10/32 [========&gt;.....................] - ETA: 8s
[Testing] 11/32 [=========&gt;....................] - ETA: 8s
[Testing] 12/32 [==========&gt;...................] - ETA: 7s
[Testing] 13/32 [===========&gt;..................] - ETA: 7s
[Testing] 14/32 [============&gt;.................] - ETA: 7s
[Testing] 15/32 [=============&gt;................] - ETA: 6s
[Testing] 16/32 [==============&gt;...............] - ETA: 6s
[Testing] 17/32 [==============&gt;...............] - ETA: 5s
[Testing] 18/32 [===============&gt;..............] - ETA: 5s
[Testing] 19/32 [================&gt;.............] - ETA: 5s
[Testing] 20/32 [=================&gt;............] - ETA: 4s
[Testing] 21/32 [==================&gt;...........] - ETA: 4s
[Testing] 22/32 [===================&gt;..........] - ETA: 3s
[Testing] 23/32 [====================&gt;.........] - ETA: 3s
[Testing] 24/32 [=====================&gt;........] - ETA: 3s
[Testing] 25/32 [======================&gt;.......] - ETA: 2s
[Testing] 26/32 [=======================&gt;......] - ETA: 2s
[Testing] 27/32 [========================&gt;.....] - ETA: 1s
[Testing] 28/32 [=========================&gt;....] - ETA: 1s
[Testing] 29/32 [==========================&gt;...] - ETA: 1s
[Testing] 30/32 [===========================&gt;..] - ETA: 0s
[Testing] 31/32 [============================&gt;.] - ETA: 0s
[Testing] 32/32 [==============================] 378.0ms/step
## Epoch: 2 -  loss: 0.2766 - valid_loss: 0.3644 - valid_acc: 0.8297 - valid_f1: 0.7916 
## 
[Training] 1/503 [..............................] - ETA: 2:10  loss: 0.2089 
[Training] 2/503 [..............................] - ETA: 2:16  loss: 0.2562 
[Training] 3/503 [..............................] - ETA: 2:21  loss: 0.2412 
[Training] 4/503 [..............................] - ETA: 2:21  loss: 0.1807 
[Training] 5/503 [..............................] - ETA: 2:22  loss: 0.3342 
[Training] 6/503 [..............................] - ETA: 2:25  loss: 0.1088 
[Training] 7/503 [..............................] - ETA: 2:25  loss: 0.1742 
[Training] 8/503 [..............................] - ETA: 2:25  loss: 0.1777 
[Training] 9/503 [..............................] - ETA: 2:24  loss: 0.0636 
[Training] 10/503 [..............................] - ETA: 2:26  loss: 0.3633 
[Training] 11/503 [..............................] - ETA: 2:24  loss: 0.2220 
[Training] 12/503 [..............................] - ETA: 2:24  loss: 0.2419 
[Training] 13/503 [..............................] - ETA: 2:23  loss: 0.2654 
[Training] 14/503 [..............................] - ETA: 2:23  loss: 0.1134 
[Training] 15/503 [..............................] - ETA: 2:22  loss: 0.3819 
[Training] 16/503 [..............................] - ETA: 2:22  loss: 0.2120 
[Training] 17/503 [&gt;.............................] - ETA: 2:21  loss: 0.2934 
[Training] 18/503 [&gt;.............................] - ETA: 2:20  loss: 0.1335 
[Training] 19/503 [&gt;.............................] - ETA: 2:19  loss: 0.2074 
[Training] 20/503 [&gt;.............................] - ETA: 2:19  loss: 0.4768 
[Training] 21/503 [&gt;.............................] - ETA: 2:18  loss: 0.5128 
[Training] 22/503 [&gt;.............................] - ETA: 2:18  loss: 0.0856 
[Training] 23/503 [&gt;.............................] - ETA: 2:17  loss: 0.1650 
[Training] 24/503 [&gt;.............................] - ETA: 2:16  loss: 0.2897 
[Training] 25/503 [&gt;.............................] - ETA: 2:16  loss: 0.4296 
[Training] 26/503 [&gt;.............................] - ETA: 2:15  loss: 0.4421 
[Training] 27/503 [&gt;.............................] - ETA: 2:15  loss: 0.0370 
[Training] 28/503 [&gt;.............................] - ETA: 2:16  loss: 0.4312 
[Training] 29/503 [&gt;.............................] - ETA: 2:16  loss: 0.3565 
[Training] 30/503 [&gt;.............................] - ETA: 2:15  loss: 0.3396 
[Training] 31/503 [&gt;.............................] - ETA: 2:15  loss: 0.0829 
[Training] 32/503 [&gt;.............................] - ETA: 2:14  loss: 0.4225 
[Training] 33/503 [&gt;.............................] - ETA: 2:15  loss: 0.3766 
[Training] 34/503 [=&gt;............................] - ETA: 2:15  loss: 0.2867 
[Training] 35/503 [=&gt;............................] - ETA: 2:15  loss: 0.1230 
[Training] 36/503 [=&gt;............................] - ETA: 2:14  loss: 0.1395 
[Training] 37/503 [=&gt;............................] - ETA: 2:14  loss: 0.1815 
[Training] 38/503 [=&gt;............................] - ETA: 2:14  loss: 0.1212 
[Training] 39/503 [=&gt;............................] - ETA: 2:13  loss: 0.0982 
[Training] 40/503 [=&gt;............................] - ETA: 2:13  loss: 0.2889 
[Training] 41/503 [=&gt;............................] - ETA: 2:12  loss: 0.3605 
[Training] 42/503 [=&gt;............................] - ETA: 2:12  loss: 0.2819 
[Training] 43/503 [=&gt;............................] - ETA: 2:11  loss: 0.3428 
[Training] 44/503 [=&gt;............................] - ETA: 2:11  loss: 0.5308 
[Training] 45/503 [=&gt;............................] - ETA: 2:11  loss: 0.1929 
[Training] 46/503 [=&gt;............................] - ETA: 2:10  loss: 0.4796 
[Training] 47/503 [=&gt;............................] - ETA: 2:10  loss: 0.2728 
[Training] 48/503 [=&gt;............................] - ETA: 2:10  loss: 0.2586 
[Training] 49/503 [=&gt;............................] - ETA: 2:10  loss: 0.5039 
[Training] 50/503 [=&gt;............................] - ETA: 2:10  loss: 0.1675 
[Training] 51/503 [==&gt;...........................] - ETA: 2:10  loss: 0.5156 
[Training] 52/503 [==&gt;...........................] - ETA: 2:10  loss: 0.1911 
[Training] 53/503 [==&gt;...........................] - ETA: 2:10  loss: 0.6664 
[Training] 54/503 [==&gt;...........................] - ETA: 2:09  loss: 0.0739 
[Training] 55/503 [==&gt;...........................] - ETA: 2:10  loss: 0.0737 
[Training] 56/503 [==&gt;...........................] - ETA: 2:09  loss: 0.1981 
[Training] 57/503 [==&gt;...........................] - ETA: 2:10  loss: 0.1651 
[Training] 58/503 [==&gt;...........................] - ETA: 2:09  loss: 0.1115 
[Training] 59/503 [==&gt;...........................] - ETA: 2:10  loss: 0.2824 
[Training] 60/503 [==&gt;...........................] - ETA: 2:09  loss: 0.2889 
[Training] 61/503 [==&gt;...........................] - ETA: 2:09  loss: 0.3601 
[Training] 62/503 [==&gt;...........................] - ETA: 2:09  loss: 0.2011 
[Training] 63/503 [==&gt;...........................] - ETA: 2:09  loss: 0.3720 
[Training] 64/503 [==&gt;...........................] - ETA: 2:08  loss: 0.2042 
[Training] 65/503 [==&gt;...........................] - ETA: 2:08  loss: 0.2830 
[Training] 66/503 [==&gt;...........................] - ETA: 2:08  loss: 0.1847 
[Training] 67/503 [==&gt;...........................] - ETA: 2:08  loss: 0.2107 
[Training] 68/503 [===&gt;..........................] - ETA: 2:08  loss: 0.5158 
[Training] 69/503 [===&gt;..........................] - ETA: 2:07  loss: 0.1568 
[Training] 70/503 [===&gt;..........................] - ETA: 2:08  loss: 0.3267 
[Training] 71/503 [===&gt;..........................] - ETA: 2:07  loss: 0.0939 
[Training] 72/503 [===&gt;..........................] - ETA: 2:07  loss: 0.2069 
[Training] 73/503 [===&gt;..........................] - ETA: 2:07  loss: 0.0895 
[Training] 74/503 [===&gt;..........................] - ETA: 2:06  loss: 0.2517 
[Training] 75/503 [===&gt;..........................] - ETA: 2:06  loss: 0.2411 
[Training] 76/503 [===&gt;..........................] - ETA: 2:06  loss: 0.3388 
[Training] 77/503 [===&gt;..........................] - ETA: 2:05  loss: 0.3526 
[Training] 78/503 [===&gt;..........................] - ETA: 2:05  loss: 0.2943 
[Training] 79/503 [===&gt;..........................] - ETA: 2:05  loss: 0.2550 
[Training] 80/503 [===&gt;..........................] - ETA: 2:04  loss: 0.2119 
[Training] 81/503 [===&gt;..........................] - ETA: 2:04  loss: 0.2053 
[Training] 82/503 [===&gt;..........................] - ETA: 2:04  loss: 0.3363 
[Training] 83/503 [===&gt;..........................] - ETA: 2:04  loss: 0.0759 
[Training] 84/503 [====&gt;.........................] - ETA: 2:03  loss: 0.4759 
[Training] 85/503 [====&gt;.........................] - ETA: 2:03  loss: 0.1266 
[Training] 86/503 [====&gt;.........................] - ETA: 2:03  loss: 0.2374 
[Training] 87/503 [====&gt;.........................] - ETA: 2:02  loss: 0.0901 
[Training] 88/503 [====&gt;.........................] - ETA: 2:02  loss: 0.3792 
[Training] 89/503 [====&gt;.........................] - ETA: 2:02  loss: 0.1854 
[Training] 90/503 [====&gt;.........................] - ETA: 2:02  loss: 0.1836 
[Training] 91/503 [====&gt;.........................] - ETA: 2:01  loss: 0.5802 
[Training] 92/503 [====&gt;.........................] - ETA: 2:01  loss: 0.1413 
[Training] 93/503 [====&gt;.........................] - ETA: 2:00  loss: 0.4507 
[Training] 94/503 [====&gt;.........................] - ETA: 2:00  loss: 0.0629 
[Training] 95/503 [====&gt;.........................] - ETA: 1:59  loss: 0.2666 
[Training] 96/503 [====&gt;.........................] - ETA: 1:59  loss: 0.2744 
[Training] 97/503 [====&gt;.........................] - ETA: 1:59  loss: 0.1883 
[Training] 98/503 [====&gt;.........................] - ETA: 1:58  loss: 0.2933 
[Training] 99/503 [====&gt;.........................] - ETA: 1:58  loss: 0.0942 
[Training] 100/503 [====&gt;.........................] - ETA: 1:58  loss: 0.4667 
[Training] 101/503 [=====&gt;........................] - ETA: 1:58  loss: 0.2179 
[Training] 102/503 [=====&gt;........................] - ETA: 1:57  loss: 0.2555 
[Training] 103/503 [=====&gt;........................] - ETA: 1:57  loss: 0.3330 
[Training] 104/503 [=====&gt;........................] - ETA: 1:57  loss: 0.1641 
[Training] 105/503 [=====&gt;........................] - ETA: 1:57  loss: 0.3032 
[Training] 106/503 [=====&gt;........................] - ETA: 1:56  loss: 0.3855 
[Training] 107/503 [=====&gt;........................] - ETA: 1:56  loss: 0.2685 
[Training] 108/503 [=====&gt;........................] - ETA: 1:56  loss: 0.4605 
[Training] 109/503 [=====&gt;........................] - ETA: 1:55  loss: 0.1053 
[Training] 110/503 [=====&gt;........................] - ETA: 1:55  loss: 0.1944 
[Training] 111/503 [=====&gt;........................] - ETA: 1:55  loss: 0.1797 
[Training] 112/503 [=====&gt;........................] - ETA: 1:54  loss: 0.3201 
[Training] 113/503 [=====&gt;........................] - ETA: 1:55  loss: 0.5156 
[Training] 114/503 [=====&gt;........................] - ETA: 1:54  loss: 0.2040 
[Training] 115/503 [=====&gt;........................] - ETA: 1:54  loss: 0.1650 
[Training] 116/503 [=====&gt;........................] - ETA: 1:54  loss: 0.1467 
[Training] 117/503 [=====&gt;........................] - ETA: 1:53  loss: 0.1945 
[Training] 118/503 [======&gt;.......................] - ETA: 1:53  loss: 0.1637 
[Training] 119/503 [======&gt;.......................] - ETA: 1:53  loss: 0.1340 
[Training] 120/503 [======&gt;.......................] - ETA: 1:53  loss: 0.2253 
[Training] 121/503 [======&gt;.......................] - ETA: 1:52  loss: 0.3789 
[Training] 122/503 [======&gt;.......................] - ETA: 1:52  loss: 0.3289 
[Training] 123/503 [======&gt;.......................] - ETA: 1:52  loss: 0.4023 
[Training] 124/503 [======&gt;.......................] - ETA: 1:52  loss: 0.1394 
[Training] 125/503 [======&gt;.......................] - ETA: 1:51  loss: 0.3418 
[Training] 126/503 [======&gt;.......................] - ETA: 1:51  loss: 0.3086 
[Training] 127/503 [======&gt;.......................] - ETA: 1:51  loss: 0.0986 
[Training] 128/503 [======&gt;.......................] - ETA: 1:51  loss: 0.1042 
[Training] 129/503 [======&gt;.......................] - ETA: 1:51  loss: 0.2619 
[Training] 130/503 [======&gt;.......................] - ETA: 1:51  loss: 0.1375 
[Training] 131/503 [======&gt;.......................] - ETA: 1:50  loss: 0.2442 
[Training] 132/503 [======&gt;.......................] - ETA: 1:50  loss: 0.2131 
[Training] 133/503 [======&gt;.......................] - ETA: 1:50  loss: 0.1806 
[Training] 134/503 [======&gt;.......................] - ETA: 1:50  loss: 0.0799 
[Training] 135/503 [=======&gt;......................] - ETA: 1:50  loss: 0.0318 
[Training] 136/503 [=======&gt;......................] - ETA: 1:49  loss: 0.2810 
[Training] 137/503 [=======&gt;......................] - ETA: 1:49  loss: 0.0830 
[Training] 138/503 [=======&gt;......................] - ETA: 1:49  loss: 0.2939 
[Training] 139/503 [=======&gt;......................] - ETA: 1:48  loss: 0.2007 
[Training] 140/503 [=======&gt;......................] - ETA: 1:48  loss: 0.1695 
[Training] 141/503 [=======&gt;......................] - ETA: 1:48  loss: 0.2384 
[Training] 142/503 [=======&gt;......................] - ETA: 1:47  loss: 0.1642 
[Training] 143/503 [=======&gt;......................] - ETA: 1:47  loss: 0.3823 
[Training] 144/503 [=======&gt;......................] - ETA: 1:47  loss: 0.2524 
[Training] 145/503 [=======&gt;......................] - ETA: 1:46  loss: 0.3065 
[Training] 146/503 [=======&gt;......................] - ETA: 1:46  loss: 0.1820 
[Training] 147/503 [=======&gt;......................] - ETA: 1:46  loss: 0.0533 
[Training] 148/503 [=======&gt;......................] - ETA: 1:46  loss: 0.2944 
[Training] 149/503 [=======&gt;......................] - ETA: 1:45  loss: 0.1245 
[Training] 150/503 [=======&gt;......................] - ETA: 1:45  loss: 0.1723 
[Training] 151/503 [========&gt;.....................] - ETA: 1:45  loss: 0.3291 
[Training] 152/503 [========&gt;.....................] - ETA: 1:44  loss: 0.2389 
[Training] 153/503 [========&gt;.....................] - ETA: 1:44  loss: 0.1007 
[Training] 154/503 [========&gt;.....................] - ETA: 1:44  loss: 0.1169 
[Training] 155/503 [========&gt;.....................] - ETA: 1:44  loss: 0.1211 
[Training] 156/503 [========&gt;.....................] - ETA: 1:44  loss: 0.2264 
[Training] 157/503 [========&gt;.....................] - ETA: 1:43  loss: 0.1358 
[Training] 158/503 [========&gt;.....................] - ETA: 1:43  loss: 0.0857 
[Training] 159/503 [========&gt;.....................] - ETA: 1:43  loss: 0.1311 
[Training] 160/503 [========&gt;.....................] - ETA: 1:42  loss: 0.0569 
[Training] 161/503 [========&gt;.....................] - ETA: 1:42  loss: 0.0868 
[Training] 162/503 [========&gt;.....................] - ETA: 1:42  loss: 0.0993 
[Training] 163/503 [========&gt;.....................] - ETA: 1:42  loss: 0.2530 
[Training] 164/503 [========&gt;.....................] - ETA: 1:42  loss: 0.0320 
[Training] 165/503 [========&gt;.....................] - ETA: 1:41  loss: 0.4953 
[Training] 166/503 [========&gt;.....................] - ETA: 1:41  loss: 0.2048 
[Training] 167/503 [========&gt;.....................] - ETA: 1:41  loss: 0.0972 
[Training] 168/503 [=========&gt;....................] - ETA: 1:40  loss: 0.1576 
[Training] 169/503 [=========&gt;....................] - ETA: 1:40  loss: 0.1461 
[Training] 170/503 [=========&gt;....................] - ETA: 1:40  loss: 0.2701 
[Training] 171/503 [=========&gt;....................] - ETA: 1:39  loss: 0.1134 
[Training] 172/503 [=========&gt;....................] - ETA: 1:39  loss: 0.1001 
[Training] 173/503 [=========&gt;....................] - ETA: 1:39  loss: 0.1455 
[Training] 174/503 [=========&gt;....................] - ETA: 1:38  loss: 0.1074 
[Training] 175/503 [=========&gt;....................] - ETA: 1:38  loss: 0.0959 
[Training] 176/503 [=========&gt;....................] - ETA: 1:38  loss: 0.2400 
[Training] 177/503 [=========&gt;....................] - ETA: 1:38  loss: 0.2872 
[Training] 178/503 [=========&gt;....................] - ETA: 1:38  loss: 0.2818 
[Training] 179/503 [=========&gt;....................] - ETA: 1:37  loss: 0.0266 
[Training] 180/503 [=========&gt;....................] - ETA: 1:37  loss: 0.1231 
[Training] 181/503 [=========&gt;....................] - ETA: 1:36  loss: 0.2812 
[Training] 182/503 [=========&gt;....................] - ETA: 1:36  loss: 0.1485 
[Training] 183/503 [=========&gt;....................] - ETA: 1:36  loss: 0.2798 
[Training] 184/503 [=========&gt;....................] - ETA: 1:35  loss: 0.5475 
[Training] 185/503 [==========&gt;...................] - ETA: 1:35  loss: 0.0506 
[Training] 186/503 [==========&gt;...................] - ETA: 1:35  loss: 0.2122 
[Training] 187/503 [==========&gt;...................] - ETA: 1:35  loss: 0.1626 
[Training] 188/503 [==========&gt;...................] - ETA: 1:34  loss: 0.1431 
[Training] 189/503 [==========&gt;...................] - ETA: 1:34  loss: 0.2116 
[Training] 190/503 [==========&gt;...................] - ETA: 1:34  loss: 0.1009 
[Training] 191/503 [==========&gt;...................] - ETA: 1:33  loss: 0.2145 
[Training] 192/503 [==========&gt;...................] - ETA: 1:33  loss: 0.1351 
[Training] 193/503 [==========&gt;...................] - ETA: 1:33  loss: 0.4222 
[Training] 194/503 [==========&gt;...................] - ETA: 1:32  loss: 0.2383 
[Training] 195/503 [==========&gt;...................] - ETA: 1:32  loss: 0.0481 
[Training] 196/503 [==========&gt;...................] - ETA: 1:32  loss: 0.4166 
[Training] 197/503 [==========&gt;...................] - ETA: 1:32  loss: 0.3751 
[Training] 198/503 [==========&gt;...................] - ETA: 1:31  loss: 0.5054 
[Training] 199/503 [==========&gt;...................] - ETA: 1:31  loss: 0.4878 
[Training] 200/503 [==========&gt;...................] - ETA: 1:31  loss: 0.0840 
[Training] 201/503 [==========&gt;...................] - ETA: 1:30  loss: 0.3510 
[Training] 202/503 [===========&gt;..................] - ETA: 1:30  loss: 0.1098 
[Training] 203/503 [===========&gt;..................] - ETA: 1:30  loss: 0.2614 
[Training] 204/503 [===========&gt;..................] - ETA: 1:30  loss: 0.0636 
[Training] 205/503 [===========&gt;..................] - ETA: 1:29  loss: 0.0430 
[Training] 206/503 [===========&gt;..................] - ETA: 1:29  loss: 0.2455 
[Training] 207/503 [===========&gt;..................] - ETA: 1:29  loss: 0.3995 
[Training] 208/503 [===========&gt;..................] - ETA: 1:28  loss: 0.3447 
[Training] 209/503 [===========&gt;..................] - ETA: 1:28  loss: 0.0585 
[Training] 210/503 [===========&gt;..................] - ETA: 1:28  loss: 0.0751 
[Training] 211/503 [===========&gt;..................] - ETA: 1:27  loss: 0.3279 
[Training] 212/503 [===========&gt;..................] - ETA: 1:27  loss: 0.4428 
[Training] 213/503 [===========&gt;..................] - ETA: 1:27  loss: 0.2922 
[Training] 214/503 [===========&gt;..................] - ETA: 1:27  loss: 0.0825 
[Training] 215/503 [===========&gt;..................] - ETA: 1:26  loss: 0.2377 
[Training] 216/503 [===========&gt;..................] - ETA: 1:26  loss: 0.1499 
[Training] 217/503 [===========&gt;..................] - ETA: 1:26  loss: 0.0820 
[Training] 218/503 [============&gt;.................] - ETA: 1:25  loss: 0.3033 
[Training] 219/503 [============&gt;.................] - ETA: 1:25  loss: 0.1987 
[Training] 220/503 [============&gt;.................] - ETA: 1:25  loss: 0.0991 
[Training] 221/503 [============&gt;.................] - ETA: 1:24  loss: 0.2802 
[Training] 222/503 [============&gt;.................] - ETA: 1:24  loss: 0.0949 
[Training] 223/503 [============&gt;.................] - ETA: 1:24  loss: 0.3879 
[Training] 224/503 [============&gt;.................] - ETA: 1:23  loss: 0.1737 
[Training] 225/503 [============&gt;.................] - ETA: 1:23  loss: 0.0205 
[Training] 226/503 [============&gt;.................] - ETA: 1:23  loss: 0.1243 
[Training] 227/503 [============&gt;.................] - ETA: 1:23  loss: 0.1197 
[Training] 228/503 [============&gt;.................] - ETA: 1:22  loss: 0.2965 
[Training] 229/503 [============&gt;.................] - ETA: 1:22  loss: 0.3222 
[Training] 230/503 [============&gt;.................] - ETA: 1:22  loss: 0.3373 
[Training] 231/503 [============&gt;.................] - ETA: 1:21  loss: 0.1865 
[Training] 232/503 [============&gt;.................] - ETA: 1:21  loss: 0.1216 
[Training] 233/503 [============&gt;.................] - ETA: 1:21  loss: 0.3017 
[Training] 234/503 [============&gt;.................] - ETA: 1:20  loss: 0.2871 
[Training] 235/503 [=============&gt;................] - ETA: 1:20  loss: 0.1063 
[Training] 236/503 [=============&gt;................] - ETA: 1:20  loss: 0.0462 
[Training] 237/503 [=============&gt;................] - ETA: 1:20  loss: 0.3475 
[Training] 238/503 [=============&gt;................] - ETA: 1:19  loss: 0.4522 
[Training] 239/503 [=============&gt;................] - ETA: 1:19  loss: 0.1776 
[Training] 240/503 [=============&gt;................] - ETA: 1:19  loss: 0.2532 
[Training] 241/503 [=============&gt;................] - ETA: 1:18  loss: 0.1413 
[Training] 242/503 [=============&gt;................] - ETA: 1:18  loss: 0.1541 
[Training] 243/503 [=============&gt;................] - ETA: 1:18  loss: 0.0940 
[Training] 244/503 [=============&gt;................] - ETA: 1:17  loss: 0.3863 
[Training] 245/503 [=============&gt;................] - ETA: 1:17  loss: 0.5981 
[Training] 246/503 [=============&gt;................] - ETA: 1:17  loss: 0.1827 
[Training] 247/503 [=============&gt;................] - ETA: 1:16  loss: 0.2540 
[Training] 248/503 [=============&gt;................] - ETA: 1:16  loss: 0.1698 
[Training] 249/503 [=============&gt;................] - ETA: 1:16  loss: 0.2472 
[Training] 250/503 [=============&gt;................] - ETA: 1:16  loss: 0.4201 
[Training] 251/503 [=============&gt;................] - ETA: 1:15  loss: 0.5479 
[Training] 252/503 [==============&gt;...............] - ETA: 1:15  loss: 0.1108 
[Training] 253/503 [==============&gt;...............] - ETA: 1:15  loss: 0.3214 
[Training] 254/503 [==============&gt;...............] - ETA: 1:14  loss: 0.1785 
[Training] 255/503 [==============&gt;...............] - ETA: 1:14  loss: 0.1410 
[Training] 256/503 [==============&gt;...............] - ETA: 1:14  loss: 0.6880 
[Training] 257/503 [==============&gt;...............] - ETA: 1:13  loss: 0.1801 
[Training] 258/503 [==============&gt;...............] - ETA: 1:13  loss: 0.3733 
[Training] 259/503 [==============&gt;...............] - ETA: 1:13  loss: 0.1614 
[Training] 260/503 [==============&gt;...............] - ETA: 1:13  loss: 0.3173 
[Training] 261/503 [==============&gt;...............] - ETA: 1:12  loss: 0.3504 
[Training] 262/503 [==============&gt;...............] - ETA: 1:12  loss: 0.1119 
[Training] 263/503 [==============&gt;...............] - ETA: 1:12  loss: 0.1444 
[Training] 264/503 [==============&gt;...............] - ETA: 1:11  loss: 0.3250 
[Training] 265/503 [==============&gt;...............] - ETA: 1:11  loss: 0.2387 
[Training] 266/503 [==============&gt;...............] - ETA: 1:11  loss: 0.1750 
[Training] 267/503 [==============&gt;...............] - ETA: 1:10  loss: 0.1070 
[Training] 268/503 [==============&gt;...............] - ETA: 1:10  loss: 0.2926 
[Training] 269/503 [===============&gt;..............] - ETA: 1:10  loss: 0.0978 
[Training] 270/503 [===============&gt;..............] - ETA: 1:10  loss: 0.3263 
[Training] 271/503 [===============&gt;..............] - ETA: 1:09  loss: 0.2784 
[Training] 272/503 [===============&gt;..............] - ETA: 1:09  loss: 0.5797 
[Training] 273/503 [===============&gt;..............] - ETA: 1:09  loss: 0.3869 
[Training] 274/503 [===============&gt;..............] - ETA: 1:08  loss: 0.0638 
[Training] 275/503 [===============&gt;..............] - ETA: 1:08  loss: 0.1624 
[Training] 276/503 [===============&gt;..............] - ETA: 1:08  loss: 0.5047 
[Training] 277/503 [===============&gt;..............] - ETA: 1:07  loss: 0.3190 
[Training] 278/503 [===============&gt;..............] - ETA: 1:07  loss: 0.3082 
[Training] 279/503 [===============&gt;..............] - ETA: 1:07  loss: 0.1748 
[Training] 280/503 [===============&gt;..............] - ETA: 1:07  loss: 0.5392 
[Training] 281/503 [===============&gt;..............] - ETA: 1:06  loss: 0.3554 
[Training] 282/503 [===============&gt;..............] - ETA: 1:06  loss: 0.0798 
[Training] 283/503 [===============&gt;..............] - ETA: 1:06  loss: 0.2472 
[Training] 284/503 [===============&gt;..............] - ETA: 1:05  loss: 0.5369 
[Training] 285/503 [===============&gt;..............] - ETA: 1:05  loss: 0.1836 
[Training] 286/503 [================&gt;.............] - ETA: 1:05  loss: 0.2148 
[Training] 287/503 [================&gt;.............] - ETA: 1:04  loss: 0.4945 
[Training] 288/503 [================&gt;.............] - ETA: 1:04  loss: 0.2195 
[Training] 289/503 [================&gt;.............] - ETA: 1:04  loss: 0.3249 
[Training] 290/503 [================&gt;.............] - ETA: 1:03  loss: 0.2450 
[Training] 291/503 [================&gt;.............] - ETA: 1:03  loss: 0.1170 
[Training] 292/503 [================&gt;.............] - ETA: 1:03  loss: 0.0623 
[Training] 293/503 [================&gt;.............] - ETA: 1:03  loss: 0.2270 
[Training] 294/503 [================&gt;.............] - ETA: 1:02  loss: 0.0976 
[Training] 295/503 [================&gt;.............] - ETA: 1:02  loss: 0.2994 
[Training] 296/503 [================&gt;.............] - ETA: 1:02  loss: 0.3235 
[Training] 297/503 [================&gt;.............] - ETA: 1:01  loss: 0.2426 
[Training] 298/503 [================&gt;.............] - ETA: 1:01  loss: 0.1978 
[Training] 299/503 [================&gt;.............] - ETA: 1:01  loss: 0.0918 
[Training] 300/503 [================&gt;.............] - ETA: 1:00  loss: 0.1168 
[Training] 301/503 [================&gt;.............] - ETA: 1:00  loss: 0.2541 
[Training] 302/503 [=================&gt;............] - ETA: 1:00  loss: 0.1293 
[Training] 303/503 [=================&gt;............] - ETA: 1:00  loss: 0.0964 
[Training] 304/503 [=================&gt;............] - ETA: 59s  loss: 0.4211 
[Training] 305/503 [=================&gt;............] - ETA: 59s  loss: 0.1718 
[Training] 306/503 [=================&gt;............] - ETA: 59s  loss: 0.0751 
[Training] 307/503 [=================&gt;............] - ETA: 58s  loss: 0.0751 
[Training] 308/503 [=================&gt;............] - ETA: 58s  loss: 0.0945 
[Training] 309/503 [=================&gt;............] - ETA: 58s  loss: 0.4313 
[Training] 310/503 [=================&gt;............] - ETA: 57s  loss: 0.0535 
[Training] 311/503 [=================&gt;............] - ETA: 57s  loss: 0.2448 
[Training] 312/503 [=================&gt;............] - ETA: 57s  loss: 0.1621 
[Training] 313/503 [=================&gt;............] - ETA: 57s  loss: 0.1989 
[Training] 314/503 [=================&gt;............] - ETA: 56s  loss: 0.4865 
[Training] 315/503 [=================&gt;............] - ETA: 56s  loss: 0.0294 
[Training] 316/503 [=================&gt;............] - ETA: 56s  loss: 0.2422 
[Training] 317/503 [=================&gt;............] - ETA: 55s  loss: 0.2147 
[Training] 318/503 [=================&gt;............] - ETA: 55s  loss: 0.2542 
[Training] 319/503 [==================&gt;...........] - ETA: 55s  loss: 0.1664 
[Training] 320/503 [==================&gt;...........] - ETA: 55s  loss: 0.1202 
[Training] 321/503 [==================&gt;...........] - ETA: 54s  loss: 0.3241 
[Training] 322/503 [==================&gt;...........] - ETA: 54s  loss: 0.0416 
[Training] 323/503 [==================&gt;...........] - ETA: 54s  loss: 0.4369 
[Training] 324/503 [==================&gt;...........] - ETA: 53s  loss: 0.2001 
[Training] 325/503 [==================&gt;...........] - ETA: 53s  loss: 0.1335 
[Training] 326/503 [==================&gt;...........] - ETA: 53s  loss: 0.1007 
[Training] 327/503 [==================&gt;...........] - ETA: 52s  loss: 0.4386 
[Training] 328/503 [==================&gt;...........] - ETA: 52s  loss: 0.2463 
[Training] 329/503 [==================&gt;...........] - ETA: 52s  loss: 0.2391 
[Training] 330/503 [==================&gt;...........] - ETA: 52s  loss: 0.0809 
[Training] 331/503 [==================&gt;...........] - ETA: 51s  loss: 0.2146 
[Training] 332/503 [==================&gt;...........] - ETA: 51s  loss: 0.4027 
[Training] 333/503 [==================&gt;...........] - ETA: 51s  loss: 0.3717 
[Training] 334/503 [==================&gt;...........] - ETA: 50s  loss: 0.3112 
[Training] 335/503 [==================&gt;...........] - ETA: 50s  loss: 0.0568 
[Training] 336/503 [===================&gt;..........] - ETA: 50s  loss: 0.1031 
[Training] 337/503 [===================&gt;..........] - ETA: 49s  loss: 0.2503 
[Training] 338/503 [===================&gt;..........] - ETA: 49s  loss: 0.2370 
[Training] 339/503 [===================&gt;..........] - ETA: 49s  loss: 0.4956 
[Training] 340/503 [===================&gt;..........] - ETA: 49s  loss: 0.0485 
[Training] 341/503 [===================&gt;..........] - ETA: 48s  loss: 0.4163 
[Training] 342/503 [===================&gt;..........] - ETA: 48s  loss: 0.0764 
[Training] 343/503 [===================&gt;..........] - ETA: 48s  loss: 0.4269 
[Training] 344/503 [===================&gt;..........] - ETA: 47s  loss: 0.2261 
[Training] 345/503 [===================&gt;..........] - ETA: 47s  loss: 0.0597 
[Training] 346/503 [===================&gt;..........] - ETA: 47s  loss: 0.0916 
[Training] 347/503 [===================&gt;..........] - ETA: 46s  loss: 0.0613 
[Training] 348/503 [===================&gt;..........] - ETA: 46s  loss: 0.3072 
[Training] 349/503 [===================&gt;..........] - ETA: 46s  loss: 0.1940 
[Training] 350/503 [===================&gt;..........] - ETA: 46s  loss: 0.2628 
[Training] 351/503 [===================&gt;..........] - ETA: 45s  loss: 0.3965 
[Training] 352/503 [===================&gt;..........] - ETA: 45s  loss: 0.2567 
[Training] 353/503 [====================&gt;.........] - ETA: 45s  loss: 0.0986 
[Training] 354/503 [====================&gt;.........] - ETA: 44s  loss: 0.1904 
[Training] 355/503 [====================&gt;.........] - ETA: 44s  loss: 0.1900 
[Training] 356/503 [====================&gt;.........] - ETA: 44s  loss: 0.0984 
[Training] 357/503 [====================&gt;.........] - ETA: 44s  loss: 0.1260 
[Training] 358/503 [====================&gt;.........] - ETA: 43s  loss: 0.2448 
[Training] 359/503 [====================&gt;.........] - ETA: 43s  loss: 0.1802 
[Training] 360/503 [====================&gt;.........] - ETA: 43s  loss: 0.2138 
[Training] 361/503 [====================&gt;.........] - ETA: 42s  loss: 0.0740 
[Training] 362/503 [====================&gt;.........] - ETA: 42s  loss: 0.0757 
[Training] 363/503 [====================&gt;.........] - ETA: 42s  loss: 0.1718 
[Training] 364/503 [====================&gt;.........] - ETA: 41s  loss: 0.2088 
[Training] 365/503 [====================&gt;.........] - ETA: 41s  loss: 0.3016 
[Training] 366/503 [====================&gt;.........] - ETA: 41s  loss: 0.3214 
[Training] 367/503 [====================&gt;.........] - ETA: 40s  loss: 0.0602 
[Training] 368/503 [====================&gt;.........] - ETA: 40s  loss: 0.1552 
[Training] 369/503 [=====================&gt;........] - ETA: 40s  loss: 0.1488 
[Training] 370/503 [=====================&gt;........] - ETA: 40s  loss: 0.3656 
[Training] 371/503 [=====================&gt;........] - ETA: 39s  loss: 0.2305 
[Training] 372/503 [=====================&gt;........] - ETA: 39s  loss: 0.2291 
[Training] 373/503 [=====================&gt;........] - ETA: 39s  loss: 0.1737 
[Training] 374/503 [=====================&gt;........] - ETA: 38s  loss: 0.0464 
[Training] 375/503 [=====================&gt;........] - ETA: 38s  loss: 0.1500 
[Training] 376/503 [=====================&gt;........] - ETA: 38s  loss: 0.0532 
[Training] 377/503 [=====================&gt;........] - ETA: 37s  loss: 0.3365 
[Training] 378/503 [=====================&gt;........] - ETA: 37s  loss: 0.4080 
[Training] 379/503 [=====================&gt;........] - ETA: 37s  loss: 0.2906 
[Training] 380/503 [=====================&gt;........] - ETA: 37s  loss: 0.2205 
[Training] 381/503 [=====================&gt;........] - ETA: 36s  loss: 0.1820 
[Training] 382/503 [=====================&gt;........] - ETA: 36s  loss: 0.1196 
[Training] 383/503 [=====================&gt;........] - ETA: 36s  loss: 0.2466 
[Training] 384/503 [=====================&gt;........] - ETA: 35s  loss: 0.2456 
[Training] 385/503 [=====================&gt;........] - ETA: 35s  loss: 0.1739 
[Training] 386/503 [======================&gt;.......] - ETA: 35s  loss: 0.6095 
[Training] 387/503 [======================&gt;.......] - ETA: 34s  loss: 0.1606 
[Training] 388/503 [======================&gt;.......] - ETA: 34s  loss: 0.2391 
[Training] 389/503 [======================&gt;.......] - ETA: 34s  loss: 0.1970 
[Training] 390/503 [======================&gt;.......] - ETA: 34s  loss: 0.1288 
[Training] 391/503 [======================&gt;.......] - ETA: 33s  loss: 0.3813 
[Training] 392/503 [======================&gt;.......] - ETA: 33s  loss: 0.2969 
[Training] 393/503 [======================&gt;.......] - ETA: 33s  loss: 0.4168 
[Training] 394/503 [======================&gt;.......] - ETA: 32s  loss: 0.2297 
[Training] 395/503 [======================&gt;.......] - ETA: 32s  loss: 0.0745 
[Training] 396/503 [======================&gt;.......] - ETA: 32s  loss: 0.1398 
[Training] 397/503 [======================&gt;.......] - ETA: 31s  loss: 0.1876 
[Training] 398/503 [======================&gt;.......] - ETA: 31s  loss: 0.0997 
[Training] 399/503 [======================&gt;.......] - ETA: 31s  loss: 0.1442 
[Training] 400/503 [======================&gt;.......] - ETA: 30s  loss: 0.1507 
[Training] 401/503 [======================&gt;.......] - ETA: 30s  loss: 0.2339 
[Training] 402/503 [======================&gt;.......] - ETA: 30s  loss: 0.1518 
[Training] 403/503 [=======================&gt;......] - ETA: 30s  loss: 0.1416 
[Training] 404/503 [=======================&gt;......] - ETA: 29s  loss: 0.1572 
[Training] 405/503 [=======================&gt;......] - ETA: 29s  loss: 0.2229 
[Training] 406/503 [=======================&gt;......] - ETA: 29s  loss: 0.1847 
[Training] 407/503 [=======================&gt;......] - ETA: 28s  loss: 0.1551 
[Training] 408/503 [=======================&gt;......] - ETA: 28s  loss: 0.3959 
[Training] 409/503 [=======================&gt;......] - ETA: 28s  loss: 0.1058 
[Training] 410/503 [=======================&gt;......] - ETA: 27s  loss: 0.0766 
[Training] 411/503 [=======================&gt;......] - ETA: 27s  loss: 0.0820 
[Training] 412/503 [=======================&gt;......] - ETA: 27s  loss: 0.0224 
[Training] 413/503 [=======================&gt;......] - ETA: 27s  loss: 0.1935 
[Training] 414/503 [=======================&gt;......] - ETA: 26s  loss: 0.0458 
[Training] 415/503 [=======================&gt;......] - ETA: 26s  loss: 0.1594 
[Training] 416/503 [=======================&gt;......] - ETA: 26s  loss: 0.4012 
[Training] 417/503 [=======================&gt;......] - ETA: 25s  loss: 0.0365 
[Training] 418/503 [=======================&gt;......] - ETA: 25s  loss: 0.3125 
[Training] 419/503 [=======================&gt;......] - ETA: 25s  loss: 0.1092 
[Training] 420/503 [========================&gt;.....] - ETA: 24s  loss: 0.0580 
[Training] 421/503 [========================&gt;.....] - ETA: 24s  loss: 0.1785 
[Training] 422/503 [========================&gt;.....] - ETA: 24s  loss: 0.3384 
[Training] 423/503 [========================&gt;.....] - ETA: 24s  loss: 0.1068 
[Training] 424/503 [========================&gt;.....] - ETA: 23s  loss: 0.2541 
[Training] 425/503 [========================&gt;.....] - ETA: 23s  loss: 0.1249 
[Training] 426/503 [========================&gt;.....] - ETA: 23s  loss: 0.1208 
[Training] 427/503 [========================&gt;.....] - ETA: 22s  loss: 0.0864 
[Training] 428/503 [========================&gt;.....] - ETA: 22s  loss: 0.0791 
[Training] 429/503 [========================&gt;.....] - ETA: 22s  loss: 0.0629 
[Training] 430/503 [========================&gt;.....] - ETA: 21s  loss: 0.0338 
[Training] 431/503 [========================&gt;.....] - ETA: 21s  loss: 0.0353 
[Training] 432/503 [========================&gt;.....] - ETA: 21s  loss: 0.1623 
[Training] 433/503 [========================&gt;.....] - ETA: 21s  loss: 0.0369 
[Training] 434/503 [========================&gt;.....] - ETA: 20s  loss: 0.1328 
[Training] 435/503 [========================&gt;.....] - ETA: 20s  loss: 0.4219 
[Training] 436/503 [=========================&gt;....] - ETA: 20s  loss: 0.0386 
[Training] 437/503 [=========================&gt;....] - ETA: 19s  loss: 0.1483 
[Training] 438/503 [=========================&gt;....] - ETA: 19s  loss: 0.1630 
[Training] 439/503 [=========================&gt;....] - ETA: 19s  loss: 0.1299 
[Training] 440/503 [=========================&gt;....] - ETA: 18s  loss: 0.6709 
[Training] 441/503 [=========================&gt;....] - ETA: 18s  loss: 0.1276 
[Training] 442/503 [=========================&gt;....] - ETA: 18s  loss: 0.2532 
[Training] 443/503 [=========================&gt;....] - ETA: 18s  loss: 0.0265 
[Training] 444/503 [=========================&gt;....] - ETA: 17s  loss: 0.3211 
[Training] 445/503 [=========================&gt;....] - ETA: 17s  loss: 0.8080 
[Training] 446/503 [=========================&gt;....] - ETA: 17s  loss: 0.2050 
[Training] 447/503 [=========================&gt;....] - ETA: 16s  loss: 0.1052 
[Training] 448/503 [=========================&gt;....] - ETA: 16s  loss: 0.4814 
[Training] 449/503 [=========================&gt;....] - ETA: 16s  loss: 0.1073 
[Training] 450/503 [=========================&gt;....] - ETA: 15s  loss: 0.0284 
[Training] 451/503 [=========================&gt;....] - ETA: 15s  loss: 0.3611 
[Training] 452/503 [=========================&gt;....] - ETA: 15s  loss: 0.0601 
[Training] 453/503 [==========================&gt;...] - ETA: 15s  loss: 0.3347 
[Training] 454/503 [==========================&gt;...] - ETA: 14s  loss: 0.2176 
[Training] 455/503 [==========================&gt;...] - ETA: 14s  loss: 0.0931 
[Training] 456/503 [==========================&gt;...] - ETA: 14s  loss: 0.2610 
[Training] 457/503 [==========================&gt;...] - ETA: 13s  loss: 0.1280 
[Training] 458/503 [==========================&gt;...] - ETA: 13s  loss: 0.1932 
[Training] 459/503 [==========================&gt;...] - ETA: 13s  loss: 0.1818 
[Training] 460/503 [==========================&gt;...] - ETA: 12s  loss: 0.1934 
[Training] 461/503 [==========================&gt;...] - ETA: 12s  loss: 0.1723 
[Training] 462/503 [==========================&gt;...] - ETA: 12s  loss: 0.1645 
[Training] 463/503 [==========================&gt;...] - ETA: 12s  loss: 0.6711 
[Training] 464/503 [==========================&gt;...] - ETA: 11s  loss: 0.3930 
[Training] 465/503 [==========================&gt;...] - ETA: 11s  loss: 0.0406 
[Training] 466/503 [==========================&gt;...] - ETA: 11s  loss: 0.0996 
[Training] 467/503 [==========================&gt;...] - ETA: 10s  loss: 0.2026 
[Training] 468/503 [==========================&gt;...] - ETA: 10s  loss: 0.2789 
[Training] 469/503 [==========================&gt;...] - ETA: 10s  loss: 0.3642 
[Training] 470/503 [===========================&gt;..] - ETA: 9s  loss: 0.1053 
[Training] 471/503 [===========================&gt;..] - ETA: 9s  loss: 0.0747 
[Training] 472/503 [===========================&gt;..] - ETA: 9s  loss: 0.0710 
[Training] 473/503 [===========================&gt;..] - ETA: 8s  loss: 0.1338 
[Training] 474/503 [===========================&gt;..] - ETA: 8s  loss: 0.2351 
[Training] 475/503 [===========================&gt;..] - ETA: 8s  loss: 0.2379 
[Training] 476/503 [===========================&gt;..] - ETA: 8s  loss: 0.0485 
[Training] 477/503 [===========================&gt;..] - ETA: 7s  loss: 0.1706 
[Training] 478/503 [===========================&gt;..] - ETA: 7s  loss: 0.1547 
[Training] 479/503 [===========================&gt;..] - ETA: 7s  loss: 0.3406 
[Training] 480/503 [===========================&gt;..] - ETA: 6s  loss: 0.1795 
[Training] 481/503 [===========================&gt;..] - ETA: 6s  loss: 0.2617 
[Training] 482/503 [===========================&gt;..] - ETA: 6s  loss: 0.2256 
[Training] 483/503 [===========================&gt;..] - ETA: 5s  loss: 0.2277 
[Training] 484/503 [===========================&gt;..] - ETA: 5s  loss: 0.4280 
[Training] 485/503 [===========================&gt;..] - ETA: 5s  loss: 0.2303 
[Training] 486/503 [===========================&gt;..] - ETA: 5s  loss: 0.2111 
[Training] 487/503 [============================&gt;.] - ETA: 4s  loss: 0.3887 
[Training] 488/503 [============================&gt;.] - ETA: 4s  loss: 0.2214 
[Training] 489/503 [============================&gt;.] - ETA: 4s  loss: 0.1886 
[Training] 490/503 [============================&gt;.] - ETA: 3s  loss: 0.0740 
[Training] 491/503 [============================&gt;.] - ETA: 3s  loss: 0.0705 
[Training] 492/503 [============================&gt;.] - ETA: 3s  loss: 0.2441 
[Training] 493/503 [============================&gt;.] - ETA: 2s  loss: 0.2080 
[Training] 494/503 [============================&gt;.] - ETA: 2s  loss: 0.2914 
[Training] 495/503 [============================&gt;.] - ETA: 2s  loss: 0.2265 
[Training] 496/503 [============================&gt;.] - ETA: 2s  loss: 0.0992 
[Training] 497/503 [============================&gt;.] - ETA: 1s  loss: 0.1021 
[Training] 498/503 [============================&gt;.] - ETA: 1s  loss: 0.1588 
[Training] 499/503 [============================&gt;.] - ETA: 1s  loss: 0.0902 
[Training] 500/503 [============================&gt;.] - ETA: 0s  loss: 0.2554 
[Training] 501/503 [============================&gt;.] - ETA: 0s  loss: 0.1299 
[Training] 502/503 [============================&gt;.] - ETA: 0s  loss: 0.1078 
[Training] 503/503 [==============================] 298.0ms/step  loss: 0.0575 
[Testing] 1/32 [..............................] - ETA: 9s
[Testing] 2/32 [&gt;.............................] - ETA: 8s
[Testing] 3/32 [=&gt;............................] - ETA: 8s
[Testing] 4/32 [==&gt;...........................] - ETA: 8s
[Testing] 5/32 [===&gt;..........................] - ETA: 8s
[Testing] 6/32 [====&gt;.........................] - ETA: 8s
[Testing] 7/32 [=====&gt;........................] - ETA: 8s
[Testing] 8/32 [======&gt;.......................] - ETA: 8s
[Testing] 9/32 [=======&gt;......................] - ETA: 7s
[Testing] 10/32 [========&gt;.....................] - ETA: 7s
[Testing] 11/32 [=========&gt;....................] - ETA: 7s
[Testing] 12/32 [==========&gt;...................] - ETA: 7s
[Testing] 13/32 [===========&gt;..................] - ETA: 6s
[Testing] 14/32 [============&gt;.................] - ETA: 6s
[Testing] 15/32 [=============&gt;................] - ETA: 6s
[Testing] 16/32 [==============&gt;...............] - ETA: 5s
[Testing] 17/32 [==============&gt;...............] - ETA: 5s
[Testing] 18/32 [===============&gt;..............] - ETA: 5s
[Testing] 19/32 [================&gt;.............] - ETA: 4s
[Testing] 20/32 [=================&gt;............] - ETA: 4s
[Testing] 21/32 [==================&gt;...........] - ETA: 3s
[Testing] 22/32 [===================&gt;..........] - ETA: 3s
[Testing] 23/32 [====================&gt;.........] - ETA: 3s
[Testing] 24/32 [=====================&gt;........] - ETA: 2s
[Testing] 25/32 [======================&gt;.......] - ETA: 2s
[Testing] 26/32 [=======================&gt;......] - ETA: 2s
[Testing] 27/32 [========================&gt;.....] - ETA: 1s
[Testing] 28/32 [=========================&gt;....] - ETA: 1s
[Testing] 29/32 [==========================&gt;...] - ETA: 1s
[Testing] 30/32 [===========================&gt;..] - ETA: 0s
[Testing] 31/32 [============================&gt;.] - ETA: 0s
[Testing] 32/32 [==============================] 359.1ms/step
## Epoch: 3 -  loss: 0.2242 - valid_loss: 0.2920 - valid_acc: 0.8805 - valid_f1: 0.8397 
## 
[Training] 1/503 [..............................] - ETA: 3:00  loss: 0.1737 
[Training] 2/503 [..............................] - ETA: 2:44  loss: 0.1501 
[Training] 3/503 [..............................] - ETA: 2:31  loss: 0.1496 
[Training] 4/503 [..............................] - ETA: 2:36  loss: 0.0589 
[Training] 5/503 [..............................] - ETA: 2:38  loss: 0.4057 
[Training] 6/503 [..............................] - ETA: 2:40  loss: 0.5379 
[Training] 7/503 [..............................] - ETA: 2:40  loss: 0.1318 
[Training] 8/503 [..............................] - ETA: 2:38  loss: 0.0945 
[Training] 9/503 [..............................] - ETA: 2:37  loss: 0.1188 
[Training] 10/503 [..............................] - ETA: 2:37  loss: 0.0506 
[Training] 11/503 [..............................] - ETA: 2:40  loss: 0.2832 
[Training] 12/503 [..............................] - ETA: 2:37  loss: 0.3010 
[Training] 13/503 [..............................] - ETA: 2:36  loss: 0.1452 
[Training] 14/503 [..............................] - ETA: 2:34  loss: 0.2652 
[Training] 15/503 [..............................] - ETA: 2:34  loss: 0.0703 
[Training] 16/503 [..............................] - ETA: 2:34  loss: 0.0281 
[Training] 17/503 [&gt;.............................] - ETA: 2:33  loss: 0.0963 
[Training] 18/503 [&gt;.............................] - ETA: 2:31  loss: 0.0624 
[Training] 19/503 [&gt;.............................] - ETA: 2:31  loss: 0.1463 
[Training] 20/503 [&gt;.............................] - ETA: 2:30  loss: 0.3164 
[Training] 21/503 [&gt;.............................] - ETA: 2:28  loss: 0.0636 
[Training] 22/503 [&gt;.............................] - ETA: 2:28  loss: 0.5525 
[Training] 23/503 [&gt;.............................] - ETA: 2:26  loss: 0.0666 
[Training] 24/503 [&gt;.............................] - ETA: 2:26  loss: 0.1065 
[Training] 25/503 [&gt;.............................] - ETA: 2:25  loss: 0.1165 
[Training] 26/503 [&gt;.............................] - ETA: 2:25  loss: 0.3781 
[Training] 27/503 [&gt;.............................] - ETA: 2:24  loss: 0.2390 
[Training] 28/503 [&gt;.............................] - ETA: 2:23  loss: 0.0495 
[Training] 29/503 [&gt;.............................] - ETA: 2:23  loss: 0.0857 
[Training] 30/503 [&gt;.............................] - ETA: 2:23  loss: 0.0383 
[Training] 31/503 [&gt;.............................] - ETA: 2:23  loss: 0.1081 
[Training] 32/503 [&gt;.............................] - ETA: 2:22  loss: 0.0916 
[Training] 33/503 [&gt;.............................] - ETA: 2:22  loss: 0.1760 
[Training] 34/503 [=&gt;............................] - ETA: 2:21  loss: 0.0457 
[Training] 35/503 [=&gt;............................] - ETA: 2:21  loss: 0.1855 
[Training] 36/503 [=&gt;............................] - ETA: 2:20  loss: 0.1329 
[Training] 37/503 [=&gt;............................] - ETA: 2:20  loss: 0.2168 
[Training] 38/503 [=&gt;............................] - ETA: 2:19  loss: 0.1192 
[Training] 39/503 [=&gt;............................] - ETA: 2:19  loss: 0.3602 
[Training] 40/503 [=&gt;............................] - ETA: 2:18  loss: 0.1001 
[Training] 41/503 [=&gt;............................] - ETA: 2:18  loss: 0.0698 
[Training] 42/503 [=&gt;............................] - ETA: 2:18  loss: 0.3935 
[Training] 43/503 [=&gt;............................] - ETA: 2:17  loss: 0.1044 
[Training] 44/503 [=&gt;............................] - ETA: 2:17  loss: 0.1986 
[Training] 45/503 [=&gt;............................] - ETA: 2:17  loss: 0.0330 
[Training] 46/503 [=&gt;............................] - ETA: 2:16  loss: 0.1404 
[Training] 47/503 [=&gt;............................] - ETA: 2:16  loss: 0.3776 
[Training] 48/503 [=&gt;............................] - ETA: 2:16  loss: 0.1873 
[Training] 49/503 [=&gt;............................] - ETA: 2:16  loss: 0.2908 
[Training] 50/503 [=&gt;............................] - ETA: 2:16  loss: 0.4208 
[Training] 51/503 [==&gt;...........................] - ETA: 2:15  loss: 0.3165 
[Training] 52/503 [==&gt;...........................] - ETA: 2:14  loss: 0.0198 
[Training] 53/503 [==&gt;...........................] - ETA: 2:14  loss: 0.4482 
[Training] 54/503 [==&gt;...........................] - ETA: 2:13  loss: 0.4025 
[Training] 55/503 [==&gt;...........................] - ETA: 2:13  loss: 0.1383 
[Training] 56/503 [==&gt;...........................] - ETA: 2:13  loss: 0.3651 
[Training] 57/503 [==&gt;...........................] - ETA: 2:12  loss: 0.3165 
[Training] 58/503 [==&gt;...........................] - ETA: 2:12  loss: 0.6398 
[Training] 59/503 [==&gt;...........................] - ETA: 2:12  loss: 0.0505 
[Training] 60/503 [==&gt;...........................] - ETA: 2:11  loss: 0.1307 
[Training] 61/503 [==&gt;...........................] - ETA: 2:11  loss: 0.1667 
[Training] 62/503 [==&gt;...........................] - ETA: 2:10  loss: 0.0489 
[Training] 63/503 [==&gt;...........................] - ETA: 2:09  loss: 0.0547 
[Training] 64/503 [==&gt;...........................] - ETA: 2:09  loss: 0.0500 
[Training] 65/503 [==&gt;...........................] - ETA: 2:10  loss: 0.1889 
[Training] 66/503 [==&gt;...........................] - ETA: 2:09  loss: 0.1639 
[Training] 67/503 [==&gt;...........................] - ETA: 2:09  loss: 0.2765 
[Training] 68/503 [===&gt;..........................] - ETA: 2:09  loss: 0.0723 
[Training] 69/503 [===&gt;..........................] - ETA: 2:08  loss: 0.1815 
[Training] 70/503 [===&gt;..........................] - ETA: 2:08  loss: 0.0384 
[Training] 71/503 [===&gt;..........................] - ETA: 2:07  loss: 0.4792 
[Training] 72/503 [===&gt;..........................] - ETA: 2:07  loss: 0.1675 
[Training] 73/503 [===&gt;..........................] - ETA: 2:06  loss: 0.0954 
[Training] 74/503 [===&gt;..........................] - ETA: 2:06  loss: 0.3132 
[Training] 75/503 [===&gt;..........................] - ETA: 2:05  loss: 0.0975 
[Training] 76/503 [===&gt;..........................] - ETA: 2:05  loss: 0.0955 
[Training] 77/503 [===&gt;..........................] - ETA: 2:05  loss: 0.1924 
[Training] 78/503 [===&gt;..........................] - ETA: 2:05  loss: 0.2490 
[Training] 79/503 [===&gt;..........................] - ETA: 2:04  loss: 0.5344 
[Training] 80/503 [===&gt;..........................] - ETA: 2:04  loss: 0.1212 
[Training] 81/503 [===&gt;..........................] - ETA: 2:04  loss: 0.2383 
[Training] 82/503 [===&gt;..........................] - ETA: 2:03  loss: 0.4447 
[Training] 83/503 [===&gt;..........................] - ETA: 2:03  loss: 0.2915 
[Training] 84/503 [====&gt;.........................] - ETA: 2:03  loss: 0.0413 
[Training] 85/503 [====&gt;.........................] - ETA: 2:02  loss: 0.0997 
[Training] 86/503 [====&gt;.........................] - ETA: 2:02  loss: 0.2267 
[Training] 87/503 [====&gt;.........................] - ETA: 2:02  loss: 0.2444 
[Training] 88/503 [====&gt;.........................] - ETA: 2:02  loss: 0.3051 
[Training] 89/503 [====&gt;.........................] - ETA: 2:01  loss: 0.1599 
[Training] 90/503 [====&gt;.........................] - ETA: 2:01  loss: 0.2905 
[Training] 91/503 [====&gt;.........................] - ETA: 2:01  loss: 0.2073 
[Training] 92/503 [====&gt;.........................] - ETA: 2:00  loss: 0.1259 
[Training] 93/503 [====&gt;.........................] - ETA: 2:00  loss: 0.2521 
[Training] 94/503 [====&gt;.........................] - ETA: 1:59  loss: 0.2089 
[Training] 95/503 [====&gt;.........................] - ETA: 1:59  loss: 0.2474 
[Training] 96/503 [====&gt;.........................] - ETA: 1:58  loss: 0.0491 
[Training] 97/503 [====&gt;.........................] - ETA: 1:58  loss: 0.1272 
[Training] 98/503 [====&gt;.........................] - ETA: 1:58  loss: 0.1423 
[Training] 99/503 [====&gt;.........................] - ETA: 1:57  loss: 0.1673 
[Training] 100/503 [====&gt;.........................] - ETA: 1:57  loss: 0.3789 
[Training] 101/503 [=====&gt;........................] - ETA: 1:57  loss: 0.2827 
[Training] 102/503 [=====&gt;........................] - ETA: 1:56  loss: 0.4632 
[Training] 103/503 [=====&gt;........................] - ETA: 1:56  loss: 0.2860 
[Training] 104/503 [=====&gt;........................] - ETA: 1:56  loss: 0.1678 
[Training] 105/503 [=====&gt;........................] - ETA: 1:55  loss: 0.1322 
[Training] 106/503 [=====&gt;........................] - ETA: 1:55  loss: 0.0961 
[Training] 107/503 [=====&gt;........................] - ETA: 1:54  loss: 0.0907 
[Training] 108/503 [=====&gt;........................] - ETA: 1:54  loss: 0.1305 
[Training] 109/503 [=====&gt;........................] - ETA: 1:54  loss: 0.2309 
[Training] 110/503 [=====&gt;........................] - ETA: 1:53  loss: 0.2453 
[Training] 111/503 [=====&gt;........................] - ETA: 1:53  loss: 0.1793 
[Training] 112/503 [=====&gt;........................] - ETA: 1:53  loss: 0.0329 
[Training] 113/503 [=====&gt;........................] - ETA: 1:52  loss: 0.0790 
[Training] 114/503 [=====&gt;........................] - ETA: 1:52  loss: 0.0858 
[Training] 115/503 [=====&gt;........................] - ETA: 1:51  loss: 0.2096 
[Training] 116/503 [=====&gt;........................] - ETA: 1:52  loss: 0.1056 
[Training] 117/503 [=====&gt;........................] - ETA: 1:51  loss: 0.1607 
[Training] 118/503 [======&gt;.......................] - ETA: 1:51  loss: 0.2793 
[Training] 119/503 [======&gt;.......................] - ETA: 1:51  loss: 0.0746 
[Training] 120/503 [======&gt;.......................] - ETA: 1:50  loss: 0.2498 
[Training] 121/503 [======&gt;.......................] - ETA: 1:50  loss: 0.0774 
[Training] 122/503 [======&gt;.......................] - ETA: 1:50  loss: 0.1661 
[Training] 123/503 [======&gt;.......................] - ETA: 1:50  loss: 0.0688 
[Training] 124/503 [======&gt;.......................] - ETA: 1:49  loss: 0.0370 
[Training] 125/503 [======&gt;.......................] - ETA: 1:49  loss: 0.1541 
[Training] 126/503 [======&gt;.......................] - ETA: 1:49  loss: 0.0696 
[Training] 127/503 [======&gt;.......................] - ETA: 1:48  loss: 0.1762 
[Training] 128/503 [======&gt;.......................] - ETA: 1:48  loss: 0.2241 
[Training] 129/503 [======&gt;.......................] - ETA: 1:48  loss: 0.1361 
[Training] 130/503 [======&gt;.......................] - ETA: 1:47  loss: 0.0834 
[Training] 131/503 [======&gt;.......................] - ETA: 1:47  loss: 0.1705 
[Training] 132/503 [======&gt;.......................] - ETA: 1:47  loss: 0.0679 
[Training] 133/503 [======&gt;.......................] - ETA: 1:46  loss: 0.0923 
[Training] 134/503 [======&gt;.......................] - ETA: 1:46  loss: 0.0465 
[Training] 135/503 [=======&gt;......................] - ETA: 1:46  loss: 0.0969 
[Training] 136/503 [=======&gt;......................] - ETA: 1:46  loss: 0.3599 
[Training] 137/503 [=======&gt;......................] - ETA: 1:46  loss: 0.1989 
[Training] 138/503 [=======&gt;......................] - ETA: 1:45  loss: 0.3610 
[Training] 139/503 [=======&gt;......................] - ETA: 1:45  loss: 0.1400 
[Training] 140/503 [=======&gt;......................] - ETA: 1:44  loss: 0.1369 
[Training] 141/503 [=======&gt;......................] - ETA: 1:44  loss: 0.5506 
[Training] 142/503 [=======&gt;......................] - ETA: 1:44  loss: 0.1465 
[Training] 143/503 [=======&gt;......................] - ETA: 1:44  loss: 0.0523 
[Training] 144/503 [=======&gt;......................] - ETA: 1:43  loss: 0.1892 
[Training] 145/503 [=======&gt;......................] - ETA: 1:43  loss: 0.3254 
[Training] 146/503 [=======&gt;......................] - ETA: 1:43  loss: 0.0536 
[Training] 147/503 [=======&gt;......................] - ETA: 1:42  loss: 0.1677 
[Training] 148/503 [=======&gt;......................] - ETA: 1:42  loss: 0.1520 
[Training] 149/503 [=======&gt;......................] - ETA: 1:42  loss: 0.4134 
[Training] 150/503 [=======&gt;......................] - ETA: 1:41  loss: 0.3164 
[Training] 151/503 [========&gt;.....................] - ETA: 1:41  loss: 0.1031 
[Training] 152/503 [========&gt;.....................] - ETA: 1:41  loss: 0.1004 
[Training] 153/503 [========&gt;.....................] - ETA: 1:41  loss: 0.0816 
[Training] 154/503 [========&gt;.....................] - ETA: 1:41  loss: 0.0752 
[Training] 155/503 [========&gt;.....................] - ETA: 1:40  loss: 0.1396 
[Training] 156/503 [========&gt;.....................] - ETA: 1:40  loss: 0.2961 
[Training] 157/503 [========&gt;.....................] - ETA: 1:40  loss: 0.1471 
[Training] 158/503 [========&gt;.....................] - ETA: 1:40  loss: 0.2317 
[Training] 159/503 [========&gt;.....................] - ETA: 1:40  loss: 0.1841 
[Training] 160/503 [========&gt;.....................] - ETA: 1:39  loss: 0.1051 
[Training] 161/503 [========&gt;.....................] - ETA: 1:39  loss: 0.0330 
[Training] 162/503 [========&gt;.....................] - ETA: 1:39  loss: 0.2549 
[Training] 163/503 [========&gt;.....................] - ETA: 1:39  loss: 0.1180 
[Training] 164/503 [========&gt;.....................] - ETA: 1:38  loss: 0.1885 
[Training] 165/503 [========&gt;.....................] - ETA: 1:38  loss: 0.2743 
[Training] 166/503 [========&gt;.....................] - ETA: 1:37  loss: 0.0607 
[Training] 167/503 [========&gt;.....................] - ETA: 1:37  loss: 0.1274 
[Training] 168/503 [=========&gt;....................] - ETA: 1:37  loss: 0.1762 
[Training] 169/503 [=========&gt;....................] - ETA: 1:37  loss: 0.1530 
[Training] 170/503 [=========&gt;....................] - ETA: 1:36  loss: 0.0758 
[Training] 171/503 [=========&gt;....................] - ETA: 1:36  loss: 0.1248 
[Training] 172/503 [=========&gt;....................] - ETA: 1:36  loss: 0.0358 
[Training] 173/503 [=========&gt;....................] - ETA: 1:35  loss: 0.0636 
[Training] 174/503 [=========&gt;....................] - ETA: 1:35  loss: 0.0402 
[Training] 175/503 [=========&gt;....................] - ETA: 1:35  loss: 0.0535 
[Training] 176/503 [=========&gt;....................] - ETA: 1:34  loss: 0.1047 
[Training] 177/503 [=========&gt;....................] - ETA: 1:34  loss: 0.2929 
[Training] 178/503 [=========&gt;....................] - ETA: 1:34  loss: 0.0343 
[Training] 179/503 [=========&gt;....................] - ETA: 1:33  loss: 0.4644 
[Training] 180/503 [=========&gt;....................] - ETA: 1:33  loss: 0.3268 
[Training] 181/503 [=========&gt;....................] - ETA: 1:33  loss: 0.3761 
[Training] 182/503 [=========&gt;....................] - ETA: 1:32  loss: 0.0905 
[Training] 183/503 [=========&gt;....................] - ETA: 1:32  loss: 0.2883 
[Training] 184/503 [=========&gt;....................] - ETA: 1:32  loss: 0.3342 
[Training] 185/503 [==========&gt;...................] - ETA: 1:31  loss: 0.2480 
[Training] 186/503 [==========&gt;...................] - ETA: 1:31  loss: 0.4359 
[Training] 187/503 [==========&gt;...................] - ETA: 1:31  loss: 0.3144 
[Training] 188/503 [==========&gt;...................] - ETA: 1:31  loss: 0.0247 
[Training] 189/503 [==========&gt;...................] - ETA: 1:30  loss: 0.1932 
[Training] 190/503 [==========&gt;...................] - ETA: 1:30  loss: 0.1768 
[Training] 191/503 [==========&gt;...................] - ETA: 1:30  loss: 0.0428 
[Training] 192/503 [==========&gt;...................] - ETA: 1:29  loss: 0.3970 
[Training] 193/503 [==========&gt;...................] - ETA: 1:29  loss: 0.0883 
[Training] 194/503 [==========&gt;...................] - ETA: 1:29  loss: 0.1624 
[Training] 195/503 [==========&gt;...................] - ETA: 1:28  loss: 0.1007 
[Training] 196/503 [==========&gt;...................] - ETA: 1:28  loss: 0.5560 
[Training] 197/503 [==========&gt;...................] - ETA: 1:28  loss: 0.1714 
[Training] 198/503 [==========&gt;...................] - ETA: 1:28  loss: 0.3952 
[Training] 199/503 [==========&gt;...................] - ETA: 1:27  loss: 0.1862 
[Training] 200/503 [==========&gt;...................] - ETA: 1:27  loss: 0.2082 
[Training] 201/503 [==========&gt;...................] - ETA: 1:27  loss: 0.0420 
[Training] 202/503 [===========&gt;..................] - ETA: 1:26  loss: 0.0394 
[Training] 203/503 [===========&gt;..................] - ETA: 1:26  loss: 0.2554 
[Training] 204/503 [===========&gt;..................] - ETA: 1:26  loss: 0.2033 
[Training] 205/503 [===========&gt;..................] - ETA: 1:25  loss: 0.0344 
[Training] 206/503 [===========&gt;..................] - ETA: 1:25  loss: 0.1275 
[Training] 207/503 [===========&gt;..................] - ETA: 1:25  loss: 0.0580 
[Training] 208/503 [===========&gt;..................] - ETA: 1:24  loss: 0.0416 
[Training] 209/503 [===========&gt;..................] - ETA: 1:24  loss: 0.2683 
[Training] 210/503 [===========&gt;..................] - ETA: 1:24  loss: 0.2278 
[Training] 211/503 [===========&gt;..................] - ETA: 1:24  loss: 0.0892 
[Training] 212/503 [===========&gt;..................] - ETA: 1:23  loss: 0.0653 
[Training] 213/503 [===========&gt;..................] - ETA: 1:23  loss: 0.0919 
[Training] 214/503 [===========&gt;..................] - ETA: 1:23  loss: 0.3578 
[Training] 215/503 [===========&gt;..................] - ETA: 1:22  loss: 0.2170 
[Training] 216/503 [===========&gt;..................] - ETA: 1:22  loss: 0.2079 
[Training] 217/503 [===========&gt;..................] - ETA: 1:22  loss: 0.1580 
[Training] 218/503 [============&gt;.................] - ETA: 1:21  loss: 0.0430 
[Training] 219/503 [============&gt;.................] - ETA: 1:21  loss: 0.1503 
[Training] 220/503 [============&gt;.................] - ETA: 1:21  loss: 0.1964 
[Training] 221/503 [============&gt;.................] - ETA: 1:21  loss: 0.0538 
[Training] 222/503 [============&gt;.................] - ETA: 1:20  loss: 0.3189 
[Training] 223/503 [============&gt;.................] - ETA: 1:20  loss: 0.0269 
[Training] 224/503 [============&gt;.................] - ETA: 1:20  loss: 0.2116 
[Training] 225/503 [============&gt;.................] - ETA: 1:19  loss: 0.1120 
[Training] 226/503 [============&gt;.................] - ETA: 1:19  loss: 0.0703 
[Training] 227/503 [============&gt;.................] - ETA: 1:19  loss: 0.2986 
[Training] 228/503 [============&gt;.................] - ETA: 1:19  loss: 0.1357 
[Training] 229/503 [============&gt;.................] - ETA: 1:18  loss: 0.0837 
[Training] 230/503 [============&gt;.................] - ETA: 1:18  loss: 0.1242 
[Training] 231/503 [============&gt;.................] - ETA: 1:18  loss: 0.2522 
[Training] 232/503 [============&gt;.................] - ETA: 1:18  loss: 0.0663 
[Training] 233/503 [============&gt;.................] - ETA: 1:17  loss: 0.4880 
[Training] 234/503 [============&gt;.................] - ETA: 1:17  loss: 0.1409 
[Training] 235/503 [=============&gt;................] - ETA: 1:17  loss: 0.2150 
[Training] 236/503 [=============&gt;................] - ETA: 1:16  loss: 0.2508 
[Training] 237/503 [=============&gt;................] - ETA: 1:16  loss: 0.1126 
[Training] 238/503 [=============&gt;................] - ETA: 1:16  loss: 0.0917 
[Training] 239/503 [=============&gt;................] - ETA: 1:16  loss: 0.1129 
[Training] 240/503 [=============&gt;................] - ETA: 1:15  loss: 0.1357 
[Training] 241/503 [=============&gt;................] - ETA: 1:15  loss: 0.2389 
[Training] 242/503 [=============&gt;................] - ETA: 1:15  loss: 0.2670 
[Training] 243/503 [=============&gt;................] - ETA: 1:14  loss: 0.0469 
[Training] 244/503 [=============&gt;................] - ETA: 1:14  loss: 0.1477 
[Training] 245/503 [=============&gt;................] - ETA: 1:14  loss: 0.0438 
[Training] 246/503 [=============&gt;................] - ETA: 1:14  loss: 0.0874 
[Training] 247/503 [=============&gt;................] - ETA: 1:13  loss: 0.1784 
[Training] 248/503 [=============&gt;................] - ETA: 1:13  loss: 0.0764 
[Training] 249/503 [=============&gt;................] - ETA: 1:13  loss: 0.3284 
[Training] 250/503 [=============&gt;................] - ETA: 1:13  loss: 0.3343 
[Training] 251/503 [=============&gt;................] - ETA: 1:12  loss: 0.0869 
[Training] 252/503 [==============&gt;...............] - ETA: 1:12  loss: 0.2391 
[Training] 253/503 [==============&gt;...............] - ETA: 1:12  loss: 0.2581 
[Training] 254/503 [==============&gt;...............] - ETA: 1:11  loss: 0.4271 
[Training] 255/503 [==============&gt;...............] - ETA: 1:11  loss: 0.1846 
[Training] 256/503 [==============&gt;...............] - ETA: 1:11  loss: 0.0972 
[Training] 257/503 [==============&gt;...............] - ETA: 1:10  loss: 0.1405 
[Training] 258/503 [==============&gt;...............] - ETA: 1:10  loss: 0.0647 
[Training] 259/503 [==============&gt;...............] - ETA: 1:10  loss: 0.1373 
[Training] 260/503 [==============&gt;...............] - ETA: 1:09  loss: 0.1625 
[Training] 261/503 [==============&gt;...............] - ETA: 1:09  loss: 0.2071 
[Training] 262/503 [==============&gt;...............] - ETA: 1:09  loss: 0.0640 
[Training] 263/503 [==============&gt;...............] - ETA: 1:09  loss: 0.1532 
[Training] 264/503 [==============&gt;...............] - ETA: 1:08  loss: 0.2895 
[Training] 265/503 [==============&gt;...............] - ETA: 1:08  loss: 0.0941 
[Training] 266/503 [==============&gt;...............] - ETA: 1:08  loss: 0.1164 
[Training] 267/503 [==============&gt;...............] - ETA: 1:07  loss: 0.0981 
[Training] 268/503 [==============&gt;...............] - ETA: 1:07  loss: 0.1992 
[Training] 269/503 [===============&gt;..............] - ETA: 1:07  loss: 0.3149 
[Training] 270/503 [===============&gt;..............] - ETA: 1:06  loss: 0.0657 
[Training] 271/503 [===============&gt;..............] - ETA: 1:06  loss: 0.1349 
[Training] 272/503 [===============&gt;..............] - ETA: 1:06  loss: 0.1011 
[Training] 273/503 [===============&gt;..............] - ETA: 1:06  loss: 0.2348 
[Training] 274/503 [===============&gt;..............] - ETA: 1:05  loss: 0.1230 
[Training] 275/503 [===============&gt;..............] - ETA: 1:05  loss: 0.0625 
[Training] 276/503 [===============&gt;..............] - ETA: 1:05  loss: 0.1118 
[Training] 277/503 [===============&gt;..............] - ETA: 1:05  loss: 0.1234 
[Training] 278/503 [===============&gt;..............] - ETA: 1:04  loss: 0.1079 
[Training] 279/503 [===============&gt;..............] - ETA: 1:04  loss: 0.5338 
[Training] 280/503 [===============&gt;..............] - ETA: 1:04  loss: 0.1427 
[Training] 281/503 [===============&gt;..............] - ETA: 1:04  loss: 0.3034 
[Training] 282/503 [===============&gt;..............] - ETA: 1:03  loss: 0.0722 
[Training] 283/503 [===============&gt;..............] - ETA: 1:03  loss: 0.0305 
[Training] 284/503 [===============&gt;..............] - ETA: 1:03  loss: 0.0712 
[Training] 285/503 [===============&gt;..............] - ETA: 1:02  loss: 0.0285 
[Training] 286/503 [================&gt;.............] - ETA: 1:02  loss: 0.2055 
[Training] 287/503 [================&gt;.............] - ETA: 1:02  loss: 0.0574 
[Training] 288/503 [================&gt;.............] - ETA: 1:02  loss: 0.3790 
[Training] 289/503 [================&gt;.............] - ETA: 1:01  loss: 0.0778 
[Training] 290/503 [================&gt;.............] - ETA: 1:01  loss: 0.2015 
[Training] 291/503 [================&gt;.............] - ETA: 1:01  loss: 0.1467 
[Training] 292/503 [================&gt;.............] - ETA: 1:00  loss: 0.4559 
[Training] 293/503 [================&gt;.............] - ETA: 1:00  loss: 0.5261 
[Training] 294/503 [================&gt;.............] - ETA: 1:00  loss: 0.0489 
[Training] 295/503 [================&gt;.............] - ETA: 1:00  loss: 0.4290 
[Training] 296/503 [================&gt;.............] - ETA: 59s  loss: 0.1193 
[Training] 297/503 [================&gt;.............] - ETA: 59s  loss: 0.2352 
[Training] 298/503 [================&gt;.............] - ETA: 59s  loss: 0.1441 
[Training] 299/503 [================&gt;.............] - ETA: 58s  loss: 0.0768 
[Training] 300/503 [================&gt;.............] - ETA: 58s  loss: 0.0737 
[Training] 301/503 [================&gt;.............] - ETA: 58s  loss: 0.1827 
[Training] 302/503 [=================&gt;............] - ETA: 58s  loss: 0.1652 
[Training] 303/503 [=================&gt;............] - ETA: 57s  loss: 0.2069 
[Training] 304/503 [=================&gt;............] - ETA: 57s  loss: 0.2034 
[Training] 305/503 [=================&gt;............] - ETA: 57s  loss: 0.1178 
[Training] 306/503 [=================&gt;............] - ETA: 56s  loss: 0.1201 
[Training] 307/503 [=================&gt;............] - ETA: 56s  loss: 0.2508 
[Training] 308/503 [=================&gt;............] - ETA: 56s  loss: 0.2367 
[Training] 309/503 [=================&gt;............] - ETA: 56s  loss: 0.2056 
[Training] 310/503 [=================&gt;............] - ETA: 55s  loss: 0.2709 
[Training] 311/503 [=================&gt;............] - ETA: 55s  loss: 0.2894 
[Training] 312/503 [=================&gt;............] - ETA: 55s  loss: 0.2284 
[Training] 313/503 [=================&gt;............] - ETA: 54s  loss: 0.1720 
[Training] 314/503 [=================&gt;............] - ETA: 54s  loss: 0.0867 
[Training] 315/503 [=================&gt;............] - ETA: 54s  loss: 0.0645 
[Training] 316/503 [=================&gt;............] - ETA: 53s  loss: 0.0638 
[Training] 317/503 [=================&gt;............] - ETA: 53s  loss: 0.2217 
[Training] 318/503 [=================&gt;............] - ETA: 53s  loss: 0.1686 
[Training] 319/503 [==================&gt;...........] - ETA: 53s  loss: 0.4133 
[Training] 320/503 [==================&gt;...........] - ETA: 52s  loss: 0.2427 
[Training] 321/503 [==================&gt;...........] - ETA: 52s  loss: 0.2538 
[Training] 322/503 [==================&gt;...........] - ETA: 52s  loss: 0.1082 
[Training] 323/503 [==================&gt;...........] - ETA: 51s  loss: 0.0622 
[Training] 324/503 [==================&gt;...........] - ETA: 51s  loss: 0.2077 
[Training] 325/503 [==================&gt;...........] - ETA: 51s  loss: 0.1185 
[Training] 326/503 [==================&gt;...........] - ETA: 51s  loss: 0.0415 
[Training] 327/503 [==================&gt;...........] - ETA: 50s  loss: 0.1789 
[Training] 328/503 [==================&gt;...........] - ETA: 50s  loss: 0.1639 
[Training] 329/503 [==================&gt;...........] - ETA: 50s  loss: 0.1215 
[Training] 330/503 [==================&gt;...........] - ETA: 49s  loss: 0.2066 
[Training] 331/503 [==================&gt;...........] - ETA: 49s  loss: 0.0680 
[Training] 332/503 [==================&gt;...........] - ETA: 49s  loss: 0.4594 
[Training] 333/503 [==================&gt;...........] - ETA: 49s  loss: 0.2148 
[Training] 334/503 [==================&gt;...........] - ETA: 48s  loss: 0.0848 
[Training] 335/503 [==================&gt;...........] - ETA: 48s  loss: 0.1689 
[Training] 336/503 [===================&gt;..........] - ETA: 48s  loss: 0.1925 
[Training] 337/503 [===================&gt;..........] - ETA: 47s  loss: 0.0434 
[Training] 338/503 [===================&gt;..........] - ETA: 47s  loss: 0.1868 
[Training] 339/503 [===================&gt;..........] - ETA: 47s  loss: 0.1126 
[Training] 340/503 [===================&gt;..........] - ETA: 47s  loss: 0.1495 
[Training] 341/503 [===================&gt;..........] - ETA: 46s  loss: 0.4567 
[Training] 342/503 [===================&gt;..........] - ETA: 46s  loss: 0.0843 
[Training] 343/503 [===================&gt;..........] - ETA: 46s  loss: 0.2099 
[Training] 344/503 [===================&gt;..........] - ETA: 45s  loss: 0.1120 
[Training] 345/503 [===================&gt;..........] - ETA: 45s  loss: 0.0726 
[Training] 346/503 [===================&gt;..........] - ETA: 45s  loss: 0.2569 
[Training] 347/503 [===================&gt;..........] - ETA: 44s  loss: 0.0964 
[Training] 348/503 [===================&gt;..........] - ETA: 44s  loss: 0.0547 
[Training] 349/503 [===================&gt;..........] - ETA: 44s  loss: 0.4181 
[Training] 350/503 [===================&gt;..........] - ETA: 44s  loss: 0.0784 
[Training] 351/503 [===================&gt;..........] - ETA: 43s  loss: 0.0397 
[Training] 352/503 [===================&gt;..........] - ETA: 43s  loss: 0.1432 
[Training] 353/503 [====================&gt;.........] - ETA: 43s  loss: 0.1983 
[Training] 354/503 [====================&gt;.........] - ETA: 42s  loss: 0.1589 
[Training] 355/503 [====================&gt;.........] - ETA: 42s  loss: 0.0499 
[Training] 356/503 [====================&gt;.........] - ETA: 42s  loss: 0.2542 
[Training] 357/503 [====================&gt;.........] - ETA: 42s  loss: 0.1489 
[Training] 358/503 [====================&gt;.........] - ETA: 41s  loss: 0.3415 
[Training] 359/503 [====================&gt;.........] - ETA: 41s  loss: 0.0449 
[Training] 360/503 [====================&gt;.........] - ETA: 41s  loss: 0.0676 
[Training] 361/503 [====================&gt;.........] - ETA: 40s  loss: 0.0697 
[Training] 362/503 [====================&gt;.........] - ETA: 40s  loss: 0.3476 
[Training] 363/503 [====================&gt;.........] - ETA: 40s  loss: 0.2209 
[Training] 364/503 [====================&gt;.........] - ETA: 40s  loss: 0.3716 
[Training] 365/503 [====================&gt;.........] - ETA: 39s  loss: 0.0753 
[Training] 366/503 [====================&gt;.........] - ETA: 39s  loss: 0.2742 
[Training] 367/503 [====================&gt;.........] - ETA: 39s  loss: 0.0580 
[Training] 368/503 [====================&gt;.........] - ETA: 38s  loss: 0.3195 
[Training] 369/503 [=====================&gt;........] - ETA: 38s  loss: 0.1099 
[Training] 370/503 [=====================&gt;........] - ETA: 38s  loss: 0.1092 
[Training] 371/503 [=====================&gt;........] - ETA: 38s  loss: 0.0685 
[Training] 372/503 [=====================&gt;........] - ETA: 37s  loss: 0.2898 
[Training] 373/503 [=====================&gt;........] - ETA: 37s  loss: 0.1203 
[Training] 374/503 [=====================&gt;........] - ETA: 37s  loss: 0.1143 
[Training] 375/503 [=====================&gt;........] - ETA: 37s  loss: 0.0340 
[Training] 376/503 [=====================&gt;........] - ETA: 36s  loss: 0.0641 
[Training] 377/503 [=====================&gt;........] - ETA: 36s  loss: 0.2186 
[Training] 378/503 [=====================&gt;........] - ETA: 36s  loss: 0.0650 
[Training] 379/503 [=====================&gt;........] - ETA: 35s  loss: 0.4364 
[Training] 380/503 [=====================&gt;........] - ETA: 35s  loss: 0.0919 
[Training] 381/503 [=====================&gt;........] - ETA: 35s  loss: 0.4438 
[Training] 382/503 [=====================&gt;........] - ETA: 35s  loss: 0.2440 
[Training] 383/503 [=====================&gt;........] - ETA: 34s  loss: 0.0453 
[Training] 384/503 [=====================&gt;........] - ETA: 34s  loss: 0.3242 
[Training] 385/503 [=====================&gt;........] - ETA: 34s  loss: 0.1340 
[Training] 386/503 [======================&gt;.......] - ETA: 33s  loss: 0.3730 
[Training] 387/503 [======================&gt;.......] - ETA: 33s  loss: 0.2324 
[Training] 388/503 [======================&gt;.......] - ETA: 33s  loss: 0.1002 
[Training] 389/503 [======================&gt;.......] - ETA: 33s  loss: 0.0924 
[Training] 390/503 [======================&gt;.......] - ETA: 32s  loss: 0.1965 
[Training] 391/503 [======================&gt;.......] - ETA: 32s  loss: 0.2222 
[Training] 392/503 [======================&gt;.......] - ETA: 32s  loss: 0.1086 
[Training] 393/503 [======================&gt;.......] - ETA: 31s  loss: 0.0541 
[Training] 394/503 [======================&gt;.......] - ETA: 31s  loss: 0.0501 
[Training] 395/503 [======================&gt;.......] - ETA: 31s  loss: 0.1628 
[Training] 396/503 [======================&gt;.......] - ETA: 30s  loss: 0.0917 
[Training] 397/503 [======================&gt;.......] - ETA: 30s  loss: 0.4271 
[Training] 398/503 [======================&gt;.......] - ETA: 30s  loss: 0.0349 
[Training] 399/503 [======================&gt;.......] - ETA: 30s  loss: 0.1356 
[Training] 400/503 [======================&gt;.......] - ETA: 29s  loss: 0.1959 
[Training] 401/503 [======================&gt;.......] - ETA: 29s  loss: 0.0637 
[Training] 402/503 [======================&gt;.......] - ETA: 29s  loss: 0.1719 
[Training] 403/503 [=======================&gt;......] - ETA: 28s  loss: 0.0922 
[Training] 404/503 [=======================&gt;......] - ETA: 28s  loss: 0.3842 
[Training] 405/503 [=======================&gt;......] - ETA: 28s  loss: 0.0526 
[Training] 406/503 [=======================&gt;......] - ETA: 28s  loss: 0.1281 
[Training] 407/503 [=======================&gt;......] - ETA: 27s  loss: 0.3210 
[Training] 408/503 [=======================&gt;......] - ETA: 27s  loss: 0.0794 
[Training] 409/503 [=======================&gt;......] - ETA: 27s  loss: 0.1281 
[Training] 410/503 [=======================&gt;......] - ETA: 26s  loss: 0.3681 
[Training] 411/503 [=======================&gt;......] - ETA: 26s  loss: 0.1701 
[Training] 412/503 [=======================&gt;......] - ETA: 26s  loss: 0.1442 
[Training] 413/503 [=======================&gt;......] - ETA: 26s  loss: 0.0275 
[Training] 414/503 [=======================&gt;......] - ETA: 25s  loss: 0.0867 
[Training] 415/503 [=======================&gt;......] - ETA: 25s  loss: 0.2541 
[Training] 416/503 [=======================&gt;......] - ETA: 25s  loss: 0.0904 
[Training] 417/503 [=======================&gt;......] - ETA: 24s  loss: 0.2730 
[Training] 418/503 [=======================&gt;......] - ETA: 24s  loss: 0.3000 
[Training] 419/503 [=======================&gt;......] - ETA: 24s  loss: 0.0894 
[Training] 420/503 [========================&gt;.....] - ETA: 23s  loss: 0.0990 
[Training] 421/503 [========================&gt;.....] - ETA: 23s  loss: 0.1726 
[Training] 422/503 [========================&gt;.....] - ETA: 23s  loss: 0.1333 
[Training] 423/503 [========================&gt;.....] - ETA: 23s  loss: 0.3955 
[Training] 424/503 [========================&gt;.....] - ETA: 22s  loss: 0.2877 
[Training] 425/503 [========================&gt;.....] - ETA: 22s  loss: 0.0523 
[Training] 426/503 [========================&gt;.....] - ETA: 22s  loss: 0.1578 
[Training] 427/503 [========================&gt;.....] - ETA: 21s  loss: 0.1500 
[Training] 428/503 [========================&gt;.....] - ETA: 21s  loss: 0.2422 
[Training] 429/503 [========================&gt;.....] - ETA: 21s  loss: 0.2024 
[Training] 430/503 [========================&gt;.....] - ETA: 21s  loss: 0.1732 
[Training] 431/503 [========================&gt;.....] - ETA: 20s  loss: 0.1754 
[Training] 432/503 [========================&gt;.....] - ETA: 20s  loss: 0.2878 
[Training] 433/503 [========================&gt;.....] - ETA: 20s  loss: 0.0477 
[Training] 434/503 [========================&gt;.....] - ETA: 19s  loss: 0.2404 
[Training] 435/503 [========================&gt;.....] - ETA: 19s  loss: 0.1573 
[Training] 436/503 [=========================&gt;....] - ETA: 19s  loss: 0.2188 
[Training] 437/503 [=========================&gt;....] - ETA: 19s  loss: 0.0600 
[Training] 438/503 [=========================&gt;....] - ETA: 18s  loss: 0.3234 
[Training] 439/503 [=========================&gt;....] - ETA: 18s  loss: 0.0517 
[Training] 440/503 [=========================&gt;....] - ETA: 18s  loss: 0.2301 
[Training] 441/503 [=========================&gt;....] - ETA: 17s  loss: 0.1092 
[Training] 442/503 [=========================&gt;....] - ETA: 17s  loss: 0.0612 
[Training] 443/503 [=========================&gt;....] - ETA: 17s  loss: 0.0163 
[Training] 444/503 [=========================&gt;....] - ETA: 17s  loss: 0.1377 
[Training] 445/503 [=========================&gt;....] - ETA: 16s  loss: 0.2050 
[Training] 446/503 [=========================&gt;....] - ETA: 16s  loss: 0.1427 
[Training] 447/503 [=========================&gt;....] - ETA: 16s  loss: 0.1754 
[Training] 448/503 [=========================&gt;....] - ETA: 15s  loss: 0.0847 
[Training] 449/503 [=========================&gt;....] - ETA: 15s  loss: 0.2362 
[Training] 450/503 [=========================&gt;....] - ETA: 15s  loss: 0.0944 
[Training] 451/503 [=========================&gt;....] - ETA: 15s  loss: 0.0739 
[Training] 452/503 [=========================&gt;....] - ETA: 14s  loss: 0.2067 
[Training] 453/503 [==========================&gt;...] - ETA: 14s  loss: 0.0893 
[Training] 454/503 [==========================&gt;...] - ETA: 14s  loss: 0.0968 
[Training] 455/503 [==========================&gt;...] - ETA: 13s  loss: 0.2256 
[Training] 456/503 [==========================&gt;...] - ETA: 13s  loss: 0.0584 
[Training] 457/503 [==========================&gt;...] - ETA: 13s  loss: 0.2924 
[Training] 458/503 [==========================&gt;...] - ETA: 12s  loss: 0.2437 
[Training] 459/503 [==========================&gt;...] - ETA: 12s  loss: 0.0434 
[Training] 460/503 [==========================&gt;...] - ETA: 12s  loss: 0.0689 
[Training] 461/503 [==========================&gt;...] - ETA: 12s  loss: 0.2823 
[Training] 462/503 [==========================&gt;...] - ETA: 11s  loss: 0.0689 
[Training] 463/503 [==========================&gt;...] - ETA: 11s  loss: 0.1095 
[Training] 464/503 [==========================&gt;...] - ETA: 11s  loss: 0.1372 
[Training] 465/503 [==========================&gt;...] - ETA: 10s  loss: 0.2789 
[Training] 466/503 [==========================&gt;...] - ETA: 10s  loss: 0.1373 
[Training] 467/503 [==========================&gt;...] - ETA: 10s  loss: 0.0427 
[Training] 468/503 [==========================&gt;...] - ETA: 10s  loss: 0.0589 
[Training] 469/503 [==========================&gt;...] - ETA: 9s  loss: 0.0267 
[Training] 470/503 [===========================&gt;..] - ETA: 9s  loss: 0.0418 
[Training] 471/503 [===========================&gt;..] - ETA: 9s  loss: 0.0765 
[Training] 472/503 [===========================&gt;..] - ETA: 8s  loss: 0.1146 
[Training] 473/503 [===========================&gt;..] - ETA: 8s  loss: 0.0659 
[Training] 474/503 [===========================&gt;..] - ETA: 8s  loss: 0.2423 
[Training] 475/503 [===========================&gt;..] - ETA: 8s  loss: 0.3486 
[Training] 476/503 [===========================&gt;..] - ETA: 7s  loss: 0.0620 
[Training] 477/503 [===========================&gt;..] - ETA: 7s  loss: 0.4613 
[Training] 478/503 [===========================&gt;..] - ETA: 7s  loss: 0.1932 
[Training] 479/503 [===========================&gt;..] - ETA: 6s  loss: 0.4215 
[Training] 480/503 [===========================&gt;..] - ETA: 6s  loss: 0.1419 
[Training] 481/503 [===========================&gt;..] - ETA: 6s  loss: 0.1523 
[Training] 482/503 [===========================&gt;..] - ETA: 6s  loss: 0.0678 
[Training] 483/503 [===========================&gt;..] - ETA: 5s  loss: 0.0973 
[Training] 484/503 [===========================&gt;..] - ETA: 5s  loss: 0.1088 
[Training] 485/503 [===========================&gt;..] - ETA: 5s  loss: 0.0352 
[Training] 486/503 [===========================&gt;..] - ETA: 4s  loss: 0.3062 
[Training] 487/503 [============================&gt;.] - ETA: 4s  loss: 0.0665 
[Training] 488/503 [============================&gt;.] - ETA: 4s  loss: 0.1195 
[Training] 489/503 [============================&gt;.] - ETA: 4s  loss: 0.2650 
[Training] 490/503 [============================&gt;.] - ETA: 3s  loss: 0.0496 
[Training] 491/503 [============================&gt;.] - ETA: 3s  loss: 0.0718 
[Training] 492/503 [============================&gt;.] - ETA: 3s  loss: 0.2943 
[Training] 493/503 [============================&gt;.] - ETA: 2s  loss: 0.1756 
[Training] 494/503 [============================&gt;.] - ETA: 2s  loss: 0.1972 
[Training] 495/503 [============================&gt;.] - ETA: 2s  loss: 0.3162 
[Training] 496/503 [============================&gt;.] - ETA: 2s  loss: 0.3124 
[Training] 497/503 [============================&gt;.] - ETA: 1s  loss: 0.1885 
[Training] 498/503 [============================&gt;.] - ETA: 1s  loss: 0.0732 
[Training] 499/503 [============================&gt;.] - ETA: 1s  loss: 0.0644 
[Training] 500/503 [============================&gt;.] - ETA: 0s  loss: 0.2242 
[Training] 501/503 [============================&gt;.] - ETA: 0s  loss: 0.0245 
[Training] 502/503 [============================&gt;.] - ETA: 0s  loss: 0.0558 
[Training] 503/503 [==============================] 287.1ms/step  loss: 0.0444 
[Testing] 1/32 [..............................] - ETA: 10s
[Testing] 2/32 [&gt;.............................] - ETA: 10s
[Testing] 3/32 [=&gt;............................] - ETA: 9s
[Testing] 4/32 [==&gt;...........................] - ETA: 9s
[Testing] 5/32 [===&gt;..........................] - ETA: 8s
[Testing] 6/32 [====&gt;.........................] - ETA: 8s
[Testing] 7/32 [=====&gt;........................] - ETA: 8s
[Testing] 8/32 [======&gt;.......................] - ETA: 7s
[Testing] 9/32 [=======&gt;......................] - ETA: 7s
[Testing] 10/32 [========&gt;.....................] - ETA: 7s
[Testing] 11/32 [=========&gt;....................] - ETA: 7s
[Testing] 12/32 [==========&gt;...................] - ETA: 6s
[Testing] 13/32 [===========&gt;..................] - ETA: 6s
[Testing] 14/32 [============&gt;.................] - ETA: 6s
[Testing] 15/32 [=============&gt;................] - ETA: 6s
[Testing] 16/32 [==============&gt;...............] - ETA: 5s
[Testing] 17/32 [==============&gt;...............] - ETA: 5s
[Testing] 18/32 [===============&gt;..............] - ETA: 5s
[Testing] 19/32 [================&gt;.............] - ETA: 4s
[Testing] 20/32 [=================&gt;............] - ETA: 4s
[Testing] 21/32 [==================&gt;...........] - ETA: 3s
[Testing] 22/32 [===================&gt;..........] - ETA: 3s
[Testing] 23/32 [====================&gt;.........] - ETA: 3s
[Testing] 24/32 [=====================&gt;........] - ETA: 2s
[Testing] 25/32 [======================&gt;.......] - ETA: 2s
[Testing] 26/32 [=======================&gt;......] - ETA: 2s
[Testing] 27/32 [========================&gt;.....] - ETA: 1s
[Testing] 28/32 [=========================&gt;....] - ETA: 1s
[Testing] 29/32 [==========================&gt;...] - ETA: 1s
[Testing] 30/32 [===========================&gt;..] - ETA: 0s
[Testing] 31/32 [============================&gt;.] - ETA: 0s
[Testing] 32/32 [==============================] 338.2ms/step
## Epoch: 4 -  loss: 0.1755 - valid_loss: 0.2870 - valid_acc: 0.8865 - valid_f1: 0.8476 
## 
## C:/Users/Andrew/Desktop/Projects/Deep Learning/utils\radam.py:60: UserWarning: This overload of add_ is deprecated:
##  add_(Number alpha, Tensor other)
## Consider using one of the following signatures instead:
##  add_(Tensor other, *, Number alpha) (Triggered internally at  ..\torch\csrc\utils\python_arg_parser.cpp:766.)
##   exp_avg.mul_(beta1).add_(1 - beta1, grad)</code></pre>
</div>
<div id="testing" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Testing</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># testing</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>test_log <span class="op">=</span> test(test_dataloader)</span></code></pre></div>
<pre><code>## 
[Testing] 1/32 [..............................] - ETA: 9s
[Testing] 2/32 [&gt;.............................] - ETA: 9s
[Testing] 3/32 [=&gt;............................] - ETA: 8s
[Testing] 4/32 [==&gt;...........................] - ETA: 8s
[Testing] 5/32 [===&gt;..........................] - ETA: 8s
[Testing] 6/32 [====&gt;.........................] - ETA: 8s
[Testing] 7/32 [=====&gt;........................] - ETA: 7s
[Testing] 8/32 [======&gt;.......................] - ETA: 7s
[Testing] 9/32 [=======&gt;......................] - ETA: 7s
[Testing] 10/32 [========&gt;.....................] - ETA: 7s
[Testing] 11/32 [=========&gt;....................] - ETA: 6s
[Testing] 12/32 [==========&gt;...................] - ETA: 6s
[Testing] 13/32 [===========&gt;..................] - ETA: 6s
[Testing] 14/32 [============&gt;.................] - ETA: 5s
[Testing] 15/32 [=============&gt;................] - ETA: 5s
[Testing] 16/32 [==============&gt;...............] - ETA: 5s
[Testing] 17/32 [==============&gt;...............] - ETA: 4s
[Testing] 18/32 [===============&gt;..............] - ETA: 4s
[Testing] 19/32 [================&gt;.............] - ETA: 4s
[Testing] 20/32 [=================&gt;............] - ETA: 3s
[Testing] 21/32 [==================&gt;...........] - ETA: 3s
[Testing] 22/32 [===================&gt;..........] - ETA: 3s
[Testing] 23/32 [====================&gt;.........] - ETA: 2s
[Testing] 24/32 [=====================&gt;........] - ETA: 2s
[Testing] 25/32 [======================&gt;.......] - ETA: 2s
[Testing] 26/32 [=======================&gt;......] - ETA: 1s
[Testing] 27/32 [========================&gt;.....] - ETA: 1s
[Testing] 28/32 [=========================&gt;....] - ETA: 1s
[Testing] 29/32 [==========================&gt;...] - ETA: 0s
[Testing] 30/32 [===========================&gt;..] - ETA: 0s
[Testing] 31/32 [============================&gt;.] - ETA: 0s
[Testing] 32/32 [==============================] 318.9ms/step</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="bu">print</span>(test_log)</span></code></pre></div>
<pre><code>## {&#39;valid_loss&#39;: tensor(0.3638, device=&#39;cuda:0&#39;), &#39;valid_acc&#39;: 0.8606965174129353, &#39;valid_f1&#39;: 0.8001156244602546}</code></pre>
</div>
</div>
<div id="generated-fine-tuned-embeddings" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Generated Fine-Tuned Embeddings</h1>
<p>Here we prepare a new data loader and use the entire data set.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># export embeddings for semantic similary search</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># create dataloader for whole data set -- batch size of 1 is fastest</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>train_dataloader <span class="op">=</span> DataLoader(csv_dataset,</span>
<span id="cb22-4"><a href="#cb22-4"></a>                              batch_size<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>                              shuffle<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Next, we instantiate our model and tweak it slightly to only retrieve the embeddings from the <code>CLS</code> token.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># tweak the model</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">class</span> DistillBERT_Emb(torch.nn.Module):</span>
<span id="cb23-3"><a href="#cb23-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb23-4"><a href="#cb23-4"></a>        <span class="bu">super</span>(DistillBERT_Emb, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb23-5"><a href="#cb23-5"></a>        <span class="co"># load model</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>        <span class="va">self</span>.l1 <span class="op">=</span> DistilBertModel.from_pretrained(<span class="st">&quot;distilbert-base-uncased&quot;</span>, output_hidden_states<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-7"><a href="#cb23-7"></a>        <span class="co"># pre-classifier layer</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>        <span class="va">self</span>.pre_classifier <span class="op">=</span> torch.nn.Linear(<span class="dv">768</span>, <span class="dv">768</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a>        <span class="co"># drop out</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>        <span class="va">self</span>.dropout <span class="op">=</span> torch.nn.Dropout(<span class="fl">0.3</span>)</span>
<span id="cb23-11"><a href="#cb23-11"></a>        <span class="co"># final classification layer</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>        <span class="va">self</span>.classifier <span class="op">=</span> torch.nn.Linear(<span class="dv">768</span>, <span class="dv">2</span>)  <span class="co"># [features, targets]</span></span>
<span id="cb23-13"><a href="#cb23-13"></a></span>
<span id="cb23-14"><a href="#cb23-14"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, input_ids, attention_mask):</span>
<span id="cb23-15"><a href="#cb23-15"></a>        <span class="co"># generate outputs from BERT</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb23-17"><a href="#cb23-17"></a>            output_1 <span class="op">=</span> <span class="va">self</span>.l1(input_ids<span class="op">=</span>input_ids, attention_mask<span class="op">=</span>attention_mask)</span>
<span id="cb23-18"><a href="#cb23-18"></a>        embeddings <span class="op">=</span> output_1[<span class="dv">1</span>]  <span class="co"># 2nd tuple is the embeddings</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>        <span class="co"># stack</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>        embeddings <span class="op">=</span> torch.stack(embeddings)  <span class="co"># [layers, batch_sz, tokens, features]]</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>        <span class="co"># grab second to last layer</span></span>
<span id="cb23-22"><a href="#cb23-22"></a>        embeddings <span class="op">=</span> embeddings[<span class="op">-</span><span class="dv">2</span>]  <span class="co"># [batch_sz, tokens, features]]</span></span>
<span id="cb23-23"><a href="#cb23-23"></a>        <span class="co"># just get the CLS token</span></span>
<span id="cb23-24"><a href="#cb23-24"></a>        embeddings <span class="op">=</span> embeddings[:, <span class="dv">0</span>, :]  <span class="co"># [batch_sz, features]]</span></span>
<span id="cb23-25"><a href="#cb23-25"></a>        <span class="cf">return</span> embeddings</span></code></pre></div>
<p>Now we instantiate our tweaked model and feed it fine-tuned weights.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># instantiate the model and load the weights</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>model <span class="op">=</span> DistillBERT_Emb().to(device)</span>
<span id="cb24-3"><a href="#cb24-3"></a>model.load_state_dict(torch.load(<span class="st">&#39;distilbert-model1.pt&#39;</span>))</span></code></pre></div>
<pre><code>## &lt;All keys matched successfully&gt;</code></pre>
<div id="generate-fine-tuned-embeddings" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Generate Fine-Tuned Embeddings</h2>
<p>In this section, we lazily load our data in batches of 1 and generate and save our embeddings. It is important that we detach the embeddings from the GPU to prevent the GPUâ€™s memory from exceeding capacity and crashing our training.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># start time</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>t0 <span class="op">=</span> time.time()</span>
<span id="cb26-3"><a href="#cb26-3"></a>batch_num <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>num_documents <span class="op">=</span> <span class="bu">len</span>(csv_dataset)</span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co"># time function</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="kw">def</span> format_time(elapsed):</span>
<span id="cb26-8"><a href="#cb26-8"></a>    <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">    Takes a time in seconds and returns a string hh:mm:ss</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">    &#39;&#39;&#39;</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="co"># round to the nearest second.</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>    elapsed_rounded <span class="op">=</span> <span class="bu">int</span>(<span class="bu">round</span>((elapsed)))</span>
<span id="cb26-13"><a href="#cb26-13"></a>    <span class="co"># format as hh:mm:ss</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>    <span class="cf">return</span> <span class="bu">str</span>(datetime.timedelta(seconds<span class="op">=</span>elapsed_rounded))</span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co"># store embeddings</span></span>
<span id="cb26-17"><a href="#cb26-17"></a>embeddings_container <span class="op">=</span> []</span>
<span id="cb26-18"><a href="#cb26-18"></a></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="bu">print</span>(<span class="st">&#39;Generating embeddings for all {:,} documents...&#39;</span>.<span class="bu">format</span>(<span class="bu">len</span>(csv_dataset)))</span></code></pre></div>
<pre><code>## Generating embeddings for all 10,045 documents...</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="cf">for</span> step, batch <span class="kw">in</span> <span class="bu">enumerate</span>(train_dataloader):</span>
<span id="cb28-2"><a href="#cb28-2"></a>    <span class="cf">if</span> step <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> <span class="kw">not</span> batch_num <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a>        elapsed <span class="op">=</span> format_time(time.time() <span class="op">-</span> t0)</span>
<span id="cb28-5"><a href="#cb28-5"></a></span>
<span id="cb28-6"><a href="#cb28-6"></a>        <span class="co"># calc time remaining</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>        rows_per_sec <span class="op">=</span> (time.time() <span class="op">-</span> t0) <span class="op">/</span> batch_num</span>
<span id="cb28-8"><a href="#cb28-8"></a>        remaining_sec <span class="op">=</span> rows_per_sec <span class="op">*</span> (num_documents <span class="op">-</span> batch_num)</span>
<span id="cb28-9"><a href="#cb28-9"></a>        remaining <span class="op">=</span> format_time(remaining_sec)</span>
<span id="cb28-10"><a href="#cb28-10"></a></span>
<span id="cb28-11"><a href="#cb28-11"></a>        <span class="co"># report progress</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>        <span class="bu">print</span>(<span class="st">&#39;Documents {:&gt;7,} of {:&gt;7,}. Elapsed: </span><span class="sc">{:}</span><span class="st">. Remaining: </span><span class="sc">{:}</span><span class="st">&#39;</span>.<span class="bu">format</span>(batch_num, num_documents, elapsed, remaining))</span>
<span id="cb28-13"><a href="#cb28-13"></a></span>
<span id="cb28-14"><a href="#cb28-14"></a>    <span class="co"># get embedding</span></span>
<span id="cb28-15"><a href="#cb28-15"></a>    embeddings <span class="op">=</span> model(input_ids<span class="op">=</span>batch[<span class="st">&#39;features&#39;</span>].squeeze(<span class="dv">1</span>), attention_mask<span class="op">=</span>batch[<span class="st">&#39;attn_mask&#39;</span>].squeeze(<span class="dv">1</span>))</span>
<span id="cb28-16"><a href="#cb28-16"></a>    <span class="co"># send to cpu or GPU will run out of memory</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>    embeddings_container.append(embeddings.to(<span class="st">&#39;cpu&#39;</span>).numpy())</span>
<span id="cb28-18"><a href="#cb28-18"></a>    batch_num <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>    torch.cuda.empty_cache()</span></code></pre></div>
<pre><code>## Documents      20 of  10,045. Elapsed: 0:00:00. Remaining: 0:03:54
## Documents      40 of  10,045. Elapsed: 0:00:01. Remaining: 0:03:10
## Documents      60 of  10,045. Elapsed: 0:00:01. Remaining: 0:02:56
## Documents      80 of  10,045. Elapsed: 0:00:01. Remaining: 0:02:53
## Documents     100 of  10,045. Elapsed: 0:00:02. Remaining: 0:02:49
## Documents     120 of  10,045. Elapsed: 0:00:02. Remaining: 0:02:50
## Documents     140 of  10,045. Elapsed: 0:00:03. Remaining: 0:02:58
## Documents     160 of  10,045. Elapsed: 0:00:03. Remaining: 0:02:54
## Documents     180 of  10,045. Elapsed: 0:00:03. Remaining: 0:02:53
## Documents     200 of  10,045. Elapsed: 0:00:04. Remaining: 0:02:52
## Documents     220 of  10,045. Elapsed: 0:00:04. Remaining: 0:02:50
## Documents     240 of  10,045. Elapsed: 0:00:04. Remaining: 0:02:48
## Documents     260 of  10,045. Elapsed: 0:00:04. Remaining: 0:02:45
## Documents     280 of  10,045. Elapsed: 0:00:05. Remaining: 0:02:44
## Documents     300 of  10,045. Elapsed: 0:00:05. Remaining: 0:02:47
## Documents     320 of  10,045. Elapsed: 0:00:06. Remaining: 0:02:49
## Documents     340 of  10,045. Elapsed: 0:00:06. Remaining: 0:02:49
## Documents     360 of  10,045. Elapsed: 0:00:06. Remaining: 0:02:52
## Documents     380 of  10,045. Elapsed: 0:00:07. Remaining: 0:02:54
## Documents     400 of  10,045. Elapsed: 0:00:07. Remaining: 0:02:54
## Documents     420 of  10,045. Elapsed: 0:00:08. Remaining: 0:02:53
## Documents     440 of  10,045. Elapsed: 0:00:08. Remaining: 0:02:53
## Documents     460 of  10,045. Elapsed: 0:00:08. Remaining: 0:02:51
## Documents     480 of  10,045. Elapsed: 0:00:09. Remaining: 0:02:52
## Documents     500 of  10,045. Elapsed: 0:00:09. Remaining: 0:02:51
## Documents     520 of  10,045. Elapsed: 0:00:09. Remaining: 0:02:50
## Documents     540 of  10,045. Elapsed: 0:00:10. Remaining: 0:02:50
## Documents     560 of  10,045. Elapsed: 0:00:10. Remaining: 0:02:50
## Documents     580 of  10,045. Elapsed: 0:00:10. Remaining: 0:02:51
## Documents     600 of  10,045. Elapsed: 0:00:11. Remaining: 0:02:50
## Documents     620 of  10,045. Elapsed: 0:00:11. Remaining: 0:02:50
## Documents     640 of  10,045. Elapsed: 0:00:12. Remaining: 0:02:50
## Documents     660 of  10,045. Elapsed: 0:00:12. Remaining: 0:02:49
## Documents     680 of  10,045. Elapsed: 0:00:12. Remaining: 0:02:49
## Documents     700 of  10,045. Elapsed: 0:00:13. Remaining: 0:02:50
## Documents     720 of  10,045. Elapsed: 0:00:13. Remaining: 0:02:50
## Documents     740 of  10,045. Elapsed: 0:00:14. Remaining: 0:02:50
## Documents     760 of  10,045. Elapsed: 0:00:14. Remaining: 0:02:50
## Documents     780 of  10,045. Elapsed: 0:00:14. Remaining: 0:02:49
## Documents     800 of  10,045. Elapsed: 0:00:15. Remaining: 0:02:48
## Documents     820 of  10,045. Elapsed: 0:00:15. Remaining: 0:02:49
## Documents     840 of  10,045. Elapsed: 0:00:15. Remaining: 0:02:48
## Documents     860 of  10,045. Elapsed: 0:00:16. Remaining: 0:02:48
## Documents     880 of  10,045. Elapsed: 0:00:16. Remaining: 0:02:47
## Documents     900 of  10,045. Elapsed: 0:00:16. Remaining: 0:02:47
## Documents     920 of  10,045. Elapsed: 0:00:17. Remaining: 0:02:48
## Documents     940 of  10,045. Elapsed: 0:00:17. Remaining: 0:02:47
## Documents     960 of  10,045. Elapsed: 0:00:18. Remaining: 0:02:46
## Documents     980 of  10,045. Elapsed: 0:00:18. Remaining: 0:02:47
## Documents   1,000 of  10,045. Elapsed: 0:00:18. Remaining: 0:02:46
## Documents   1,020 of  10,045. Elapsed: 0:00:19. Remaining: 0:02:45
## Documents   1,040 of  10,045. Elapsed: 0:00:19. Remaining: 0:02:45
## Documents   1,060 of  10,045. Elapsed: 0:00:19. Remaining: 0:02:44
## Documents   1,080 of  10,045. Elapsed: 0:00:20. Remaining: 0:02:44
## Documents   1,100 of  10,045. Elapsed: 0:00:20. Remaining: 0:02:43
## Documents   1,120 of  10,045. Elapsed: 0:00:21. Remaining: 0:02:44
## Documents   1,140 of  10,045. Elapsed: 0:00:21. Remaining: 0:02:43
## Documents   1,160 of  10,045. Elapsed: 0:00:21. Remaining: 0:02:43
## Documents   1,180 of  10,045. Elapsed: 0:00:22. Remaining: 0:02:42
## Documents   1,200 of  10,045. Elapsed: 0:00:22. Remaining: 0:02:42
## Documents   1,220 of  10,045. Elapsed: 0:00:22. Remaining: 0:02:42
## Documents   1,240 of  10,045. Elapsed: 0:00:23. Remaining: 0:02:41
## Documents   1,260 of  10,045. Elapsed: 0:00:23. Remaining: 0:02:40
## Documents   1,280 of  10,045. Elapsed: 0:00:23. Remaining: 0:02:40
## Documents   1,300 of  10,045. Elapsed: 0:00:24. Remaining: 0:02:40
## Documents   1,320 of  10,045. Elapsed: 0:00:24. Remaining: 0:02:40
## Documents   1,340 of  10,045. Elapsed: 0:00:25. Remaining: 0:02:40
## Documents   1,360 of  10,045. Elapsed: 0:00:25. Remaining: 0:02:40
## Documents   1,380 of  10,045. Elapsed: 0:00:26. Remaining: 0:02:40
## Documents   1,400 of  10,045. Elapsed: 0:00:26. Remaining: 0:02:40
## Documents   1,420 of  10,045. Elapsed: 0:00:26. Remaining: 0:02:40
## Documents   1,440 of  10,045. Elapsed: 0:00:27. Remaining: 0:02:39
## Documents   1,460 of  10,045. Elapsed: 0:00:27. Remaining: 0:02:39
## Documents   1,480 of  10,045. Elapsed: 0:00:27. Remaining: 0:02:38
## Documents   1,500 of  10,045. Elapsed: 0:00:28. Remaining: 0:02:38
## Documents   1,520 of  10,045. Elapsed: 0:00:28. Remaining: 0:02:38
## Documents   1,540 of  10,045. Elapsed: 0:00:28. Remaining: 0:02:37
## Documents   1,560 of  10,045. Elapsed: 0:00:29. Remaining: 0:02:37
## Documents   1,580 of  10,045. Elapsed: 0:00:29. Remaining: 0:02:37
## Documents   1,600 of  10,045. Elapsed: 0:00:30. Remaining: 0:02:36
## Documents   1,620 of  10,045. Elapsed: 0:00:30. Remaining: 0:02:36
## Documents   1,640 of  10,045. Elapsed: 0:00:30. Remaining: 0:02:36
## Documents   1,660 of  10,045. Elapsed: 0:00:31. Remaining: 0:02:36
## Documents   1,680 of  10,045. Elapsed: 0:00:31. Remaining: 0:02:35
## Documents   1,700 of  10,045. Elapsed: 0:00:32. Remaining: 0:02:35
## Documents   1,720 of  10,045. Elapsed: 0:00:32. Remaining: 0:02:34
## Documents   1,740 of  10,045. Elapsed: 0:00:32. Remaining: 0:02:35
## Documents   1,760 of  10,045. Elapsed: 0:00:33. Remaining: 0:02:35
## Documents   1,780 of  10,045. Elapsed: 0:00:33. Remaining: 0:02:34
## Documents   1,800 of  10,045. Elapsed: 0:00:34. Remaining: 0:02:34
## Documents   1,820 of  10,045. Elapsed: 0:00:34. Remaining: 0:02:33
## Documents   1,840 of  10,045. Elapsed: 0:00:34. Remaining: 0:02:33
## Documents   1,860 of  10,045. Elapsed: 0:00:35. Remaining: 0:02:32
## Documents   1,880 of  10,045. Elapsed: 0:00:35. Remaining: 0:02:31
## Documents   1,900 of  10,045. Elapsed: 0:00:35. Remaining: 0:02:31
## Documents   1,920 of  10,045. Elapsed: 0:00:36. Remaining: 0:02:30
## Documents   1,940 of  10,045. Elapsed: 0:00:36. Remaining: 0:02:30
## Documents   1,960 of  10,045. Elapsed: 0:00:36. Remaining: 0:02:30
## Documents   1,980 of  10,045. Elapsed: 0:00:37. Remaining: 0:02:29
## Documents   2,000 of  10,045. Elapsed: 0:00:37. Remaining: 0:02:29
## Documents   2,020 of  10,045. Elapsed: 0:00:37. Remaining: 0:02:28
## Documents   2,040 of  10,045. Elapsed: 0:00:38. Remaining: 0:02:28
## Documents   2,060 of  10,045. Elapsed: 0:00:38. Remaining: 0:02:27
## Documents   2,080 of  10,045. Elapsed: 0:00:38. Remaining: 0:02:27
## Documents   2,100 of  10,045. Elapsed: 0:00:39. Remaining: 0:02:26
## Documents   2,120 of  10,045. Elapsed: 0:00:39. Remaining: 0:02:26
## Documents   2,140 of  10,045. Elapsed: 0:00:39. Remaining: 0:02:25
## Documents   2,160 of  10,045. Elapsed: 0:00:40. Remaining: 0:02:25
## Documents   2,180 of  10,045. Elapsed: 0:00:40. Remaining: 0:02:24
## Documents   2,200 of  10,045. Elapsed: 0:00:40. Remaining: 0:02:24
## Documents   2,220 of  10,045. Elapsed: 0:00:41. Remaining: 0:02:24
## Documents   2,240 of  10,045. Elapsed: 0:00:41. Remaining: 0:02:23
## Documents   2,260 of  10,045. Elapsed: 0:00:41. Remaining: 0:02:23
## Documents   2,280 of  10,045. Elapsed: 0:00:42. Remaining: 0:02:22
## Documents   2,300 of  10,045. Elapsed: 0:00:42. Remaining: 0:02:21
## Documents   2,320 of  10,045. Elapsed: 0:00:42. Remaining: 0:02:21
## Documents   2,340 of  10,045. Elapsed: 0:00:43. Remaining: 0:02:20
## Documents   2,360 of  10,045. Elapsed: 0:00:43. Remaining: 0:02:20
## Documents   2,380 of  10,045. Elapsed: 0:00:43. Remaining: 0:02:19
## Documents   2,400 of  10,045. Elapsed: 0:00:44. Remaining: 0:02:19
## Documents   2,420 of  10,045. Elapsed: 0:00:44. Remaining: 0:02:18
## Documents   2,440 of  10,045. Elapsed: 0:00:44. Remaining: 0:02:18
## Documents   2,460 of  10,045. Elapsed: 0:00:44. Remaining: 0:02:17
## Documents   2,480 of  10,045. Elapsed: 0:00:45. Remaining: 0:02:17
## Documents   2,500 of  10,045. Elapsed: 0:00:45. Remaining: 0:02:16
## Documents   2,520 of  10,045. Elapsed: 0:00:45. Remaining: 0:02:15
## Documents   2,540 of  10,045. Elapsed: 0:00:46. Remaining: 0:02:15
## Documents   2,560 of  10,045. Elapsed: 0:00:46. Remaining: 0:02:14
## Documents   2,580 of  10,045. Elapsed: 0:00:46. Remaining: 0:02:14
## Documents   2,600 of  10,045. Elapsed: 0:00:47. Remaining: 0:02:13
## Documents   2,620 of  10,045. Elapsed: 0:00:47. Remaining: 0:02:13
## Documents   2,640 of  10,045. Elapsed: 0:00:47. Remaining: 0:02:12
## Documents   2,660 of  10,045. Elapsed: 0:00:47. Remaining: 0:02:12
## Documents   2,680 of  10,045. Elapsed: 0:00:48. Remaining: 0:02:11
## Documents   2,700 of  10,045. Elapsed: 0:00:48. Remaining: 0:02:11
## Documents   2,720 of  10,045. Elapsed: 0:00:48. Remaining: 0:02:11
## Documents   2,740 of  10,045. Elapsed: 0:00:49. Remaining: 0:02:10
## Documents   2,760 of  10,045. Elapsed: 0:00:49. Remaining: 0:02:10
## Documents   2,780 of  10,045. Elapsed: 0:00:50. Remaining: 0:02:10
## Documents   2,800 of  10,045. Elapsed: 0:00:50. Remaining: 0:02:09
## Documents   2,820 of  10,045. Elapsed: 0:00:50. Remaining: 0:02:09
## Documents   2,840 of  10,045. Elapsed: 0:00:51. Remaining: 0:02:09
## Documents   2,860 of  10,045. Elapsed: 0:00:51. Remaining: 0:02:09
## Documents   2,880 of  10,045. Elapsed: 0:00:52. Remaining: 0:02:08
## Documents   2,900 of  10,045. Elapsed: 0:00:52. Remaining: 0:02:08
## Documents   2,920 of  10,045. Elapsed: 0:00:52. Remaining: 0:02:08
## Documents   2,940 of  10,045. Elapsed: 0:00:53. Remaining: 0:02:08
## Documents   2,960 of  10,045. Elapsed: 0:00:53. Remaining: 0:02:07
## Documents   2,980 of  10,045. Elapsed: 0:00:54. Remaining: 0:02:07
## Documents   3,000 of  10,045. Elapsed: 0:00:54. Remaining: 0:02:07
## Documents   3,020 of  10,045. Elapsed: 0:00:54. Remaining: 0:02:07
## Documents   3,040 of  10,045. Elapsed: 0:00:55. Remaining: 0:02:06
## Documents   3,060 of  10,045. Elapsed: 0:00:55. Remaining: 0:02:06
## Documents   3,080 of  10,045. Elapsed: 0:00:55. Remaining: 0:02:05
## Documents   3,100 of  10,045. Elapsed: 0:00:56. Remaining: 0:02:05
## Documents   3,120 of  10,045. Elapsed: 0:00:56. Remaining: 0:02:04
## Documents   3,140 of  10,045. Elapsed: 0:00:56. Remaining: 0:02:03
## Documents   3,160 of  10,045. Elapsed: 0:00:56. Remaining: 0:02:03
## Documents   3,180 of  10,045. Elapsed: 0:00:57. Remaining: 0:02:02
## Documents   3,200 of  10,045. Elapsed: 0:00:57. Remaining: 0:02:02
## Documents   3,220 of  10,045. Elapsed: 0:00:57. Remaining: 0:02:01
## Documents   3,240 of  10,045. Elapsed: 0:00:57. Remaining: 0:02:01
## Documents   3,260 of  10,045. Elapsed: 0:00:58. Remaining: 0:02:00
## Documents   3,280 of  10,045. Elapsed: 0:00:58. Remaining: 0:02:00
## Documents   3,300 of  10,045. Elapsed: 0:00:58. Remaining: 0:01:59
## Documents   3,320 of  10,045. Elapsed: 0:00:58. Remaining: 0:01:58
## Documents   3,340 of  10,045. Elapsed: 0:00:59. Remaining: 0:01:58
## Documents   3,360 of  10,045. Elapsed: 0:00:59. Remaining: 0:01:57
## Documents   3,380 of  10,045. Elapsed: 0:00:59. Remaining: 0:01:57
## Documents   3,400 of  10,045. Elapsed: 0:00:59. Remaining: 0:01:56
## Documents   3,420 of  10,045. Elapsed: 0:01:00. Remaining: 0:01:56
## Documents   3,440 of  10,045. Elapsed: 0:01:00. Remaining: 0:01:55
## Documents   3,460 of  10,045. Elapsed: 0:01:00. Remaining: 0:01:55
## Documents   3,480 of  10,045. Elapsed: 0:01:00. Remaining: 0:01:54
## Documents   3,500 of  10,045. Elapsed: 0:01:01. Remaining: 0:01:53
## Documents   3,520 of  10,045. Elapsed: 0:01:01. Remaining: 0:01:53
## Documents   3,540 of  10,045. Elapsed: 0:01:01. Remaining: 0:01:52
## Documents   3,560 of  10,045. Elapsed: 0:01:01. Remaining: 0:01:52
## Documents   3,580 of  10,045. Elapsed: 0:01:02. Remaining: 0:01:51
## Documents   3,600 of  10,045. Elapsed: 0:01:02. Remaining: 0:01:51
## Documents   3,620 of  10,045. Elapsed: 0:01:02. Remaining: 0:01:50
## Documents   3,640 of  10,045. Elapsed: 0:01:02. Remaining: 0:01:50
## Documents   3,660 of  10,045. Elapsed: 0:01:03. Remaining: 0:01:49
## Documents   3,680 of  10,045. Elapsed: 0:01:03. Remaining: 0:01:49
## Documents   3,700 of  10,045. Elapsed: 0:01:03. Remaining: 0:01:48
## Documents   3,720 of  10,045. Elapsed: 0:01:03. Remaining: 0:01:48
## Documents   3,740 of  10,045. Elapsed: 0:01:04. Remaining: 0:01:47
## Documents   3,760 of  10,045. Elapsed: 0:01:04. Remaining: 0:01:47
## Documents   3,780 of  10,045. Elapsed: 0:01:04. Remaining: 0:01:46
## Documents   3,800 of  10,045. Elapsed: 0:01:04. Remaining: 0:01:46
## Documents   3,820 of  10,045. Elapsed: 0:01:05. Remaining: 0:01:45
## Documents   3,840 of  10,045. Elapsed: 0:01:05. Remaining: 0:01:45
## Documents   3,860 of  10,045. Elapsed: 0:01:05. Remaining: 0:01:44
## Documents   3,880 of  10,045. Elapsed: 0:01:05. Remaining: 0:01:44
## Documents   3,900 of  10,045. Elapsed: 0:01:06. Remaining: 0:01:43
## Documents   3,920 of  10,045. Elapsed: 0:01:06. Remaining: 0:01:43
## Documents   3,940 of  10,045. Elapsed: 0:01:06. Remaining: 0:01:42
## Documents   3,960 of  10,045. Elapsed: 0:01:06. Remaining: 0:01:42
## Documents   3,980 of  10,045. Elapsed: 0:01:07. Remaining: 0:01:42
## Documents   4,000 of  10,045. Elapsed: 0:01:07. Remaining: 0:01:41
## Documents   4,020 of  10,045. Elapsed: 0:01:07. Remaining: 0:01:41
## Documents   4,040 of  10,045. Elapsed: 0:01:07. Remaining: 0:01:40
## Documents   4,060 of  10,045. Elapsed: 0:01:08. Remaining: 0:01:40
## Documents   4,080 of  10,045. Elapsed: 0:01:08. Remaining: 0:01:39
## Documents   4,100 of  10,045. Elapsed: 0:01:08. Remaining: 0:01:39
## Documents   4,120 of  10,045. Elapsed: 0:01:08. Remaining: 0:01:38
## Documents   4,140 of  10,045. Elapsed: 0:01:09. Remaining: 0:01:38
## Documents   4,160 of  10,045. Elapsed: 0:01:09. Remaining: 0:01:38
## Documents   4,180 of  10,045. Elapsed: 0:01:09. Remaining: 0:01:37
## Documents   4,200 of  10,045. Elapsed: 0:01:10. Remaining: 0:01:37
## Documents   4,220 of  10,045. Elapsed: 0:01:10. Remaining: 0:01:36
## Documents   4,240 of  10,045. Elapsed: 0:01:10. Remaining: 0:01:36
## Documents   4,260 of  10,045. Elapsed: 0:01:10. Remaining: 0:01:35
## Documents   4,280 of  10,045. Elapsed: 0:01:10. Remaining: 0:01:35
## Documents   4,300 of  10,045. Elapsed: 0:01:11. Remaining: 0:01:34
## Documents   4,320 of  10,045. Elapsed: 0:01:11. Remaining: 0:01:34
## Documents   4,340 of  10,045. Elapsed: 0:01:11. Remaining: 0:01:33
## Documents   4,360 of  10,045. Elapsed: 0:01:11. Remaining: 0:01:33
## Documents   4,380 of  10,045. Elapsed: 0:01:12. Remaining: 0:01:32
## Documents   4,400 of  10,045. Elapsed: 0:01:12. Remaining: 0:01:32
## Documents   4,420 of  10,045. Elapsed: 0:01:12. Remaining: 0:01:32
## Documents   4,440 of  10,045. Elapsed: 0:01:12. Remaining: 0:01:31
## Documents   4,460 of  10,045. Elapsed: 0:01:12. Remaining: 0:01:31
## Documents   4,480 of  10,045. Elapsed: 0:01:13. Remaining: 0:01:30
## Documents   4,500 of  10,045. Elapsed: 0:01:13. Remaining: 0:01:30
## Documents   4,520 of  10,045. Elapsed: 0:01:13. Remaining: 0:01:29
## Documents   4,540 of  10,045. Elapsed: 0:01:13. Remaining: 0:01:29
## Documents   4,560 of  10,045. Elapsed: 0:01:14. Remaining: 0:01:29
## Documents   4,580 of  10,045. Elapsed: 0:01:14. Remaining: 0:01:28
## Documents   4,600 of  10,045. Elapsed: 0:01:14. Remaining: 0:01:28
## Documents   4,620 of  10,045. Elapsed: 0:01:14. Remaining: 0:01:27
## Documents   4,640 of  10,045. Elapsed: 0:01:14. Remaining: 0:01:27
## Documents   4,660 of  10,045. Elapsed: 0:01:15. Remaining: 0:01:26
## Documents   4,680 of  10,045. Elapsed: 0:01:15. Remaining: 0:01:26
## Documents   4,700 of  10,045. Elapsed: 0:01:15. Remaining: 0:01:25
## Documents   4,720 of  10,045. Elapsed: 0:01:15. Remaining: 0:01:25
## Documents   4,740 of  10,045. Elapsed: 0:01:16. Remaining: 0:01:25
## Documents   4,760 of  10,045. Elapsed: 0:01:16. Remaining: 0:01:24
## Documents   4,780 of  10,045. Elapsed: 0:01:16. Remaining: 0:01:24
## Documents   4,800 of  10,045. Elapsed: 0:01:16. Remaining: 0:01:23
## Documents   4,820 of  10,045. Elapsed: 0:01:17. Remaining: 0:01:23
## Documents   4,840 of  10,045. Elapsed: 0:01:17. Remaining: 0:01:23
## Documents   4,860 of  10,045. Elapsed: 0:01:17. Remaining: 0:01:22
## Documents   4,880 of  10,045. Elapsed: 0:01:17. Remaining: 0:01:22
## Documents   4,900 of  10,045. Elapsed: 0:01:17. Remaining: 0:01:21
## Documents   4,920 of  10,045. Elapsed: 0:01:18. Remaining: 0:01:21
## Documents   4,940 of  10,045. Elapsed: 0:01:18. Remaining: 0:01:20
## Documents   4,960 of  10,045. Elapsed: 0:01:18. Remaining: 0:01:20
## Documents   4,980 of  10,045. Elapsed: 0:01:18. Remaining: 0:01:20
## Documents   5,000 of  10,045. Elapsed: 0:01:18. Remaining: 0:01:19
## Documents   5,020 of  10,045. Elapsed: 0:01:19. Remaining: 0:01:19
## Documents   5,040 of  10,045. Elapsed: 0:01:19. Remaining: 0:01:18
## Documents   5,060 of  10,045. Elapsed: 0:01:19. Remaining: 0:01:18
## Documents   5,080 of  10,045. Elapsed: 0:01:19. Remaining: 0:01:18
## Documents   5,100 of  10,045. Elapsed: 0:01:20. Remaining: 0:01:17
## Documents   5,120 of  10,045. Elapsed: 0:01:20. Remaining: 0:01:17
## Documents   5,140 of  10,045. Elapsed: 0:01:20. Remaining: 0:01:16
## Documents   5,160 of  10,045. Elapsed: 0:01:20. Remaining: 0:01:16
## Documents   5,180 of  10,045. Elapsed: 0:01:20. Remaining: 0:01:16
## Documents   5,200 of  10,045. Elapsed: 0:01:21. Remaining: 0:01:15
## Documents   5,220 of  10,045. Elapsed: 0:01:21. Remaining: 0:01:15
## Documents   5,240 of  10,045. Elapsed: 0:01:21. Remaining: 0:01:14
## Documents   5,260 of  10,045. Elapsed: 0:01:21. Remaining: 0:01:14
## Documents   5,280 of  10,045. Elapsed: 0:01:21. Remaining: 0:01:14
## Documents   5,300 of  10,045. Elapsed: 0:01:22. Remaining: 0:01:13
## Documents   5,320 of  10,045. Elapsed: 0:01:22. Remaining: 0:01:13
## Documents   5,340 of  10,045. Elapsed: 0:01:22. Remaining: 0:01:12
## Documents   5,360 of  10,045. Elapsed: 0:01:22. Remaining: 0:01:12
## Documents   5,380 of  10,045. Elapsed: 0:01:23. Remaining: 0:01:12
## Documents   5,400 of  10,045. Elapsed: 0:01:23. Remaining: 0:01:11
## Documents   5,420 of  10,045. Elapsed: 0:01:23. Remaining: 0:01:11
## Documents   5,440 of  10,045. Elapsed: 0:01:23. Remaining: 0:01:10
## Documents   5,460 of  10,045. Elapsed: 0:01:23. Remaining: 0:01:10
## Documents   5,480 of  10,045. Elapsed: 0:01:24. Remaining: 0:01:10
## Documents   5,500 of  10,045. Elapsed: 0:01:24. Remaining: 0:01:09
## Documents   5,520 of  10,045. Elapsed: 0:01:24. Remaining: 0:01:09
## Documents   5,540 of  10,045. Elapsed: 0:01:24. Remaining: 0:01:09
## Documents   5,560 of  10,045. Elapsed: 0:01:24. Remaining: 0:01:08
## Documents   5,580 of  10,045. Elapsed: 0:01:25. Remaining: 0:01:08
## Documents   5,600 of  10,045. Elapsed: 0:01:25. Remaining: 0:01:07
## Documents   5,620 of  10,045. Elapsed: 0:01:25. Remaining: 0:01:07
## Documents   5,640 of  10,045. Elapsed: 0:01:25. Remaining: 0:01:07
## Documents   5,660 of  10,045. Elapsed: 0:01:26. Remaining: 0:01:06
## Documents   5,680 of  10,045. Elapsed: 0:01:26. Remaining: 0:01:06
## Documents   5,700 of  10,045. Elapsed: 0:01:26. Remaining: 0:01:06
## Documents   5,720 of  10,045. Elapsed: 0:01:26. Remaining: 0:01:05
## Documents   5,740 of  10,045. Elapsed: 0:01:26. Remaining: 0:01:05
## Documents   5,760 of  10,045. Elapsed: 0:01:27. Remaining: 0:01:04
## Documents   5,780 of  10,045. Elapsed: 0:01:27. Remaining: 0:01:04
## Documents   5,800 of  10,045. Elapsed: 0:01:27. Remaining: 0:01:04
## Documents   5,820 of  10,045. Elapsed: 0:01:27. Remaining: 0:01:03
## Documents   5,840 of  10,045. Elapsed: 0:01:27. Remaining: 0:01:03
## Documents   5,860 of  10,045. Elapsed: 0:01:28. Remaining: 0:01:03
## Documents   5,880 of  10,045. Elapsed: 0:01:28. Remaining: 0:01:02
## Documents   5,900 of  10,045. Elapsed: 0:01:28. Remaining: 0:01:02
## Documents   5,920 of  10,045. Elapsed: 0:01:28. Remaining: 0:01:02
## Documents   5,940 of  10,045. Elapsed: 0:01:28. Remaining: 0:01:01
## Documents   5,960 of  10,045. Elapsed: 0:01:29. Remaining: 0:01:01
## Documents   5,980 of  10,045. Elapsed: 0:01:29. Remaining: 0:01:00
## Documents   6,000 of  10,045. Elapsed: 0:01:29. Remaining: 0:01:00
## Documents   6,020 of  10,045. Elapsed: 0:01:29. Remaining: 0:01:00
## Documents   6,040 of  10,045. Elapsed: 0:01:30. Remaining: 0:00:59
## Documents   6,060 of  10,045. Elapsed: 0:01:30. Remaining: 0:00:59
## Documents   6,080 of  10,045. Elapsed: 0:01:30. Remaining: 0:00:59
## Documents   6,100 of  10,045. Elapsed: 0:01:30. Remaining: 0:00:58
## Documents   6,120 of  10,045. Elapsed: 0:01:30. Remaining: 0:00:58
## Documents   6,140 of  10,045. Elapsed: 0:01:31. Remaining: 0:00:58
## Documents   6,160 of  10,045. Elapsed: 0:01:31. Remaining: 0:00:57
## Documents   6,180 of  10,045. Elapsed: 0:01:31. Remaining: 0:00:57
## Documents   6,200 of  10,045. Elapsed: 0:01:31. Remaining: 0:00:57
## Documents   6,220 of  10,045. Elapsed: 0:01:32. Remaining: 0:00:56
## Documents   6,240 of  10,045. Elapsed: 0:01:32. Remaining: 0:00:56
## Documents   6,260 of  10,045. Elapsed: 0:01:32. Remaining: 0:00:56
## Documents   6,280 of  10,045. Elapsed: 0:01:32. Remaining: 0:00:55
## Documents   6,300 of  10,045. Elapsed: 0:01:32. Remaining: 0:00:55
## Documents   6,320 of  10,045. Elapsed: 0:01:33. Remaining: 0:00:55
## Documents   6,340 of  10,045. Elapsed: 0:01:33. Remaining: 0:00:54
## Documents   6,360 of  10,045. Elapsed: 0:01:33. Remaining: 0:00:54
## Documents   6,380 of  10,045. Elapsed: 0:01:33. Remaining: 0:00:54
## Documents   6,400 of  10,045. Elapsed: 0:01:34. Remaining: 0:00:53
## Documents   6,420 of  10,045. Elapsed: 0:01:34. Remaining: 0:00:53
## Documents   6,440 of  10,045. Elapsed: 0:01:34. Remaining: 0:00:53
## Documents   6,460 of  10,045. Elapsed: 0:01:34. Remaining: 0:00:52
## Documents   6,480 of  10,045. Elapsed: 0:01:35. Remaining: 0:00:52
## Documents   6,500 of  10,045. Elapsed: 0:01:35. Remaining: 0:00:52
## Documents   6,520 of  10,045. Elapsed: 0:01:35. Remaining: 0:00:51
## Documents   6,540 of  10,045. Elapsed: 0:01:35. Remaining: 0:00:51
## Documents   6,560 of  10,045. Elapsed: 0:01:36. Remaining: 0:00:51
## Documents   6,580 of  10,045. Elapsed: 0:01:36. Remaining: 0:00:51
## Documents   6,600 of  10,045. Elapsed: 0:01:36. Remaining: 0:00:50
## Documents   6,620 of  10,045. Elapsed: 0:01:36. Remaining: 0:00:50
## Documents   6,640 of  10,045. Elapsed: 0:01:37. Remaining: 0:00:50
## Documents   6,660 of  10,045. Elapsed: 0:01:37. Remaining: 0:00:49
## Documents   6,680 of  10,045. Elapsed: 0:01:37. Remaining: 0:00:49
## Documents   6,700 of  10,045. Elapsed: 0:01:37. Remaining: 0:00:49
## Documents   6,720 of  10,045. Elapsed: 0:01:38. Remaining: 0:00:48
## Documents   6,740 of  10,045. Elapsed: 0:01:38. Remaining: 0:00:48
## Documents   6,760 of  10,045. Elapsed: 0:01:38. Remaining: 0:00:48
## Documents   6,780 of  10,045. Elapsed: 0:01:38. Remaining: 0:00:47
## Documents   6,800 of  10,045. Elapsed: 0:01:39. Remaining: 0:00:47
## Documents   6,820 of  10,045. Elapsed: 0:01:39. Remaining: 0:00:47
## Documents   6,840 of  10,045. Elapsed: 0:01:39. Remaining: 0:00:46
## Documents   6,860 of  10,045. Elapsed: 0:01:39. Remaining: 0:00:46
## Documents   6,880 of  10,045. Elapsed: 0:01:39. Remaining: 0:00:46
## Documents   6,900 of  10,045. Elapsed: 0:01:40. Remaining: 0:00:45
## Documents   6,920 of  10,045. Elapsed: 0:01:40. Remaining: 0:00:45
## Documents   6,940 of  10,045. Elapsed: 0:01:40. Remaining: 0:00:45
## Documents   6,960 of  10,045. Elapsed: 0:01:40. Remaining: 0:00:44
## Documents   6,980 of  10,045. Elapsed: 0:01:41. Remaining: 0:00:44
## Documents   7,000 of  10,045. Elapsed: 0:01:41. Remaining: 0:00:44
## Documents   7,020 of  10,045. Elapsed: 0:01:41. Remaining: 0:00:44
## Documents   7,040 of  10,045. Elapsed: 0:01:41. Remaining: 0:00:43
## Documents   7,060 of  10,045. Elapsed: 0:01:41. Remaining: 0:00:43
## Documents   7,080 of  10,045. Elapsed: 0:01:42. Remaining: 0:00:43
## Documents   7,100 of  10,045. Elapsed: 0:01:42. Remaining: 0:00:42
## Documents   7,120 of  10,045. Elapsed: 0:01:42. Remaining: 0:00:42
## Documents   7,140 of  10,045. Elapsed: 0:01:42. Remaining: 0:00:42
## Documents   7,160 of  10,045. Elapsed: 0:01:43. Remaining: 0:00:41
## Documents   7,180 of  10,045. Elapsed: 0:01:43. Remaining: 0:00:41
## Documents   7,200 of  10,045. Elapsed: 0:01:43. Remaining: 0:00:41
## Documents   7,220 of  10,045. Elapsed: 0:01:43. Remaining: 0:00:40
## Documents   7,240 of  10,045. Elapsed: 0:01:44. Remaining: 0:00:40
## Documents   7,260 of  10,045. Elapsed: 0:01:44. Remaining: 0:00:40
## Documents   7,280 of  10,045. Elapsed: 0:01:44. Remaining: 0:00:40
## Documents   7,300 of  10,045. Elapsed: 0:01:44. Remaining: 0:00:39
## Documents   7,320 of  10,045. Elapsed: 0:01:45. Remaining: 0:00:39
## Documents   7,340 of  10,045. Elapsed: 0:01:45. Remaining: 0:00:39
## Documents   7,360 of  10,045. Elapsed: 0:01:45. Remaining: 0:00:38
## Documents   7,380 of  10,045. Elapsed: 0:01:45. Remaining: 0:00:38
## Documents   7,400 of  10,045. Elapsed: 0:01:46. Remaining: 0:00:38
## Documents   7,420 of  10,045. Elapsed: 0:01:46. Remaining: 0:00:37
## Documents   7,440 of  10,045. Elapsed: 0:01:46. Remaining: 0:00:37
## Documents   7,460 of  10,045. Elapsed: 0:01:46. Remaining: 0:00:37
## Documents   7,480 of  10,045. Elapsed: 0:01:47. Remaining: 0:00:37
## Documents   7,500 of  10,045. Elapsed: 0:01:47. Remaining: 0:00:36
## Documents   7,520 of  10,045. Elapsed: 0:01:47. Remaining: 0:00:36
## Documents   7,540 of  10,045. Elapsed: 0:01:47. Remaining: 0:00:36
## Documents   7,560 of  10,045. Elapsed: 0:01:48. Remaining: 0:00:35
## Documents   7,580 of  10,045. Elapsed: 0:01:48. Remaining: 0:00:35
## Documents   7,600 of  10,045. Elapsed: 0:01:48. Remaining: 0:00:35
## Documents   7,620 of  10,045. Elapsed: 0:01:48. Remaining: 0:00:34
## Documents   7,640 of  10,045. Elapsed: 0:01:49. Remaining: 0:00:34
## Documents   7,660 of  10,045. Elapsed: 0:01:49. Remaining: 0:00:34
## Documents   7,680 of  10,045. Elapsed: 0:01:49. Remaining: 0:00:34
## Documents   7,700 of  10,045. Elapsed: 0:01:49. Remaining: 0:00:33
## Documents   7,720 of  10,045. Elapsed: 0:01:49. Remaining: 0:00:33
## Documents   7,740 of  10,045. Elapsed: 0:01:50. Remaining: 0:00:33
## Documents   7,760 of  10,045. Elapsed: 0:01:50. Remaining: 0:00:32
## Documents   7,780 of  10,045. Elapsed: 0:01:50. Remaining: 0:00:32
## Documents   7,800 of  10,045. Elapsed: 0:01:50. Remaining: 0:00:32
## Documents   7,820 of  10,045. Elapsed: 0:01:51. Remaining: 0:00:31
## Documents   7,840 of  10,045. Elapsed: 0:01:51. Remaining: 0:00:31
## Documents   7,860 of  10,045. Elapsed: 0:01:51. Remaining: 0:00:31
## Documents   7,880 of  10,045. Elapsed: 0:01:51. Remaining: 0:00:31
## Documents   7,900 of  10,045. Elapsed: 0:01:52. Remaining: 0:00:30
## Documents   7,920 of  10,045. Elapsed: 0:01:52. Remaining: 0:00:30
## Documents   7,940 of  10,045. Elapsed: 0:01:52. Remaining: 0:00:30
## Documents   7,960 of  10,045. Elapsed: 0:01:52. Remaining: 0:00:29
## Documents   7,980 of  10,045. Elapsed: 0:01:53. Remaining: 0:00:29
## Documents   8,000 of  10,045. Elapsed: 0:01:53. Remaining: 0:00:29
## Documents   8,020 of  10,045. Elapsed: 0:01:53. Remaining: 0:00:29
## Documents   8,040 of  10,045. Elapsed: 0:01:53. Remaining: 0:00:28
## Documents   8,060 of  10,045. Elapsed: 0:01:54. Remaining: 0:00:28
## Documents   8,080 of  10,045. Elapsed: 0:01:54. Remaining: 0:00:28
## Documents   8,100 of  10,045. Elapsed: 0:01:54. Remaining: 0:00:27
## Documents   8,120 of  10,045. Elapsed: 0:01:54. Remaining: 0:00:27
## Documents   8,140 of  10,045. Elapsed: 0:01:54. Remaining: 0:00:27
## Documents   8,160 of  10,045. Elapsed: 0:01:55. Remaining: 0:00:26
## Documents   8,180 of  10,045. Elapsed: 0:01:55. Remaining: 0:00:26
## Documents   8,200 of  10,045. Elapsed: 0:01:55. Remaining: 0:00:26
## Documents   8,220 of  10,045. Elapsed: 0:01:55. Remaining: 0:00:26
## Documents   8,240 of  10,045. Elapsed: 0:01:56. Remaining: 0:00:25
## Documents   8,260 of  10,045. Elapsed: 0:01:56. Remaining: 0:00:25
## Documents   8,280 of  10,045. Elapsed: 0:01:56. Remaining: 0:00:25
## Documents   8,300 of  10,045. Elapsed: 0:01:56. Remaining: 0:00:24
## Documents   8,320 of  10,045. Elapsed: 0:01:57. Remaining: 0:00:24
## Documents   8,340 of  10,045. Elapsed: 0:01:57. Remaining: 0:00:24
## Documents   8,360 of  10,045. Elapsed: 0:01:57. Remaining: 0:00:24
## Documents   8,380 of  10,045. Elapsed: 0:01:57. Remaining: 0:00:23
## Documents   8,400 of  10,045. Elapsed: 0:01:58. Remaining: 0:00:23
## Documents   8,420 of  10,045. Elapsed: 0:01:58. Remaining: 0:00:23
## Documents   8,440 of  10,045. Elapsed: 0:01:58. Remaining: 0:00:22
## Documents   8,460 of  10,045. Elapsed: 0:01:58. Remaining: 0:00:22
## Documents   8,480 of  10,045. Elapsed: 0:01:59. Remaining: 0:00:22
## Documents   8,500 of  10,045. Elapsed: 0:01:59. Remaining: 0:00:22
## Documents   8,520 of  10,045. Elapsed: 0:01:59. Remaining: 0:00:21
## Documents   8,540 of  10,045. Elapsed: 0:02:00. Remaining: 0:00:21
## Documents   8,560 of  10,045. Elapsed: 0:02:00. Remaining: 0:00:21
## Documents   8,580 of  10,045. Elapsed: 0:02:00. Remaining: 0:00:20
## Documents   8,600 of  10,045. Elapsed: 0:02:00. Remaining: 0:00:20
## Documents   8,620 of  10,045. Elapsed: 0:02:00. Remaining: 0:00:20
## Documents   8,640 of  10,045. Elapsed: 0:02:01. Remaining: 0:00:20
## Documents   8,660 of  10,045. Elapsed: 0:02:01. Remaining: 0:00:19
## Documents   8,680 of  10,045. Elapsed: 0:02:01. Remaining: 0:00:19
## Documents   8,700 of  10,045. Elapsed: 0:02:02. Remaining: 0:00:19
## Documents   8,720 of  10,045. Elapsed: 0:02:02. Remaining: 0:00:18
## Documents   8,740 of  10,045. Elapsed: 0:02:02. Remaining: 0:00:18
## Documents   8,760 of  10,045. Elapsed: 0:02:02. Remaining: 0:00:18
## Documents   8,780 of  10,045. Elapsed: 0:02:02. Remaining: 0:00:18
## Documents   8,800 of  10,045. Elapsed: 0:02:03. Remaining: 0:00:17
## Documents   8,820 of  10,045. Elapsed: 0:02:03. Remaining: 0:00:17
## Documents   8,840 of  10,045. Elapsed: 0:02:03. Remaining: 0:00:17
## Documents   8,860 of  10,045. Elapsed: 0:02:03. Remaining: 0:00:16
## Documents   8,880 of  10,045. Elapsed: 0:02:03. Remaining: 0:00:16
## Documents   8,900 of  10,045. Elapsed: 0:02:04. Remaining: 0:00:16
## Documents   8,920 of  10,045. Elapsed: 0:02:04. Remaining: 0:00:16
## Documents   8,940 of  10,045. Elapsed: 0:02:04. Remaining: 0:00:15
## Documents   8,960 of  10,045. Elapsed: 0:02:04. Remaining: 0:00:15
## Documents   8,980 of  10,045. Elapsed: 0:02:05. Remaining: 0:00:15
## Documents   9,000 of  10,045. Elapsed: 0:02:05. Remaining: 0:00:14
## Documents   9,020 of  10,045. Elapsed: 0:02:05. Remaining: 0:00:14
## Documents   9,040 of  10,045. Elapsed: 0:02:05. Remaining: 0:00:14
## Documents   9,060 of  10,045. Elapsed: 0:02:05. Remaining: 0:00:14
## Documents   9,080 of  10,045. Elapsed: 0:02:06. Remaining: 0:00:13
## Documents   9,100 of  10,045. Elapsed: 0:02:06. Remaining: 0:00:13
## Documents   9,120 of  10,045. Elapsed: 0:02:06. Remaining: 0:00:13
## Documents   9,140 of  10,045. Elapsed: 0:02:06. Remaining: 0:00:13
## Documents   9,160 of  10,045. Elapsed: 0:02:07. Remaining: 0:00:12
## Documents   9,180 of  10,045. Elapsed: 0:02:07. Remaining: 0:00:12
## Documents   9,200 of  10,045. Elapsed: 0:02:07. Remaining: 0:00:12
## Documents   9,220 of  10,045. Elapsed: 0:02:08. Remaining: 0:00:11
## Documents   9,240 of  10,045. Elapsed: 0:02:08. Remaining: 0:00:11
## Documents   9,260 of  10,045. Elapsed: 0:02:08. Remaining: 0:00:11
## Documents   9,280 of  10,045. Elapsed: 0:02:09. Remaining: 0:00:11
## Documents   9,300 of  10,045. Elapsed: 0:02:09. Remaining: 0:00:10
## Documents   9,320 of  10,045. Elapsed: 0:02:09. Remaining: 0:00:10
## Documents   9,340 of  10,045. Elapsed: 0:02:09. Remaining: 0:00:10
## Documents   9,360 of  10,045. Elapsed: 0:02:10. Remaining: 0:00:09
## Documents   9,380 of  10,045. Elapsed: 0:02:10. Remaining: 0:00:09
## Documents   9,400 of  10,045. Elapsed: 0:02:10. Remaining: 0:00:09
## Documents   9,420 of  10,045. Elapsed: 0:02:11. Remaining: 0:00:09
## Documents   9,440 of  10,045. Elapsed: 0:02:11. Remaining: 0:00:08
## Documents   9,460 of  10,045. Elapsed: 0:02:11. Remaining: 0:00:08
## Documents   9,480 of  10,045. Elapsed: 0:02:11. Remaining: 0:00:08
## Documents   9,500 of  10,045. Elapsed: 0:02:12. Remaining: 0:00:08
## Documents   9,520 of  10,045. Elapsed: 0:02:12. Remaining: 0:00:07
## Documents   9,540 of  10,045. Elapsed: 0:02:12. Remaining: 0:00:07
## Documents   9,560 of  10,045. Elapsed: 0:02:13. Remaining: 0:00:07
## Documents   9,580 of  10,045. Elapsed: 0:02:13. Remaining: 0:00:06
## Documents   9,600 of  10,045. Elapsed: 0:02:13. Remaining: 0:00:06
## Documents   9,620 of  10,045. Elapsed: 0:02:13. Remaining: 0:00:06
## Documents   9,640 of  10,045. Elapsed: 0:02:14. Remaining: 0:00:06
## Documents   9,660 of  10,045. Elapsed: 0:02:14. Remaining: 0:00:05
## Documents   9,680 of  10,045. Elapsed: 0:02:14. Remaining: 0:00:05
## Documents   9,700 of  10,045. Elapsed: 0:02:14. Remaining: 0:00:05
## Documents   9,720 of  10,045. Elapsed: 0:02:15. Remaining: 0:00:04
## Documents   9,740 of  10,045. Elapsed: 0:02:15. Remaining: 0:00:04
## Documents   9,760 of  10,045. Elapsed: 0:02:15. Remaining: 0:00:04
## Documents   9,780 of  10,045. Elapsed: 0:02:15. Remaining: 0:00:04
## Documents   9,800 of  10,045. Elapsed: 0:02:16. Remaining: 0:00:03
## Documents   9,820 of  10,045. Elapsed: 0:02:16. Remaining: 0:00:03
## Documents   9,840 of  10,045. Elapsed: 0:02:16. Remaining: 0:00:03
## Documents   9,860 of  10,045. Elapsed: 0:02:16. Remaining: 0:00:03
## Documents   9,880 of  10,045. Elapsed: 0:02:17. Remaining: 0:00:02
## Documents   9,900 of  10,045. Elapsed: 0:02:17. Remaining: 0:00:02
## Documents   9,920 of  10,045. Elapsed: 0:02:17. Remaining: 0:00:02
## Documents   9,940 of  10,045. Elapsed: 0:02:17. Remaining: 0:00:01
## Documents   9,960 of  10,045. Elapsed: 0:02:18. Remaining: 0:00:01
## Documents   9,980 of  10,045. Elapsed: 0:02:18. Remaining: 0:00:01
## Documents  10,000 of  10,045. Elapsed: 0:02:18. Remaining: 0:00:01
## Documents  10,020 of  10,045. Elapsed: 0:02:18. Remaining: 0:00:00
## Documents  10,040 of  10,045. Elapsed: 0:02:19. Remaining: 0:00:00</code></pre>
</div>
<div id="transform-embeddings-to-numpy" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Transform Embeddings to Numpy</h2>
<p>Next we reshape and save our data as a numpy file for use in Faiss.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>embeddings_container <span class="op">=</span> np.asarray(embeddings_container)</span>
<span id="cb30-2"><a href="#cb30-2"></a>embeddings_container.shape</span></code></pre></div>
<pre><code>## (10045, 1, 768)</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>embeddings_container <span class="op">=</span> embeddings_container.reshape(<span class="dv">10045</span>, <span class="dv">768</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co"># save document embeddings</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>np.save(<span class="st">&#39;semantic_search.npy&#39;</span>, embeddings_container)</span></code></pre></div>
</div>
</div>
<div id="faiss-in-action" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Faiss in Action</h1>
<p>To review the remainder of this similarity search exercise, please <a href="http://seekinginference.com/applied_nlp/FAISS.html">view this notebook</a>.</p>
</div>
<div id="sources" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Sources</h1>
<ul>
<li>Faiss - <a href="https://github.com/facebookresearch/faiss" class="uri">https://github.com/facebookresearch/faiss</a></li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
